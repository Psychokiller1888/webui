(function(t){function e(e){for(var s,o,l=e[0],r=e[1],c=e[2],u=0,h=[];u<l.length;u++)o=l[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&h.push(a[o][0]),a[o]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s]);d&&d(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],s=!0,l=1;l<i.length;l++){var r=i[l];0!==a[r]&&(s=!1)}s&&(n.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},a={app:0},n=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],r=l.push.bind(l);l.push=e,l=l.slice();for(var c=0;c<l.length;c++)e(l[c]);var d=r;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0064":function(t,e,i){"use strict";i("4035")},"00d1":function(t,e,i){"use strict";i("475b")},"0555":function(t,e,i){},"055f":function(t,e,i){},"0acb":function(t,e,i){},"0c45":function(t,e,i){"use strict";i("3613")},"0e3f":function(t,e,i){"use strict";i("f81c")},"0eaf":function(t,e,i){"use strict";i("25f6")},1606:function(t,e,i){"use strict";i("8def")},"16ea":function(t,e,i){},1927:function(t,e,i){},"201c":function(t,e,i){"use strict";i("6867")},2178:function(t,e,i){},2452:function(t,e,i){},"25f6":function(t,e,i){},2728:function(t,e,i){},"27a9":function(t,e,i){"use strict";i("c067")},2888:function(t,e,i){},"29c0":function(t,e,i){"use strict";i("16ea")},"2b6f":function(t,e,i){},"2d43":function(t,e,i){"use strict";i("2452")},"2d7a":function(t,e,i){"use strict";i("f816")},"32f7":function(t,e,i){"use strict";i("4e32")},"343d":function(t,e,i){"use strict";i("055f")},3613:function(t,e,i){},"3bb6":function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var s=i("533b");class a{constructor(t){this.controller=t,this.moveable=new s["a"],this.rotationDelta=0,this.altDown=!1,this.timeout=0;let e=this;document.addEventListener("keyup",(function(t){if(!t.repeat&&"Control"===t.key)try{e.moveable.snapThreshold=15}catch{}})),document.addEventListener("keydown",(function(t){if(!t.repeat&&"Control"===t.key)try{e.moveable.snapThreshold=1}catch{}}))}destroyMoveable(){if(!this.altDown)try{this.moveable.destroy()}catch{}}computeWidgetCustomStyle(t){let e=`color: ${t.settings["font-color"]};`;return e+=`background-color: ${t.settings["rgba"]};`,e+=`font-size: ${t.settings["font-size"]}em;`,e+=`top: ${t.settings["y"]}px;`,e+=`left: ${t.settings["x"]}px;`,e+=`width: ${t.settings["w"]}px;`,e+=`height: ${t.settings["h"]}px;`,e+=`z-index: ${t.settings["z"]};`,e+="min-width: 50px;",e+="min-height: 50px;",t.settings["borders"]||(e+="box-shadow:none;"),t.settings["r"]&&0!==t.settings["r"]&&(e+=`transform:rotate(${t.settings["r"]}deg);`),e}computeMyHomeCustomStyle(t,e){let i=`left:${t["settings"]["x"]}px;`;return i+=`top:${t["settings"]["y"]}px;`,i+=`width:${t["settings"]["w"]}px;`,i+=`height:${t["settings"]["h"]}px;`,i+=`z-index:${t["settings"]["z"]};`,i+=`transform:rotate(${t["settings"]["r"]}deg);`,i+=e,t["settings"].hasOwnProperty("b")&&(i+="border-radius:"+t["settings"]["b"]),i}setGuidelines(t){this.moveable.elementGuidelines=t}setMoveable(t,e){this.destroyMoveable();let i=document.querySelector(".floorPlan");i?0!==e.data.parentLocation&&(i=document.querySelector("#loc_"+e.data.parentLocation)):i=document.querySelector(".tab_page"),this.moveable=new s["a"](i,{target:t,props:e,draggable:!0,resizable:!0,rotatable:!0,snappable:!0,roundable:!1,isDisplaySnapDigit:!0,snapCenter:!0,snapGap:!1,snapThreshold:15,throttleDrag:1,throttleResize:1,throttleRotate:5,scalable:!1,keepRatio:!1,edge:!1,origin:!1}),this.moveable.on("dragStart",({target:t})=>{try{this.moveable.props.dragStart(t)}catch{this.startDrag(t)}finally{this.dragging=!0,this.timeout=Math.floor((new Date).getTime()/250)}}).on("drag",({target:t,left:e,top:i,clientX:s,clientY:a})=>{try{this.moveable.props.handleDrag(t,e,i,s,a)}catch{this.handleDrag(t,e,i)}}).on("dragEnd",({target:t,clientX:e,clientY:i})=>{try{this.moveable.props.setPosition(t,e,i)}catch{this.setPosition(t)}finally{this.save(),this.dragging=!1;let e=Math.floor((new Date).getTime()/250);this.timeout!==e?this.timeout=e:this.timeout=0,t.classList.remove("dragging")}}),this.moveable.on("resize",({target:t,width:e,height:i,delta:s,direction:a})=>{try{this.moveable.props.handleResize(t,e,i,s,a)}catch{this.handleResize(t,e,i,s,a)}}).on("resizeEnd",({target:t})=>{try{this.moveable.props.setSize(t)}catch{this.setSize(t)}finally{this.save()}}),this.moveable.on("rotate",({target:t,dist:e,transform:i})=>{try{this.moveable.props.handleRotate(t,e,i)}catch{this.handleRotate(t,e,i)}}).on("rotateEnd",({target:t})=>{try{this.moveable.props.setRotation(t)}catch{this.setRotation(t)}finally{this.save()}}),this.moveable.on("round",t=>{try{this.moveable.props.handleBorderRadius(t.target)}catch{this.handleBorderRadius(t)}}).on("roundEnd",t=>{try{this.moveable.props.setBorderRadius(t)}catch{this.setBorderRadius(t)}finally{this.save()}})}setBoundaries(t,e){const i=t.parentElement;this.moveable.bounds={left:-e,right:parseInt(i.style.width.substring(-2))+e,top:-e,bottom:parseInt(i.style.height.substring(-2))+e}}save(){this.moveable.props.save()}startDrag(t){t.classList.add("dragging"),t.style["z-index"]=1e3}getItem(t){const e=this.getId(t);return t.classList.contains("location")?this.controller.$store.state.locations[e]:t.classList.contains("furniture")?this.controller.$store.state.furnitures[e]:t.classList.contains("construction")?this.controller.$store.state.constructions[e]:t.classList.contains("device")?this.controller.$store.state.devices[e]:t.classList.contains("widget")?this.controller.$store.state.widgetInstances[e]:void 0}getId(t){return parseInt(t.id.substring(4))}setPosition(t){const e=this.getItem(t);e.settings["x"]=parseInt(t.style.left.substring(-2)),e.settings["y"]=parseInt(t.style.top.substring(-2));try{this.controller.removeDroppable()}catch{}}setSize(t){const e=this.getItem(t);e.settings["x"]=parseInt(t.style.left.substring(-2)),e.settings["y"]=parseInt(t.style.top.substring(-2)),e.settings["w"]=parseInt(t.style.width.substring(-2)),e.settings["h"]=parseInt(t.style.height.substring(-2))}setRotation(t){const e=this.getItem(t);0===e.settings["r"]?e.settings["r"]=this.rotationDelta:e.settings["r"]=e.settings["r"]+this.rotationDelta,this.rotationDelta=0}setBorderRadius(t){const e=this.getItem(t.target);e.settings["b"]=t.target.style["border-radius"]}handleResize(t,e,i,s,a){if(-1===a[0]){let e=parseInt(t.style.left.slice(0,-2))-s[0];t.style.left=e+"px"}if(-1===a[1]){let e=parseInt(t.style.top.slice(0,-2))-s[1];t.style.top=e+"px"}if(t.style.width=e+"px",t.style.height=i+"px",t.classList.contains("widget"))try{this.controller.$store.state.widgetInstances[t.id.substr(4)].instance.onResize(t,e,i,s,a)}catch(n){}}handleRotate(t,e,i){this.rotationDelta=e,t.style.transform=i}handleBorderRadius(t){t.target.style.borderRadius=t.borderRadius}handleDrag(t,e,i){t.style.left=e+"px",t.style.top=i+"px"}}},4009:function(t,e,i){},4035:function(t,e,i){},"444f":function(t,e,i){},4678:function(t,e,i){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function a(t){var e=n(t);return i(e)}function n(t){if(!i.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}a.keys=function(){return Object.keys(s)},a.resolve=n,t.exports=a,a.id="4678"},4718:function(t,e,i){"use strict";i("e70f")},"475b":function(t,e,i){},"4c75":function(t,e,i){"use strict";i("444f")},"4e32":function(t,e,i){},"4f39":function(t,e,i){"use strict";i("d424")},"50ea":function(t,e,i){"use strict";e["a"]=function(t){return new Promise((function(e,i){let s=!1,a=document.querySelector(`script[src="${t}"]`);if(a){if(a.hasAttribute("data-loaded"))return void e(a)}else a=document.createElement("script"),a.async=!0,a.src=t,s=!0;a.addEventListener("error",i),a.addEventListener("abort",i),a.addEventListener("load",(function(){a.setAttribute("data-loaded",!0),e(a)})),s&&document.head.appendChild(a)}))}},5145:function(t,e,i){"use strict";i("b1ec")},5163:function(t,e,i){"use strict";i("92ea")},5629:function(t,e,i){},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("2b0e"),a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"mainContainer"},[t.$store.state.uiConnected?e("pa-main"):e("pa-connect")],1)},n=[],o=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"mainContainer"},[e("pa-header"),e("div",{attrs:{id:"main"}},[e("pa-nav"),e("pa-content")],1)],1)},l=[],r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("header",{class:{collapsed:this.$store.state.fullScreen}},[e("div",{staticClass:"pageTitle"},[t._v(t._s(t.title))]),e("div",{staticClass:"aliceStatus",attrs:{id:"aliceStatus"}}),this.$store.state.settings["displaySystemUsage"]?e("div",{staticClass:"resourceUsage"},[t._v(" CPU: "+t._s(t.resources.cpu)+"% SWP: "+t._s(t.resources.swp)+"% RAM: "+t._s(t.resources.ram)+"% ")]):t._e(),e("div",{staticClass:"versionInfo"},[t._v(" "+t._s(t.$store.state.settings["aliceVersion"])+" ")]),e("div",{staticClass:"channelInfo"},[t._v(" "+t._s(t.$store.state.settings["aliceUpdateChannel"])+" ")]),0!==Object.keys(t.notifications).length?e("div",{staticClass:"notifications"},[e("span",{staticClass:"notification"},[e("i",{staticClass:"fas fa-envelope clickable notificationIcon",attrs:{"aria-hidden":"true"},on:{click:function(e){t.notificationsDisplayToggle=!t.notificationsDisplayToggle}}}),e("span",{staticClass:"notificationCounter"},[t._v(t._s(Object.keys(t.notifications).length))])]),t.notificationsDisplayToggle?e("div",{staticClass:"notificationHolder"},[Object.keys(t.notifications).length>1?e("div",{staticClass:"notification clickable",on:{click:t.dismissAll}},[t._m(0),e("div",{staticClass:"content"},[t._v(" "+t._s(t.$t("buttons.dismissAllNotification"))+" ")])]):t._e(),t._l(t.notifications,(function(t){return e("notification",{key:t.id,attrs:{notification:t}})}))],2):t._e()]):t._e()])},c=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"title"},[e("i",{staticClass:"far fa-check-double fa-fw",attrs:{"aria-hidden":"true"}})])}];const d="projectalice/devices/resourceUsage",u="projectalice/devices/coreHeartbeat",h="projectalice/devices/heartbeat",m="projectalice/devices/updated",p="projectalice/devices/deleted",f="projectalice/devices/coreReconnection",g="projectalice/devices/coreDisconnection",v="projectalice/logging/alicewatch",y="projectalice/logging/syslog",k="projectalice/skills/installed",b="projectalice/skills/updating",w="projectalice/skills/updated",_="projectalice/skills/deleted",$="projectalice/notifications/ui/notification",T="hermes/tts/say",C="hermes/nlu/query",S="hermes/dialogueManager/sessionEnded",I="hermes/hotword/s/detected",L="hermes/asr/partialTextCaptured",x="hermes/asr/textCaptured",P="hermes/audioServer/{}/playBytes/#",D="hermes/audioServer/{}/audioFrame",E="hermes/asr/startListening",j="hermes/asr/stopListening";var M=i("bc3a"),O=i.n(M),H={name:"pa-header",data(){return{notifications:{},notificationsDisplayToggle:!1,title:"",unwatch:{},resources:{cpu:0,ram:0,swp:0}}},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){let i=JSON.parse(e.payloadString);e.topic===d?t.resources=i:e.topic===$&&("all"!==i["deviceUid"]&&i["deviceUid"]!==localStorage.getItem("interfaceUid")||(t.notifications[i["id"]]=i))})),O()({method:"GET",url:"/utils/notifications/",headers:{auth:t.$store.getters.apiToken,uid:localStorage.getItem("interfaceUid")}})},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(d),this.unwatch()},watch:{$route:{immediate:!0,handler(t){this.title=this.$t(t.meta.title)||"Home",document.title="Project Alice - "+(this.title.charAt(0).toUpperCase()+this.title.slice(1))}}},methods:{dismissNotification:function(t){this.$delete(this.notifications,t),0===Object.keys(this.notifications).length&&(this.notificationsDisplayToggle=!1),O()({method:"PATCH",url:`/utils/notifications/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then()},dismissAll:function(){const t={...this.notifications};for(const e of Object.keys(t))this.dismissNotification(e)}}},N=H,A=(i("d52b"),i("2877")),F=Object(A["a"])(N,r,c,!1,null,"024635ec",null),V=F.exports,z=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("nav",{class:{collapsed:this.$store.state.fullScreen,minimized:t.forceMinimized||this.$store.state.minimized&&!this.$store.state.fullScreen,retract:t.animateRetract,extend:t.animateExtend},on:{animationend:t.endAnimations}},[e("router-link",{attrs:{to:"/widgets"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.widgets"),expression:"$t('nav.widgets')"}],staticClass:"minimized"},[e("i",{staticClass:"fab fa-windows",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.widgets")))])]),this.$store.state.loggedInUser?e("router-link",{attrs:{to:"/skills"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.skills"),expression:"$t('nav.skills')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-brain",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.skills")))])]):t._e(),e("router-link",{attrs:{to:"/myhome"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.myhome"),expression:"$t('nav.myhome')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-home",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.myhome")))])]),this.$store.state.loggedInUser&&this.$store.state.settings["scenariosActive"]?e("router-link",{attrs:{to:"/scenarios"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.scenarios"),expression:"$t('nav.scenarios')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-sitemap",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.scenarios")))])]):t._e(),this.$store.state.loggedInUser?e("router-link",{attrs:{to:"/syslog"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.syslog"),expression:"$t('nav.syslog')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-file-alt",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.syslog")))])]):t._e(),this.$store.state.loggedInUser?e("router-link",{attrs:{to:"/alicewatch"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.alicewatch"),expression:"$t('nav.alicewatch')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-eye",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.alicewatch")))])]):t._e(),this.$store.state.loggedInUser&&"admin"===this.$store.state.loggedInUser.authLevel?e("router-link",{attrs:{to:"/dialogView"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.dialogView"),expression:"$t('nav.dialogView')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-comments",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.dialogView")))])]):t._e(),this.$store.state.loggedInUser&&"admin"===this.$store.state.loggedInUser.authLevel?e("router-link",{attrs:{to:"/telemetry"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.telemetry"),expression:"$t('nav.telemetry')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-database",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.telemetry")))])]):t._e(),this.$store.state.settings["devMode"]&&this.$store.state.loggedInUser?e("router-link",{attrs:{to:"/devmode"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.devmode"),expression:"$t('nav.devmode')"}],staticClass:"minimized"},[e("i",{staticClass:"fab fa-dev",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.devmode")))])]):t._e(),this.$store.state.loggedInUser&&"admin"===this.$store.state.loggedInUser.authLevel?e("router-link",{attrs:{to:"/admin"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.admin"),expression:"$t('nav.admin')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-tools",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.admin")))])]):t._e(),this.$store.state.minimized||t.forceMinimized?t._e():e("a",{staticClass:"nav-link",on:{click:t.minimize}},[e("button",[t._v(t._s(t.$t("buttons.minimize")))])]),this.$store.state.minimized&&!t.forceMinimized?e("a",{staticClass:"nav-link",on:{click:t.maximize}},[t._m(0)]):t._e(),this.$store.state.loggedInUser?t._e():e("router-link",{staticClass:"lastItem",attrs:{to:"/login"}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.login"),expression:"$t('nav.login')"}],staticClass:"minimized"},[e("i",{staticClass:"fas fa-sign-in-alt",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.login")))])]),this.$store.state.loggedInUser?e("a",{staticClass:"nav-link lastItem",class:{fullSize:t.$store.state.minimized||t.forceMinimized},on:{click:t.logout}},[t.$store.state.minimized||t.forceMinimized?e("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("nav.logout"),expression:"$t('nav.logout')"}],staticClass:"minimized fullSize"},[e("i",{staticClass:"fas fa-sign-out-alt",attrs:{"aria-hidden":"true"}})]):e("button",[t._v(t._s(t.$t("nav.logout")))])]):t._e()],1)},q=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("button",{staticClass:"minimized"},[e("i",{staticClass:"fas fa-chevron-right",attrs:{"aria-hidden":"true"}})])}],U={name:"pa-nav",data:function(){return{animateRetract:!1,animateExtend:!1}},computed:{forceMinimized(){return this.$store.state.windowHeight<=627}},methods:{logout:function(){this.$store.commit("userLogout"),window.location.reload()},endAnimations:function(){this.animateExtend=!1,this.animateRetract=!1},minimize:function(){this.$store.commit("startMinimized"),this.animateExtend=!1,this.animateRetract=!0},maximize:function(){this.$store.commit("stopMinimized"),this.animateRetract=!1,this.animateExtend=!0}}},W=U,R=(i("d87d"),Object(A["a"])(W,z,q,!1,null,"9a7f5afe",null)),B=R.exports,G=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("section",{attrs:{id:"mainSection"}},[e("keep-alive",[e("router-view")],1),e("pa-scenarios-iframe"),t._v(" "),t.connected?t._e():e("div",{staticClass:"connectionStatus",class:{connected:t.reconnected}},[e("i",{staticClass:"fas fa-5x",class:{"fa-heart-broken":!t.connected&&!t.reconnected,"fa-heartbeat":t.connected||t.reconnected},attrs:{"aria-hidden":"true"}})])],1)},Y=[],J=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("portal-target",{attrs:{id:"scenarios-portal-target",name:"scenarios-iframe"}},[e("iframe",{directives:[{name:"show",rawName:"v-show",value:"Scenarios"===t.$route.name,expression:"$route.name === 'Scenarios'"}],attrs:{id:"nodered",src:`//${t.$store.state.settings["aliceIp"]}:1880`,title:"nodered"}})])},K=[],X={name:"scenariosIframe"},Z=X,Q=(i("ac56"),Object(A["a"])(Z,J,K,!1,null,"ef0bc176",null)),tt=Q.exports,et={name:"pa-content",components:{paScenariosIframe:tt},data:function(){return{connected:!0,reconnected:!1,checkHeartbeat:null}},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){if(e.topic===u||e.topic===f){if(t.reconnected)return;if(null!==t.checkHeartbeat&&(clearTimeout(t.checkHeartbeat),!t.connected&&!t.reconnected))return t.reconnected=!0,void setTimeout((function(){t.connected=!0,t.reconnected=!1}),5e3);t.checkHeartbeat=setTimeout((function(){t.connected=!1,t.reconnected=!1}),4500),t.connected=!0}else e.topic===g&&(t.connected=!1,null!==t.checkHeartbeat&&clearTimeout(t.checkHeartbeat))}))},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(u),this.$store.state.mqtt.unsubscribe(f),this.$store.state.mqtt.unsubscribe(g),this.unwatch()},watch:{$route:{immediate:!0,handler(t){this.$store.state.uiConnected&&localStorage.setItem("showPage",t.path)}}}},it=et,st=(i("b2d9"),Object(A["a"])(it,G,Y,!1,null,null,null)),at=st.exports,nt={name:"Main",components:{paContent:at,paHeader:V,paNav:B}},ot=nt,lt=Object(A["a"])(ot,o,l,!1,null,null,null),rt=lt.exports,ct=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.connecting?e("div",{staticClass:"mainContainer centered vcentered"},[e("i",{staticClass:"fas fa-spinner fa-spin fa-5x"})]):e("div",{staticClass:"mainContainer centered vcentered"},[e("form",{staticClass:"fullpageForm",on:{submit:function(e){return e.preventDefault(),t.doConnect.apply(null,arguments)}}},[e("p",{staticClass:"size-15x"},[t._v(" Unfortunately Project Alice couldn't be contacted. Please fill her ip and api port below ")]),e("p",[e("label",{attrs:{for:"ip"}},[t._v("Alice ip address")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ip,expression:"ip"}],attrs:{id:"ip",type:"text"},domProps:{value:t.ip},on:{input:function(e){e.target.composing||(t.ip=e.target.value)}}})]),e("p",[e("label",{attrs:{for:"port"}},[t._v("Alice API port")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.port,expression:"port"}],attrs:{id:"port",type:"text"},domProps:{value:t.port},on:{input:function(e){e.target.composing||(t.port=e.target.value)}}})]),e("p",[e("VueToggles",{attrs:{id:"remember",value:t.remember,"checked-text":"Remember",checkedBg:"var(--windowBG)","unchecked-text":"",uncheckedBg:"var(--windowBG)",width:"100"},on:{click:function(e){t.remember=!t.remember}}})],1),t._m(0)])])},dt=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",[e("button",[t._v("Connect")])])}],ut=(i("d9e2"),i("4259")),ht=i.n(ut),mt=i("50ea");i("907a"),i("986a"),i("1d02"),i("3c5d");class pt{constructor(){if(!window.AudioContext){if(!window.webkitAudioContext)return void console.warn("Your browser doesn't support audio playback.");window.AudioContext=window.webkitAudioContext}this.context=new AudioContext}playBytes(t){let e=this,i=new ArrayBuffer(t.length),s=new Uint8Array(i);for(let a=0;a<t.length;a++)s[a]=t[a];this.context.decodeAudioData(i,(function(t){e.play(t)})).then()}play(t){let e=this.context.createBufferSource();e.buffer=t,e.connect(this.context.destination),e.start(0)}}var ft={name:"connect",data(){return{connecting:!1,port:5001,ip:"",remember:!1,audioPlayer:new pt}},created:function(){this.remember=localStorage.getItem("rememberServer")||!1,"true"===this.remember&&(this.remember=!0),"false"===this.remember&&(this.remember=!1),this.ip=localStorage.getItem("host")||window.location.hostname||"127.0.0.1",this.port=localStorage.getItem("apiPort")||5001,localStorage.getItem("skillsTourCompleted")&&this.$store.commit("setSkillTourCompleted"),this.doConnect().then(()=>{console.log("Project Alice Web Interface connected and ready")})},beforeDestroy:function(){O()({method:"GET",url:`/devices/${localStorage.getItem("interfaceUid")}/bye/`,headers:{auth:this.$store.getters.apiToken}}).then()},methods:{async doConnect(){O.a.defaults.baseURL=`http://${this.ip}:${this.port}/api/v1.0.1`,this.connecting=!0;let t=this;Promise.all([t.connect(),t.connectMQTT(),t.validateToken()]).then(()=>{t.helloAlice().then().finally(()=>{t.startHeartbeat(),t.loadDynamicScripts(),t.loadI18n(),t.loadData().then(()=>{const e=localStorage.getItem("showPage")||"/";t.$router.replace("/syslog").then((function(){t.$router.replace("/alicewatch").then((function(){t.$store.commit("uiConnected",!0),t.$store.commit("setConnectVue",t),"/alicewatch"!==e&&(t.$store.state.loggedInUser?t.$router.replace(e).then():t.$router.replace("/widgets").then())}))}))}).catch(t=>{console.error(t)})})}).catch(t=>{console.error("Failed connecting: "+t)}).finally(()=>t.connecting=!1)},startHeartbeat:function(){const t=this;setInterval((function(){localStorage.getItem("interfaceUid")&&t.$store.state.mqtt.publish(h,JSON.stringify({uid:localStorage.getItem("interfaceUid")}))}),5e3)},helloAlice:function(){const t=this,e=localStorage.getItem("interfaceUid");return e&&""!==e&&t.$store.state.loggedInUser?new Promise((function(i,s){O()({method:"GET",url:`/devices/${e}/hello/`}).then(a=>{"deviceId"in a.data?i():O()({method:"PUT",url:`/devices/${e}/`,data:{locationId:1,skillName:"AliceCore",deviceType:"WebInterface"},headers:{auth:t.$store.getters.apiToken,"content-type":"application/json"}}).then(e=>{if("device"in e.data)return t.helloAlice();s(new Error("Error adding interface device "+e.data["message"]))}).catch(t=>{s(new Error("Something went wrong adding interface device "+t))})}).catch(t=>{s(new Error("Error greeting Alice "+t))})})):new Promise((function(t,e){t()}))},loadDynamicScripts:function(){const t=this;return new Promise((function(e,i){Object(mt["a"])(`http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/utils/Widget/`).then(()=>{Object(mt["a"])(`http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/utils/pahows/`).then(e()).catch(t=>{i(t)})}).catch(t=>{i(t)})}))},storeSessionSettings:function(){let t=window.sessionStorage.getItem("aliceSettings"),e={activeCountryCode:this.$store.state.settings["activeCountryCode"],activeLanguage:this.$store.state.settings["activeLanguage"],apiPort:this.$store.state.settings["apiPort"],aliceIp:this.$store.state.settings["aliceIp"],timezone:this.$store.state.settings["timezone"]};t?(t=JSON.parse(t),t=Object.assign({},t,e)):t=e,window.sessionStorage.setItem("aliceSettings",JSON.stringify(t))},connect(){let t=this;return new Promise((function(e,i){O()({method:"GET",url:"/utils/config/",headers:{auth:t.$store.getters.apiToken}}).then(i=>{t.$store.commit("setSettings",i.data["config"]),t.$store.commit("setSettingTemplates",i.data["templates"]),t.$store.commit("setSettingCategories",i.data["categories"]),t.storeSessionSettings(),t.remember?(localStorage.setItem("host",t.ip),localStorage.setItem("apiPort",t.port),localStorage.setItem("rememberServer",!0)):(localStorage.removeItem("host"),localStorage.removeItem("apiPort")),e()}).catch(t=>{i(new Error("Error connecting to Alice "+t))})}))},connectMQTT(){let t=this;return new Promise((function(e,i){O.a.get("/utils/mqttConfig/").then(i=>{let s=window.sessionStorage.getItem("aliceSettings");s=s?JSON.parse(s):{},s["mqttHost"]=i.data.host,s["mqttPort"]=Number(i.data.port),window.sessionStorage.setItem("aliceSettings",JSON.stringify(s));let a=Math.floor(1e7*Math.random()+1),n=new ht.a.Client(i.data.host,Number(i.data.port),"ProjectAliceInterface"+a);n.onMessageArrived=t.onMessage,n.onConnectionLost=t.onConnectionLost,n.onConnectionFailed=t.onConnectionFailed,n.connect({onSuccess:t.onConnected,onFailure:t.onConnectionFailed,timeout:5}),t.$store.commit("setMqtt",n),e()}).catch(t=>{i(new Error("Error getting MQTT info: "+t))})}))},validateToken(){let t=this;return new Promise((function(e,i){localStorage.getItem("apiToken")&&localStorage.getItem("username")?O()({method:"POST",url:"/login/checkToken/",headers:{auth:localStorage.getItem("apiToken")}}).then(i=>{"success"in i.data?t.$store.commit("userLogin",{user:localStorage.getItem("username"),token:localStorage.getItem("apiToken"),authLevel:i.data.authLevel}):(localStorage.removeItem("username"),localStorage.removeItem("apiToken")),e()}).catch(t=>{i(Error("Failed validating token: "+t))}):e()}))},loadI18n(){let t=this;return new Promise((function(e,i){O()({method:"GET",url:"/utils/i18n/"}).then(i=>{t.$i18n.locale=t.$store.state.settings["activeLanguage"];for(const[e,s]of Object.entries(i.data["data"]))t.$i18n.setLocaleMessage(e,s);e()}).catch(t=>{i(Error("Failed loading i18n: "+t))})}))},loadWidgetTemplates:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/widgets/templates/"}).then(s=>{"widgets"in s.data?(t.$store.commit("setWidgetTemplates",s.data["widgets"]),e()):i(Error("Error fetching widget templates"))}).catch(t=>{i(Error("Failed loading widget templates: "+t))})}))},loadWidgetInstances:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/widgets/",headers:{auth:t.$store.getters.apiToken}}).then(s=>{"widgets"in s.data?(t.$store.commit("setWidgetInstances",s.data["widgets"]),e()):i(Error("Error fetching widget instances"))}).catch(t=>{i(Error("Failed loading widget instances: "+t))})}))},loadDeviceTypes:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/myHome/deviceTypes/"}).then(s=>{"types"in s.data?(t.$store.commit("setDeviceTypes",s.data["types"]),e()):i(Error("Error fetching device types"))}).catch(t=>{i(Error("Failed loading device types: "+t))})}))},loadWidgetPages:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/widgets/pages/"}).then(s=>{"pages"in s.data?(t.$store.commit("setWidgetPages",s.data["pages"]),e()):i(Error("Error fetching widget pages"))}).catch(t=>{i(Error("Failed loading widget pages: "+t))})}))},loadInstalledSkills:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/skills/",headers:{auth:t.$store.getters.apiToken}}).then(s=>{"skills"in s.data?(t.$store.commit("setInstalledSkills",s.data["skills"]),e()):i(Error("Error fetching skills"))}).catch(t=>{i(Error("Failed loading installed skills: "+t))})}))},loadStore:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/skills/getStore/"}).then(s=>{"store"in s.data?(t.$store.commit("setStoreSkills",s.data["store"]),e()):i(Error("Error fetching store skills"))}).catch(t=>{i(Error("Failed loading store: "+t))})}))},loadFloorTiles:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/myHome/locations/floors/"}).then(s=>{"data"in s.data?(t.$store.commit("setFloorTiles",s.data["data"]),e()):i(Error("Error fetching floor tiles"))}).catch(t=>{i(Error("Failed loading floor tiles: "+t))})}))},loadConstructionTiles:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/myHome/constructions/tiles/"}).then(s=>{"data"in s.data?(t.$store.commit("setConstructionTiles",s.data["data"]),e()):i(Error("Error fetching construction tiles"))}).catch(t=>{i(Error("Failed loading construction tiles: "+t))})}))},loadFurnitureTiles:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/myHome/furniture/tiles/"}).then(s=>{"data"in s.data?(t.$store.commit("setFurnitureTiles",s.data["data"]),e()):i(Error("Error fetching furniture tiles"))}).catch(t=>{i(Error("Failed loading furniture tiles: "+t))})}))},loadMyHome:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/myHome/",headers:{auth:t.$store.getters.apiToken}}).then(s=>{"data"in s.data?(t.$store.commit("setLocations",s.data["data"]["locations"]),t.$store.commit("setConstructions",s.data["data"]["constructions"]),t.$store.commit("setFurnitures",s.data["data"]["furnitures"]),t.$store.commit("setDeviceLinks",s.data["data"]["links"]),t.$store.commit("setDevices",s.data["data"]["devices"]),e()):i(Error("Error fetching my home data"))}).catch(t=>{i(Error("Failed loading myHome data: "+t))})}))},loadNotifications:function(){const t=this;return new Promise((function(e,i){O()({method:"GET",url:"/utils/notifications/",headers:{auth:t.$store.getters.apiToken,uid:localStorage.getItem("interfaceUid")}}).then(()=>{e()}).catch(t=>{i(Error("Failed loading notifications: "+t))})}))},loadData:function(){const t=this;return new Promise((function(e,i){Promise.all([t.loadWidgetPages(),t.loadDeviceTypes(),t.loadWidgetTemplates(),t.loadWidgetInstances(),t.loadInstalledSkills(),t.loadStore(),t.loadFloorTiles(),t.loadConstructionTiles(),t.loadFurnitureTiles(),t.loadMyHome(),t.loadNotifications()]).then(()=>{e()}).catch(t=>{i(Error("Failed loading data: "+t))})}))},onConnected:function(){console.log("Mqtt connected"),this.$store.state.mqtt.subscribe($),this.$store.state.mqtt.subscribe(d),this.$store.state.mqtt.subscribe(u),this.$store.state.mqtt.subscribe(h),this.$store.state.mqtt.subscribe(m),this.$store.state.mqtt.subscribe(p),this.$store.state.mqtt.subscribe(g),this.$store.state.mqtt.subscribe(f),this.$store.state.mqtt.subscribe(v),this.$store.state.mqtt.subscribe(y),this.$store.state.mqtt.subscribe(S),this.$store.state.mqtt.subscribe(C),this.$store.state.mqtt.subscribe(T),this.$store.state.mqtt.subscribe(I),this.$store.state.mqtt.subscribe(L),this.$store.state.mqtt.subscribe(x),this.$store.state.mqtt.subscribe(w),this.$store.state.mqtt.subscribe(b),this.$store.state.mqtt.subscribe(k),this.$store.state.mqtt.subscribe(_),this.$store.state.mqtt.subscribe(E),this.$store.state.mqtt.subscribe(j),this.$store.state.mqtt.subscribe(P.replace("{}",localStorage.getItem("interfaceUid")))},onConnectionFailed:function(t){console.log("Mqtt connection failed")},onConnectionLost:function(){console.log("Mqtt connection lost")},onMessage:function(t){t.topic.includes("playBytes")?this.audioPlayer.playBytes(t.payloadBytes):this.$store.commit("mqttMessage",t)}}},gt=ft,vt=Object(A["a"])(gt,ct,dt,!1,null,null,null),yt=vt.exports,kt=i("ec26"),bt={name:"ProjectAlice",components:{paMain:rt,paConnect:yt},mounted:function(){const t=this;this.$i18n.locale="en","true"===localStorage.getItem("magicMirrorMode")?this.$store.commit("startMagicMirrorMode"):"true"===localStorage.getItem("fullscreen")&&this.$store.commit("startCinemaMode"),localStorage.getItem("interfaceUid")||this.$store.commit("setInterfaceUid",Object(kt["a"])()),"true"===localStorage.getItem("minimized")&&this.$store.commit("startMinimized"),document.addEventListener("contextmenu",(function(t){t.preventDefault()})),document.addEventListener("keyup",(function(e){"Enter"!==e.key&&"Escape"!==e.key||(t.$store.state.magicMirrorMode?t.$store.commit("stopMagicMirrorMode"):t.$store.state.fullScreen&&t.$store.commit("stopCinemaMode"))})),window.addEventListener("resize",e=>{t.$store.commit("setWindowHeight",e)}),this.$store.state.uiConnected||"/connect"!==this.$router.currentRoute.path&&this.$router.replace("/connect").then()}},wt=bt,_t=(i("ec690"),i("db8d"),i("d0f8"),i("29c0"),Object(A["a"])(wt,a,n,!1,null,null,null)),$t=_t.exports,Tt=i("8c4f"),Ct=i("2b88"),St=i.n(Ct),It=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"container flexrow yscroll"},[e("actions-menu",{attrs:{menuItems:t.menuItems,"data-tour":"10"}}),e("v-tour",{attrs:{callbacks:t.tourCallbacks,steps:t.steps,name:"skills"}}),t._l(t.skillsToDisplay,(function(i){return t.shopOpen?t._e():e("skill",{key:i.name,attrs:{skill:i}})})),t._l(t.$store.state.storeSkills,(function(i){return t.shopOpen&&!i.installed?e("store-skill",{key:i.name,ref:i.name.toLowerCase(),refInFor:!0,attrs:{addMethod:t.addSkillToDownload,removeMethod:t.removeSkillToDownload,skill:i}}):t._e()}))],2)},Lt=[],xt=(i("14d9"),{name:"skills",data:function(){return{shopOpen:!1,skillsToDownload:[],dummySkills:{},menuItems:[{name:this.$t("tooltips.shop"),icon:"fas fa-download",extendedIcon:"fas fa-times-circle",extendedName:this.$t("tooltips.close"),isToggle:!0,callback:this.toggleShop},{name:this.$t("tooltips.download"),icon:"fas fa-check-circle",isToggle:!0,callback:this.doDownload}],steps:[{target:'[data-tour="0"]',header:{title:this.$t("tours.skills.yourSkills")},content:this.$t("tours.skills.data0"),before:t=>new Promise(t=>{this.dummySkills["dummy"]={name:"ProjectAliceDemo",author:"Alice",delayed:!1,active:!0,description:this.$t("skill.demoDesc"),icon:"fas fa-biohazard",instructions:this.$t("skill.demoInstructions"),required:!1,settings:{dummy:!0},updateAvailable:!0,version:"1.0.0",aliceMinVersion:"1.0.0",category:"system",maintainers:["project","alice"]},setTimeout(t,500)}),params:{highlight:!0}},{target:'[data-tour="1"]',content:this.$t("tours.skills.data1"),params:{highlight:!0}},{target:'[data-tour="2"]',content:this.$t("tours.skills.data2"),params:{highlight:!0}},{target:'[data-tour="3"]',content:this.$t("tours.skills.data3"),params:{highlight:!0}},{target:'[data-tour="4"]',content:this.$t("tours.skills.data4"),params:{highlight:!0}},{target:'[data-tour="5"]',content:this.$t("tours.skills.data5"),params:{highlight:!0}},{target:'[data-tour="6"]',content:this.$t("tours.skills.data6"),params:{highlight:!0}},{target:'[data-tour="7"]',content:this.$t("tours.skills.data7"),params:{placement:"right",highlight:!0}},{target:'[data-tour="8"]',content:this.$t("tours.skills.data8"),params:{placement:"right",highlight:!0}},{target:'[data-tour="9"]',content:this.$t("tours.skills.data9"),params:{placement:"right",highlight:!0}},{target:'[data-tour="10"]',content:this.$t("tours.skills.data10"),params:{placement:"left",highlight:!0}}],tourCallbacks:{onSkip:this.finishTour,onFinish:this.finishTour}}},computed:{skillsToDisplay:function(){return this.$store.state.skillTourCompleted?this.$store.state.installedSkills:this.dummySkills}},mounted:function(){this.$store.state.skillTourCompleted||this.$tours["skills"].start(),setInterval(this.reloadStoreSkills,3e5),this.reloadStoreSkills()},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){if(e.topic===k){const i=JSON.parse(e.payloadString);O()({method:"GET",url:`/skills/${i.skillName}/`,headers:{auth:t.$store.getters.apiToken}}).then(e=>{if("skill"in e.data){const i=e.data.skill;t.$set(t.$store.state.installedSkills,i.name,i),t.skillsToDownload.splice(t.skillsToDownload.indexOf(i.name),1),t.$store.state.connectVue.loadWidgetTemplates().then(),t.$store.state.connectVue.loadDeviceTypes().then(),t.$forceUpdate()}})}else if(e.topic===_){const i=JSON.parse(e.payloadString);t.$delete(t.$store.state.installedSkills,i.skillName),t.$store.state.connectVue.loadWidgetTemplates().then(),t.$store.state.connectVue.loadDeviceTypes().then(),t.$store.state.connectVue.loadWidgetInstances().then(),t.$forceUpdate()}}))},activated:function(){this.shopOpen=!1},methods:{finishTour:function(){this.$store.commit("setSkillTourCompleted")},toggleShop:function(){-1===this.$tours["skills"].currentStep&&(this.shopOpen=!this.shopOpen)},reloadStoreSkills:function(){O()({method:"GET",url:"/skills/getStore/"}).then(t=>{"store"in t.data?this.$store.commit("setStoreSkills",t.data["store"]):console.error("Error fetching store skills")})},addSkillToDownload(t){this.skillsToDownload.push(t)},removeSkillToDownload(t){this.skillsToDownload=this.skillsToDownload.filter(e=>e!==t)},doDownload:function(){if(this.skillsToDownload.length<=0)return void this.toggleShop();let t=this;O()({method:"PUT",url:"/skills/installSkills/",data:this.skillsToDownload,headers:{auth:this.$store.getters.apiToken}}).then(e=>{if("status"in e.data)for(const[i,s]of Object.entries(e.data.status))"ok"===s&&(t.$refs[i.toLowerCase()][0].setIsDownloading(),t.shopOpen=!1)})}}}),Pt=xt,Dt=Object(A["a"])(Pt,It,Lt,!1,null,null,null),Et=Dt.exports,jt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("portal",{attrs:{to:"scenarios-iframe"}})},Mt=[],Ot={name:"scenarios"},Ht=Ot,Nt=Object(A["a"])(Ht,jt,Mt,!1,null,null,null),At=Nt.exports,Ft=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"centered vcentered"},[e("form",{ref:"form",staticClass:"fullpageForm",on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("p",[e("label",{attrs:{for:"username"}},[t._v(t._s(t.$t("dialogs.labels.username")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{id:"username",placeholder:t.$t("dialogs.labels.username"),type:"text"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("p",[e("label",{attrs:{for:"pincode"}},[t._v(t._s(t.$t("dialogs.labels.pinCode")))]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.pincode,expression:"pincode"}],attrs:{id:"pincode",type:"password"},domProps:{value:t.pincode},on:{input:function(e){e.target.composing||(t.pincode=e.target.value)}}})]),e("p",[e("label",{attrs:{for:"rememberMe"}},[t._v(t._s(t.$t("dialogs.labels.rememberMe")))]),e("VueToggles",{attrs:{id:"rememberMe","checked-text":t.$t("tooltips.yes"),"unchecked-text":t.$t("tooltips.no"),value:t.rememberMe,checkedBg:"var(--windowBG)",uncheckedBg:"var(--windowBG)"},on:{click:function(e){t.rememberMe=!t.rememberMe}}})],1),e("p",[e("button",[t._v(t._s(t.$t("buttons.login")))])])])])},Vt=[],zt={name:"login",data:function(){return{username:"",pincode:"",rememberMe:!1}},methods:{login:function(){let t=new FormData;t.append("username",this.username),t.append("pin",this.pincode),O()({method:"POST",url:"/login/",data:t,headers:{"Content-Type":"multipart/form-data"}}).then(t=>{if("apiToken"in t.data)this.$store.commit("userLogin",{user:this.username,token:t.data.apiToken,authLevel:t.data.authLevel}),this.rememberMe&&(localStorage.setItem("username",this.username),localStorage.setItem("apiToken",t.data.apiToken)),O()({method:"GET",url:"/utils/config/",headers:{auth:t.data.apiToken}}).then(t=>{this.$store.commit("setSettings",t.data["config"]),this.$store.commit("setSettingTemplates",t.data["templates"]),this.$store.commit("setSettingCategories",t.data["categories"]),this.$store.state.connectVue.storeSessionSettings(),this.$store.state.connectVue.helloAlice().then(()=>{this.$store.state.connectVue.startHeartbeat()})}),this.$router.replace("/").then();else{this.username="",this.pincode="";let t=this;this.$refs.form.classList.add("failed"),setTimeout((function(){t.$refs.form.classList.remove("failed")}),2e3)}}).catch(t=>{console.log("Connection failed: "+t)})}}},qt=zt,Ut=(i("27a9"),Object(A["a"])(qt,Ft,Vt,!1,null,"745ec198",null)),Wt=Ut.exports,Rt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"container flexcolumn"},[e("tabs",{attrs:{activeTabId:t.activeTabId,parent:this,store:t.$store,tabs:t.tabs}}),1===t.activeTabId?e("div",{staticClass:"tab_page"},[e("config",{attrs:{actions:t.actions,byCategory:!0,holder:t.$store.state.settings,includeFilter:!0,templates:t.$store.state.settingTemplates,translate:e=>t.$t(e),validator:!1}})],1):2===t.activeTabId?e("div",{staticClass:"tab_page"},[e("div",{staticClass:"container flexrow"},[e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilityRequestAndRedirect("restart")}}},[t._m(0),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.restart"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilityRequestAndRedirect("reboot")}}},[t._m(1),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.reboot"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilityRequestAndCheck("train","projectalice.core.training")}}},[t._m(2),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.train"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilityRequestAndCheck("update","projectalice.core.updating")}}},[t._m(3),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.update"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilitySimpleRequest("addUser")}}},[t._m(4),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.addUser"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilitySimpleRequest("addWakeword")}}},[t._m(5),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.addWakeword"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilitySimpleRequest("tuneWakeword")}}},[t._m(6),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.tuneWakeword"))+" ")])]),e("div",{staticClass:"utility clickable",on:{click:function(e){return t.utilityRequestAndRedirect("wipeAll")}}},[t._m(7),e("p",{staticClass:"utilityName"},[t._v(" "+t._s(t.$t("utilities.wipe"))+" ")])])])]):t._e()],1)},Bt=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-redo-alt",attrs:{id:"utilityRestart"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-power-off",attrs:{id:"utilityReboot"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-brain",attrs:{id:"utilityTrain"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-sync",attrs:{id:"utilityUpdate"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-user-plus",attrs:{id:"utilityAddUser"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-comment-medical",attrs:{id:"utilityAddWakeword"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-volume-up",attrs:{id:"utilityTuneWakeword"}})])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("p",{staticClass:"utilityIcon"},[e("i",{staticClass:"fas fa-bomb",attrs:{id:"utilityWipeAll"}})])}],Gt={name:"admin",data:function(){return{activeTabId:1,tabs:{1:{icon:"fas fa-cogs",id:1,position:0},2:{icon:"fas fa-tools",id:2,position:1}},actions:{save:{action:this.save}}}},methods:{save:function(t){let e=this;t.target["data-success"]=!1,O()({method:"PATCH",url:"/utils/config/",headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"},data:this.$store.state.settings}).then((function(){t.target["data-success"]=!0,e.$i18n.locale=e.$store.state.settings["activeLanguage"]}))},utilityRequestAndRedirect:function(t){const e=this.startIcon(t),i=this;O()({method:"GET",url:`/utils/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then((function(){e.classList.add("green"),setTimeout(()=>{e.classList.remove("fa-spin"),i.$router.replace("/syslog").catch(()=>{})},2e3)})).catch((function(){e.classList.add("red"),setTimeout(()=>{e.classList.remove("fa-spin")},2e3)})).finally(()=>{setTimeout(()=>{e.classList.remove("fa-spin"),e.classList.remove("red"),e.classList.remove("green")},4e3)})},utilityRequestAndCheck:function(t,e){const i=this.startIcon(t),s=this;O()({method:"GET",url:`/utils/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then((function(){s.checkState(e,i)})).catch((function(){setTimeout(()=>{i.classList.remove("fa-spin"),i.classList.add("red")},1e3)}))},utilitySimpleRequest:function(t){const e=this.startIcon(t);O()({method:"GET",url:`/utils/${t}/`,headers:{auth:this.$store.getters.apiToken,uid:localStorage.getItem("interfaceUid")}}).then(t=>{"success"in t.data&&t.data["success"]?setTimeout(()=>{e.classList.remove("fa-spin"),e.classList.add("green")},2e3):e.classList.add("red")}).catch((function(){setTimeout(()=>{e.classList.remove("fa-spin"),e.classList.add("red")},2e3)})).finally(()=>{setTimeout(()=>{e.classList.remove("fa-spin"),e.classList.remove("red"),e.classList.remove("green")},4e3),this.$router.replace("/dialogView").then()})},startIcon:function(t){const e=document.querySelector("#utility"+(t.charAt(0).toUpperCase()+t.slice(1)));return e.classList.add("fa-spin"),e},checkState:function(t,e){let i=this;O()({method:"GET",url:`/state/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then(s=>{"state"in s.data?4===s.data["state"]?(e.classList.remove("fa-spin"),e.classList.add("green"),setTimeout((function(){e.classList.remove("green")}),2e3)):9===s.data["state"]?(e.classList.remove("fa-spin"),e.classList.add("red")):1===s.data["state"]&&setTimeout((function(){i.checkState(t,e)}),1e3):setTimeout((function(){i.checkState(t,e)}),1e3)}).catch(()=>{e.classList.remove("fa-spin"),e.classList.add("red")})}}},Yt=Gt,Jt=(i("d816"),i("2d7a"),Object(A["a"])(Yt,Rt,Bt,!1,null,"3e01a471",null)),Kt=Jt.exports,Xt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"container flexcolumn"},[e("div",{staticClass:"syslogContainer"},[e("actions-menu",{attrs:{menuItems:t.menuItems}}),e("div",{staticClass:"terminal",attrs:{id:"terminal"}},t._l(t.logs,(function(i){return e("div",{staticClass:"logLine"},[e("span",{staticClass:"logTime logDim"},[t._v("["+t._s(i.time)+"]")]),e("span",{staticClass:"logComponent logDim"},[t._v("["+t._s(i.component)+"]")]),e("span",{staticClass:"logMsg",class:"log"+i.level,domProps:{innerHTML:t._s(i.msg)}})])})),0),e("div",{staticClass:"terminalInput"},[e("form",{on:{submit:function(e){return e.preventDefault(),t.sendCmd.apply(null,arguments)}}},[e("label",{attrs:{for:"input"}},[t._v(t._s(t.$t("labels.sendCommand"))+" ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.cmd,expression:"cmd"}],attrs:{id:"input",type:"text"},domProps:{value:t.cmd},on:{input:function(e){e.target.composing||(t.cmd=e.target.value)}}}),e("button",[t._v(t._s(t.$t("buttons.send")))])])])],1)])},Zt=[],Qt=(i("5b81"),function(t){return t=t.replace(/\*\*(.*?)\*\*/gi,'<span class="logBold">$1</span>'),t=t.replace(/--(.*?)--/gi,'<span class="logDim">$1</span>'),t=t.replace(/__(.*?)__/gi,'<span class="logUnderlined">$1</span>'),t=t.replace(/!\[(red|green|yellow|blue|grey)]\((.*?)\)/gi,'<span class="$1">$2</span>'),t=t.replace(/\[=>]/gi,'<span class="logSpacer"> </span>'),t=t.replaceAll("\n","<br/>"),t}),te={name:"syslog",data:function(){return{cmd:"",unwatch:{},follow:!0,logs:[],menuItems:[{name:this.$t("tooltips.lock"),icon:"far fa-pause-circle",extendedIcon:"far fa-play-circle",extendedName:this.$t("tooltips.follow"),isToggle:!0,onClick:()=>{this.follow=!this.follow}}]}},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){if(e.topic===y){let i=JSON.parse(e.payloadString);i.msg=Qt(i.msg),t.logs.push(i)}}))},activated:function(){if(this.follow){let t=this.$el.querySelector("#terminal");t.scrollTop=t.scrollHeight}},updated:function(){if(this.follow){let t=this.$el.querySelector("#terminal");t.scrollTop=t.scrollHeight}},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(y),this.unwatch()},methods:{sendCmd:function(){const t=new FormData;t.append("cmd",this.cmd),O()({method:"POST",url:"/utils/sysCmd/",data:t,headers:{auth:this.$store.getters.apiToken,"Content-Type":"multipart/form-data"}})}}},ee=te,ie=(i("d813"),Object(A["a"])(ee,Xt,Zt,!1,null,null,null)),se=ie.exports,ae=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"container flexcolumn"},[e("div",{staticClass:"syslogContainer"},[e("actions-menu",{attrs:{menuItems:t.menuItems}}),e("div",{staticClass:"logVerbosity"},[e("i",{staticClass:"fa-circle",class:t.verbosity>-1?"fas yellow":"far",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fa-circle",class:t.verbosity>0?"fas yellow":"far",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fa-circle",class:t.verbosity>1?"fas yellow":"far",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fa-circle",class:t.verbosity>2?"fas yellow":"far",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fa-circle",class:t.verbosity>3?"fas yellow":"far",attrs:{"aria-hidden":"true"}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.decreaseVerbosity"),expression:"$t('tooltips.decreaseVerbosity')"}],staticClass:"fas fa-minus-circle clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setVerbosity(-1)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.increaseVerbosity"),expression:"$t('tooltips.increaseVerbosity')"}],staticClass:"fas fa-plus-circle clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setVerbosity(1)}}})]),e("div",{staticClass:"terminal",attrs:{id:"terminal"}},t._l(t.logs,(function(i){return e("div",{staticClass:"logLine"},[e("span",{staticClass:"logTime logYellow"},[t._v("["+t._s(i.time)+"]")]),e("span",{staticClass:"logComponent logYellow"},[t._v("["+t._s(i.component)+"]")]),e("span",{staticClass:"logMsg",domProps:{innerHTML:t._s(i.text)}})])})),0)],1)])},ne=[],oe={name:"alicewatch",data:function(){return{verbosity:1,unwatch:{},follow:!0,logs:[],menuItems:[{name:this.$t("tooltips.lock"),icon:"far fa-pause-circle",extendedIcon:"far fa-play-circle",extendedName:this.$t("tooltips.follow"),isToggle:!0,onClick:()=>{this.follow=!this.follow}}]}},created:function(){let t=localStorage.getItem("alicewatchVerbosity")||1;this.verbosity=parseInt(t);let e=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(t){if(t.topic===v){let i=JSON.parse(t.payloadString);if(i.verbosity>e.verbosity)return;i.text=Qt(i.text),e.logs.push(i)}}))},activated:function(){if(this.follow){let t=this.$el.querySelector("#terminal");t.scrollTop=t.scrollHeight}},updated:function(){if(this.follow){let t=this.$el.querySelector("#terminal");t.scrollTop=t.scrollHeight}},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(v),this.unwatch()},methods:{setVerbosity:function(t){this.verbosity=Math.max(0,Math.min(this.verbosity+t,4)),isNaN(this.verbosity)&&(this.verbosity=0),localStorage.setItem("alicewatchVerbosity",this.verbosity)}}},le=oe,re=(i("d815"),Object(A["a"])(le,ae,ne,!1,null,"548f8efc",null)),ce=re.exports,de=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"container flexcolumn"},[e("div",{class:{waiting:t.waiting||t.success||t.failed,waitHidden:!t.waiting&&!t.success&&!t.failed}},[e("div",{staticClass:"centered"},[t.waiting?e("i",{ref:"animatedIcon",staticClass:"fas fa-spinner fa-pulse fa-4x",attrs:{"aria-hidden":"true"}}):t.success?e("i",{ref:"animatedIcon",staticClass:"fas fa-check fa-4x green",attrs:{"aria-hidden":"true"}}):t.failed?e("i",{ref:"animatedIcon",staticClass:"fas fa-exclamation-triangle fa-4x red",attrs:{"aria-hidden":"true"}}):t._e()])]),t.createNew?e("div",{staticClass:"settingsContainer"},[t._m(0),e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),e("config",{attrs:{actions:{create:{text:t.$t("buttons.create"),action:t.createSkill,condition:t.allValid&&!t.waiting}},byCategory:!0,"conf-prefix":"skill ",failed:t.failed,holder:t.values,includeFilter:!0,success:t.success,templates:t.newSkill(),"text-buttons":!0,translate:e=>t.$t(e),validator:!1,waiting:t.waiting}}),e("span",{ref:"skillNameExists",staticClass:"red initialHidden",staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.$t("devMode.skillAlreadyExists")))])],1):null===t.editingSkill?e("div",[e("div",{staticClass:"container flexrow yscroll"},[e("editSkillTile",{key:"newSkill",ref:"newSkill",attrs:{skill:t.newSkillTile},on:{"skill-selected":()=>{this.createNew=!0}}}),t._l(this.$store.state.installedSkills,(function(i){return e("editSkillTile",{key:i.name,ref:i.name.toLowerCase(),refInFor:!0,attrs:{skill:i},on:{"skill-selected":t.startEditingSkill}})}))],2)]):e("div",{staticClass:"container flexcolumn"},[e("tabs",{attrs:{activeTabId:t.activeTabId,parent:this,store:t.$store,tabs:t.tabs}}),"settings"===t.activeTabId||void 0===t.activeTabId?e("div",{staticClass:"tab_page"},[e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),t._m(1),t.changedSkill.installFile?e("config",{attrs:{byCategory:!0,holder:t.changedSkill.installFile,templates:t.configTemplate(),translate:e=>t.$t(e),validator:!1,waiting:t.waiting}}):t._e()],1):"training"===t.activeTabId?e("div",{staticClass:"tab_page"},[e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),t._m(2),e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentLang,expression:"currentLang"}],on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentLang=e.target.multiple?i:i[0]}}},[e("option",{attrs:{value:"en"}},[t._v("English")]),e("option",{attrs:{value:"de"}},[t._v("German")]),e("option",{attrs:{value:"fr"}},[t._v("French")]),e("option",{attrs:{value:"it"}},[t._v("Italian")]),e("option",{attrs:{value:"pt"}},[t._v("Portuguese")]),e("option",{attrs:{value:"pl"}},[t._v("Polish")])]),e("dialogTemplateEditor",{ref:"dialogTemplateEditor",attrs:{currentLang:t.currentLang,editingSkill:t.editingSkill},on:{waiting:function(e){t.waiting=e}}})],1):"configTemplate"===t.activeTabId?e("div",{staticClass:"tab_page"},[t._m(3),e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),e("h1",[t._v("Custom Config")]),t._v(" Add custom config settings for your skill and configure their required information."),e("br"),t._v(" Until this dialog will be smart enough to support you in the creation, see the definition here: "),e("a",{attrs:{href:"https://docs.projectalice.io/skill-development/files-in-depth.html#skill-configuration-file"}},[t._v("docs.ProjectAlice.io")]),e("br"),e("simple-json-editor",{ref:"configTemplateEditor",attrs:{configTemplate:{}},model:{value:t.editingSkill.settingsTemplate,callback:function(e){t.$set(t.editingSkill,"settingsTemplate",e)},expression:"editingSkill.settingsTemplate"}})],1):"instructions"===t.activeTabId?e("div",{staticClass:"tab_page"},[t._m(4),e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentLang,expression:"currentLang"}],on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentLang=e.target.multiple?i:i[0]}}},[e("option",{attrs:{value:"en"}},[t._v("English")]),e("option",{attrs:{value:"de"}},[t._v("German")]),e("option",{attrs:{value:"fr"}},[t._v("French")]),e("option",{attrs:{value:"it"}},[t._v("Italian")]),e("option",{attrs:{value:"pt"}},[t._v("Portuguese")]),e("option",{attrs:{value:"pl"}},[t._v("Polish")])]),e("div",{staticClass:"flexrow vcentered yscroll"},[e("div",{staticClass:"centered flexHalf stretched"},[e("configInput",{staticClass:"stretched",attrs:{configName:"instructions",holder:t.changedSkill,template:{name:"instructions",dataType:"longstring"},translate:e=>t.$t(e)},model:{value:t.changedSkill,callback:function(e){t.changedSkill=e},expression:"changedSkill"}})],1),e("div",{staticClass:"centered flexHalf stretched"},[e("vue-simple-markdown",{staticClass:"contained stretched",attrs:{source:t.changedSkill.instructions}})],1)])],1):"talk"===t.activeTabId?e("div",{staticClass:"tab_page"},[e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),t._m(5),e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentLang,expression:"currentLang"}],on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.currentLang=e.target.multiple?i:i[0]}}},[e("option",{attrs:{value:"en"}},[t._v("English")]),e("option",{attrs:{value:"de"}},[t._v("German")]),e("option",{attrs:{value:"fr"}},[t._v("French")]),e("option",{attrs:{value:"it"}},[t._v("Italian")]),e("option",{attrs:{value:"pt"}},[t._v("Portuguese")]),e("option",{attrs:{value:"pl"}},[t._v("Polish")])]),e("talkFileEditor",{ref:"talkFileEditor",attrs:{currentLang:t.currentLang,editingSkill:t.editingSkill},on:{waiting:function(e){t.waiting=e}}})],1):"cloud"===t.activeTabId?e("div",{staticClass:"tab_page"},[e("actions-menu",{attrs:{alwaysExtended:!0,menuItems:t.menuItems}}),e("git-status",{staticStyle:{width:"100%"},attrs:{skill:t.editingSkill.name}})],1):t._e()],1)])},ue=[function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])},function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"WIP"},[e("i",{staticClass:"fab fa-hotjar yellow"}),t._v(" new feature - handle with care! "),e("i",{staticClass:"fab fa-hotjar yellow"}),e("br")])}],he={name:"devmode",data:function(){return{activeTabId:"settings",tabs:{settings:{icon:"fas fa-cogs",id:"settings",position:0,onChangeTo:this.loadInstallFile,checkAllowLeaveFrom:this.checkAllowLeaveFromSettings},training:{icon:"fas fa-train",id:"training",position:1,checkAllowLeaveFrom:this.checkAllowLeaveFromTraining},talk:{icon:"fas fa-comment",id:"talk",position:2,checkAllowLeaveFrom:this.checkAllowLeaveFromTalk},configTemplate:{icon:"fas fa-cog",id:"configTemplate",position:3,checkAllowLeaveFrom:this.checkAllowLeaveFromConfigTemplate},instructions:{icon:"fas fa-chalkboard-teacher",id:"instructions",position:4,onChangeTo:this.loadInstruction,checkAllowLeaveFrom:this.checkAllowLeaveFromInstructions},devices:{icon:"fas fa-microchip",id:"devices",position:5},widgets:{icon:"fas fa-window-maximize",id:"widgets",position:6},cloud:{icon:"fas fa-cloud",id:"cloud",position:7}},values:{conditions:{}},skills:[],storeSkills:[],waiting:!1,success:!1,failed:!1,editingSkill:null,editingIntent:null,editingSlotType:null,createNew:!1,currentLang:"en",changedSkill:{},backedUpSkill:{},noWatch:!1,menuItems:[{name:"save",icon:"fas fa-save",isToggle:!1,callback:this.saveSkill},{name:"help",icon:"fas fa-question-circle",isToggle:!1,callback:this.showHelp},{name:"close",icon:"fas fa-times-circle",isToggle:!1,callback:this.stopEditingSkill}],newSkillTile:{name:"Create New Skill",author:"You!",description:"Start here for creating your own skill!",modified:!0}}},mounted:function(){O()({method:"GET",url:"/skills/getStore/"}).then(t=>{if("store"in t.data)for(const e of Object.keys(t.data["store"]))this.storeSkills.push(e.toLowerCase())}),this.fetchSkills(),this.currentLang=this.$store.state.settings["activeLanguage"]},computed:{allValid:function(){return document.querySelectorAll(".invalid, .missing").length<=0},intentDefinition:function(){for(const t of Object.values(this.changedSkill.dialogTemplate.intents))if(console.log(t),console.log("intent "+t.name),t.name===this.editingIntent)return t},intentContainedSlots:function(){let t=[];for(const e of Object.values(this.intentDefinition.slots))t.push(e.name);return t}},watch:{currentLang:function(t,e){if("instructions"===this.activeTabId){if(this.noWatch)return;this.noWatch=!0;let i=this;this.backedUpSkill&&this.backedUpSkill.instructions&&this.backedUpSkill.instructions!==this.changedSkill.instructions?this.$dialog.confirm({title:"Your changes will be lost!",body:"Close to return to "+e+" or continue to "+t+"?",okText:"Okidoki",cancelText:this.$t("buttons.cancel")}).then((function(t){i.loadInstruction(),i.noWatch=!1})).catch((function(t){i.currentLang=e,i.$nextTick(()=>{i.noWatch=!1})})):(this.loadInstruction(),this.noWatch=!1)}}},methods:{async checkAllowLeaveFromConfigTemplate(){var t;return null===(t=this.$refs.configTemplateEditor)||void 0===t||!t.isModified||this.askChangesLost()},async checkAllowLeaveFromSettings(){return JSON.stringify(this.changedSkill.installFile)===JSON.stringify(this.backedUpSkill.installFile)||this.askChangesLost()},async checkAllowLeaveFromInstructions(){return this.changedSkill.instructions===this.backedUpSkill.instructions||this.askChangesLost()},async checkAllowLeaveFromTraining(){var t;return null===(t=this.$refs.dialogTemplateEditor)||void 0===t||!t.isModified||this.askChangesLost()},async checkAllowLeaveFromTalk(){var t;return null===(t=this.$refs.talkFileEditor)||void 0===t||!t.isModified||this.askChangesLost()},async askChangesLost(){return this.$dialog.confirm({title:"Your changes will be lost!",body:"Do you want to continue and lose your changes?",okText:"Okidoki",cancelText:this.$t("buttons.cancel")})},showHelp(){switch(this.activeTabId){case"settings":window.open("https://docs.projectalice.io/skill-development/your-first-skill.html#your-first-skill");break;case"training":window.open("https://docs.projectalice.io/skill-development/files-in-depth.html#dialog-templates");break;case"configTemplate":window.open("https://docs.projectalice.io/skill-development/files-in-depth.html#skill-configuration-file");break;case"instructions":alert("No help available");break;case"talk":window.open("https://docs.projectalice.io/skill-development/files-in-depth.html#talk-files");break;case"devices":window.open("https://docs.projectalice.io/skill-development/going-further.html#devices");break;case"widgets":window.open("https://docs.projectalice.io/skill-development/going-further.html#widgets");break;default:alert("Unknown help requested")}},startCapture:function(){console.log("start"),navigator.mediaDevices.getUserMedia({video:!0,audio:!0,width:{min:1280},height:{min:720}}).then(t=>{this.$refs.video.srcObject=t})},validateTextInput:function(t,e,i,s){const a=s.target.value;"skillName"===s.target.id&&(this.storeSkills.includes(a.toLowerCase())?(this.$refs.skillNameExists.classList.remove("initialHidden"),s.target.classList.remove("inputValid"),s.target.classList.add("inputError")):this.$refs.skillNameExists.classList.add("initialHidden"))},setWaiting:function(t=!0){this.waiting=t},setSuccess:function(){this.waiting=!1,this.success=!0;let t=this;setTimeout((function(){t.success=!1}),2e3)},setFailed:function(){this.waiting=!1,this.failed=!0;let t=this;setTimeout((function(){t.failed=!1}),2e3)},createSkill:function(t){t&&t.preventDefault(),this.setWaiting();const e=new FormData;e.append("name",this.values["name"]),e.append("speakableName",this.values["speakableName"]),e.append("description",this.values["desc"]),e.append("category",this.values["category"]),e.append("icon",this.values["icon"]);let i=this;O()({method:"PUT",url:"/skills/createSkill/",headers:{auth:this.$store.getters.apiToken,"content-type":"multipart/form-data"},data:e}).then((function(t){"success"in t.data&&(t.data["success"]?(i.createNew=!1,i.skills.push(t.data["skill"]),i.editingSkill=t.data["skill"],i.$set(i.$store.state.installedSkills,t.data["skill"].name,t.data["skill"]),i.setSuccess(),i.loadInstallFile()):i.setFailed())})).catch((function(){this.setFailed()}))},loadInstruction(){const t={lang:this.currentLang};let e=this;this.setWaiting(),O()({method:"POST",url:`/skills/${this.editingSkill.name}/getInstructions/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(t){"success"in t.data&&(t.data["success"]?(e.changedSkill.instructions=t.data["instruction"],e.backedUpSkill.instructions=JSON.parse(JSON.stringify(t.data["instruction"])),e.setWaiting(!1)):e.setFailed(t.data["message"]||"Unknown Error"))})).catch((function(t){console.log(t),e.setFailed()}))},saveInstructions(){let t=this,e={lang:this.currentLang,instruction:this.changedSkill.instructions};O()({method:"PATCH",url:`/skills/${this.editingSkill.name}/setInstructions/`,data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(e){"success"in e.data&&(e.data["success"]?(t.setSuccess(),t.changedSkill.instructions=e.data["instruction"],t.backedUpSkill.instructions=t.changedSkill.instructions):t.setFailed(e.data["message"]||"Unknown Error"))})).catch((function(e){console.log(e),t.setFailed()}))},loadInstallFile(){const t={};let e=this;this.setWaiting(),O()({method:"POST",url:`/skills/${this.editingSkill.name}/getInstallFile/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(t){"success"in t.data&&(t.data["success"]?(e.$set(e.changedSkill,"installFile",t.data["installFile"]),e.backedUpSkill.installFile=JSON.parse(JSON.stringify(t.data["installFile"])),e.setWaiting(!1)):e.setFailed(t.data["message"]||"Unknown Error"))})).catch((function(t){console.log(t),e.setFailed()}))},saveInstallFile(){let t=this,e={installFile:this.changedSkill.installFile};O()({method:"PATCH",url:`/skills/${this.editingSkill.name}/setInstallFile/`,data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(e){"success"in e.data&&(e.data["success"]?(t.setSuccess(),t.changedSkill.installFile=e.data["installFile"],t.backedUpSkill.installFile=JSON.parse(JSON.stringify(e.data["installFile"]))):t.setFailed(e.data["message"]||"Unknown Error"))})).catch((function(e){console.log(e),t.setFailed()}))},checkOnGithub:function(t){t.preventDefault(),window.open("githubUrl","_blank")},reset:function(t){t.preventDefault(),this.values={},this.waiting=!1},fetchSkills:function(){O()({method:"GET",url:"/skills/",headers:{auth:this.$store.getters.apiToken}}).then(t=>{"data"in t.data&&(this.skills=t.data.data)})},startEditingSkill(t){this.editingSkill=t,this.loadInstallFile()},stopEditingSkill(){this.editingSkill=null,this.createNew=!1},saveSkill(){var t;if(this.createNew&&this.createSkill(),this.changedSkill.instructions!==this.backedUpSkill.instructions&&this.saveInstructions(),this.changedSkill.installFile!==this.backedUpSkill.installFile&&this.saveInstallFile(),this.$refs.dialogTemplateEditor&&this.$refs.dialogTemplateEditor.save(),this.$refs.talkFileEditor&&this.$refs.talkFileEditor.save(),null!==(t=this.$refs.configTemplateEditor)&&void 0!==t&&t.prepareSave()){let t=this,e={lang:this.currentLang,configTemplate:this.editingSkill.settingsTemplate};O()({method:"PATCH",url:`/skills/${this.editingSkill.name}/setConfigTemplate/`,data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(e){"success"in e.data&&(e.data["success"]?(t.setSuccess(),t.editingSkill.settingsTemplate=e.data["configTemplate"]):t.setFailed(e.data["message"]||"Unknown Error"))})).catch((function(e){console.log(e),t.setFailed()}))}},utilityRequest(t){const e=this.startIcon(t),i=this;O()({method:"GET",url:`/skills/${this.editingSkill.name}/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then((function(s){if(void 0!==s.data["success"]&&!s.data["success"])throw s.data["message"];e.classList.add("green"),"setModified"===t?i.$set(i.editingSkill,"modified",!0):"revert"===t&&i.$set(i.editingSkill,"modified",!1),setTimeout(()=>{e.classList.remove("fa-spin")},2e3)})).catch((function(t){console.log(t),e.classList.add("red"),i.showError(i.$t("notifications.errors.somethingWentWrong")),setTimeout(()=>{e.classList.remove("fa-spin")},2e3)})).finally(()=>{setTimeout(()=>{e.classList.remove("red"),e.classList.remove("green")},4e3)})},startIcon(t){const e=document.querySelector("#utility"+(t.charAt(0).toUpperCase()+t.slice(1)));return e.classList.add("fa-spin"),e},intentsTemplate(){return{intents:{defaultValue:[],dataType:"userList",subType:"string",description:"The intents this skill will be able to handle",category:"Intents",allowDouble:!1},utterances:{defaultValue:[],dataType:"userList",subType:"utterance",description:"A collection of utterances this skill should recognize",category:"Intents",allowDouble:!1,highlights:[{slot:"city",color:"#006600",pattern:"{.*:=>city}"},{slot:"country",color:"#cc8400"},{slot:"continent",color:"#1b4958"}]}}},createWidget(){self=this,this.$dialog.prompt({title:"Please name your Widget",body:"The name will be the technical name as well as the one shown to the user!\n Don't use spaces or special characters!"},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(t){let e=t.data;O()({method:"PATCH",url:`/skills/${self.editingSkill.name}/createWidget/${e}/`,headers:{auth:self.$store.getters.apiToken,"content-type":"application/json"}})}))},createDevice(){self=this,this.$dialog.prompt({title:"Please name your device type",body:"The name will be the technical name as well as the one shown to the user!\n Don't use spaces or special characters!"},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(t){let e=t.data;O()({method:"PATCH",url:`/skills/${self.editingSkill.name}/createDeviceType/${e}/`,headers:{auth:self.$store.getters.apiToken,"content-type":"application/json"}})}))},configTemplate(){return{name:{defaultValue:"",dataType:"string",description:"The name of this intent as it can be found written in the store and folders.",obligatory:!0,category:"general",noSpace:!0,readonly:!0},speakableName:{defaultValue:"A name for the skill that is speakable for Alice - use spaces, but be careful with punctuation",dataType:"string",description:"",obligatory:!0,category:"general"},desc:{defaultValue:"",dataType:"longstring",description:"A short description of that skill. It will be shown in the store",obligatory:!0,category:"general"},version:{defaultValue:"0.0.1",dataType:"string",description:"The version of this skill. Increase this on every update.",obligatory:!0,category:"general"},icon:{defaultValue:"fas fa-biohazard",dataType:"faIcon",description:"The icon representing that skill.",category:"general"},category:{defaultValue:"assistance",dataType:"list",description:"The category your skill belongs into.",values:["assistance","automation","entertainment","game","health","household","information","kid","music","organisation","planning","robotics","security","shopping","weather"],category:"general"},conditions:{subConfig:!0,dataType:"userList",subType:"toggles",category:"lang",values:{en:{defaultValue:!0,dataType:"boolean",description:"English must be supported. A skill without english translation won't be accepted in the store.",obligatory:!0,category:"language"},de:{defaultValue:!1,dataType:"boolean",description:"",category:"language"},fr:{defaultValue:!1,dataType:"boolean",description:"",category:"language"},it:{defaultValue:!1,dataType:"boolean",description:"",category:"language"},pt:{defaultValue:!1,dataType:"boolean",description:"",category:"language"},pl:{defaultValue:!1,dataType:"boolean",description:"",category:"language"}}},aliceMinVersion:{defaultValue:"1.0.0-rc2",dataType:"string",description:"The minimum version alice needs to use that skill - if you don't know, be sure and use your current version!",category:"requirements"},pipRequirements:{defaultValue:"",dataType:"userList",subType:"string",description:"The python requirements to be installed by pip",category:"requirements"},sysreq:{defaultValue:"",dataType:"userList",subType:"string",description:"The system requirements to be installed by apt-get",category:"requirements"},conditionOnline:{defaultValue:!1,dataType:"boolean",description:"Does this skill require internet to perform its task?",category:"requirements"},conditionASRArbitrary:{defaultValue:!1,dataType:"boolean",description:"Is an arbitrary ASR capturing required for this skill?",category:"requirements"},conditionSkill:{defaultValue:"",dataType:"userList",subType:"string",description:"Are other skills required to run this skill?",category:"requirements"},conditionNotSkill:{defaultValue:"",dataType:"userList",subType:"string",description:"Are there skills this skill won't be able to run with?",category:"requirements"},conditionActiveManager:{defaultValue:"",dataType:"userList",subType:"string",description:"Is there a specific manager required in Alice?",category:"requirements"}}},newSkill(){return{name:{defaultValue:"",dataType:"string",description:"The name of this intent as it can be found written in the store and folders.",obligatory:!0,category:"general",noSpace:!0,capitalize:!0},speakableName:{defaultValue:"A name for the skill that is speakable for Alice - use spaces, but be careful with punctuation",dataType:"string",description:"",obligatory:!0,category:"general"},desc:{defaultValue:"",dataType:"longstring",description:"A short description of that skill. It will be shown in the store",obligatory:!0,category:"general"},icon:{defaultValue:"fas fa-biohazard",dataType:"faIcon",description:"The icon representing that skill.",category:"general"},category:{defaultValue:"assistance",dataType:"list",description:"The category your skill belongs into.",values:["assistance","automation","entertainment","game","health","household","information","kid","music","organisation","planning","robotics","security","shopping","weather"],category:"general"}}}}},me=he,pe=(i("32f7"),i("2d43"),Object(A["a"])(me,de,ue,!1,null,"440b1702",null)),fe=pe.exports,ge=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{key:t.uid,staticClass:"container flexcolumn"},[e("v-tour",{attrs:{callbacks:t.tourCallbacks,steps:t.steps,name:"myHome"}}),t.$store.state.loggedInUser?e("actions-menu",{attrs:{menuItems:t.menuItems}}):t._e(),t.locationsEditMode?e("div",{staticClass:"tools rightSideTools"},[e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.addLocations"),expression:"$t('tooltips.addLocations')"}],staticClass:"fas fa-plus-circle fa-2x fa-fw clickable",class:{yellow:t.toolsState.addingLocation},attrs:{"aria-hidden":"true"},on:{click:t.addLocationDialog}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.removeLocations"),expression:"$t('tooltips.removeLocations')"}],staticClass:"fas fa-trash-alt fa-2x fa-fw clickable",class:{yellow:t.toolsState.deletingLocations},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("deletingLocations",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.settings"),expression:"$t('tooltips.settings')"}],staticClass:"fas fa-cogs fa-2x fa-fw clickable",class:{yellow:t.toolsState.settingLocations},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("settingLocations",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.paintFloors"),expression:"$t('tooltips.paintFloors')"}],staticClass:"fas fa-paint-roller fa-2x fa-fw clickable",class:{yellow:t.toolsState.paintingFloors},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("paintingFloors",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.buildMode"),expression:"$t('tooltips.buildMode')"}],staticClass:"fas fa-hard-hat fa-2x fa-fw clickable",class:{yellow:t.toolsState.placingConstructions},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("placingConstructions",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.manageFurniture"),expression:"$t('tooltips.manageFurniture')"}],staticClass:"fas fa-couch fa-2x fa-fw clickable",class:{yellow:t.toolsState.placingFurniture},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("placingFurniture",!0)}}})]):t._e(),t.devicesEditMode?e("div",{staticClass:"tools rightSideTools"},[e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.addDevice"),expression:"$t('tooltips.addDevice')"}],staticClass:"fas fa-plus-circle fa-2x fa-fw clickable",class:{yellow:t.toolsState.addingDevice},attrs:{"aria-hidden":"true"},on:{click:t.addDeviceDialog}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.removeDevice"),expression:"$t('tooltips.removeDevice')"}],staticClass:"fas fa-trash-alt fa-2x fa-fw clickable",class:{yellow:t.toolsState.deletingDevices},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("deletingDevices",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.settings"),expression:"$t('tooltips.settings')"}],staticClass:"fas fa-cogs fa-2x fa-fw clickable",class:{yellow:t.toolsState.settingDevices},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("settingDevices",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.linkDevice"),expression:"$t('tooltips.linkDevice')"}],staticClass:"fas fa-link fa-2x fa-fw clickable",class:{yellow:t.toolsState.linkingDevices},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("linkingDevices",!0)}}}),e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.unlinkDevice"),expression:"$t('tooltips.unlinkDevice')"}],staticClass:"fas fa-unlink fa-2x fa-fw clickable",class:{yellow:t.toolsState.unlinkingDevices},attrs:{"aria-hidden":"true"},on:{click:function(e){return t.setActiveTool("unlinkingDevices",!0)}}})]):t._e(),t.locationsEditMode&&t.toolsState.paintingFloors?e("div",{staticClass:"tools sideTools paintFloors",on:{wheel:function(t){t.stopPropagation()}}},[e("div",{staticClass:"addTile clickable",on:{click:function(e){return t.triggerUploadWindow("floorTileInput")}}},[e("i",{staticClass:"fas fa-plus fa-2x",attrs:{"aria-hidden":"true"}}),e("input",{staticClass:"initialHidden",attrs:{id:"floorTileInput",accept:".png",type:"file"},on:{change:function(e){return t.uploadNewTile("floorTileInput")}}})]),t._l(t.$store.state.floorTiles,(function(i){return e("img",{key:i,staticClass:"clickable",class:{selected:i===t.activeFloorTile},attrs:{src:`http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/locations/floors/${i}.png`,alt:"unknown"},on:{click:function(e){t.activeFloorTile===i?t.activeFloorTile="":t.activeFloorTile=i}}})}))],2):t._e(),t.locationsEditMode&&t.toolsState.placingFurniture?e("div",{staticClass:"tools sideTools placeFurniture",on:{wheel:function(t){t.stopPropagation()}}},[e("div",{staticClass:"addTile clickable",on:{click:function(e){return t.triggerUploadWindow("furnitureTileInput")}}},[e("i",{staticClass:"fas fa-plus fa-2x",attrs:{"aria-hidden":"true"}}),e("input",{staticClass:"initialHidden",attrs:{id:"furnitureTileInput",accept:".png",type:"file"},on:{change:function(e){return t.uploadNewTile("furnitureTileInput")}}})]),t._l(t.$store.state.furnitureTiles,(function(i){return e("img",{key:i,staticClass:"clickable",class:{selected:i===t.activeFurnitureTile},attrs:{src:`http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/furniture/${i}.png`,alt:"unknown"},on:{click:function(e){t.activeFurnitureTile===i?t.activeFurnitureTile="":t.activeFurnitureTile=i}}})}))],2):t._e(),t.locationsEditMode&&t.toolsState.placingConstructions?e("div",{staticClass:"tools sideTools placeConstructions",on:{wheel:function(t){t.stopPropagation()}}},[e("div",{staticClass:"addTile clickable",on:{click:function(e){return t.triggerUploadWindow("constructionTileInput")}}},[e("i",{staticClass:"fas fa-plus fa-2x",attrs:{"aria-hidden":"true"}}),e("input",{staticClass:"initialHidden",attrs:{id:"constructionTileInput",accept:".png",type:"file"},on:{change:function(e){return t.uploadNewTile("constructionTileInput")}}})]),t._l(t.$store.state.constructionTiles,(function(i){return e("img",{key:i,staticClass:"clickable",class:{selected:i===t.activeConstructionTile},attrs:{src:`http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/constructions/${i}.png`,alt:"unknown"},on:{click:function(e){t.activeConstructionTile===i?t.activeConstructionTile="":t.activeConstructionTile=i}}})}))],2):t._e(),e("div",{ref:"myHomeEditor",staticClass:"myHomeEditor",class:{fullscreen:t.$store.state.fullScreen,editMode:t.locationsEditMode},attrs:{"data-tour":"0"}},[e("div",{staticClass:"compass",attrs:{"data-tour":"1"}},[e("div",{staticClass:"cardinalPoint n"},[t._v("N")]),e("div",{staticClass:"cardinalPoint e"},[t._v("E")]),e("div",{staticClass:"cardinalPoint s"},[t._v("S")]),e("div",{staticClass:"cardinalPoint w"},[t._v("W")]),e("i",{ref:"centerPointer",staticClass:"fas fa-location-arrow clickable",attrs:{id:"centerPointer","aria-hidden":"true","data-tour":"2"},on:{click:t.recenter}})]),e("div",{ref:"ghost",staticClass:"ghost",class:{hidden:!t.activeFloorTile&&!t.activeFurnitureTile&&!t.activeConstructionTile},style:t.ghostBackground}),e("div",{ref:"floorPlan",staticClass:"floorPlan",class:{locationsEditMode:t.locationsEditMode,addLocation:t.toolsState.addingLocation},style:`\n\t\t\t\ttransform: scale(${t.zoomLevel});\n\t\t\t\tleft:${t.floorPlanX}px;\n\t\t\t\ttop:${t.floorPlanY}px;\n\t\t\t`,attrs:{id:"floorPlan"},on:{click:t.floorPlanClick,mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.handleClick,touchend:t.handleClick,touchmove:t.mouseMove,touchstart:t.mouseDown}},[e("div",{ref:"center",attrs:{id:"center"}}),t.toolsState.addingLocation?e("div",{staticClass:"reactiveLayer",on:{mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.handleClick}},[t.toolsState.addingLocation&&t.clicked?e("div",{ref:"areaSelector",staticClass:"areaSelector",style:`pointer-events: none; top: ${t.areaSelectorY}px; left: ${t.areaSelectorX}px; width: ${t.areaSelectorW}px; height: ${t.areaSelectorH}px`}):t._e()]):t._e(),t._l(t.locations,(function(i){return e("location",{key:i.id,attrs:{data:i,myHome:t.me}})}))],2)])],1)},ve=[],ye=i("3bb6"),ke=i("3e5b"),be=i.n(ke),we={name:"myhome",data:function(){return{uid:Object(kt["a"])(),me:"",menuItems:[{name:this.$t("tooltips.edit"),icon:"fas fa-pen-square",isToggle:!0,extendedIcon:"fas fa-times-circle",extendedName:this.$t("tooltips.close"),onClose:this.closeEditor,onOpen:this.openEditor},{name:this.$t("tooltips.theaterMode"),icon:"fas fa-person-booth",isToggle:!0,callback:this.cinemaMode},{name:this.$t("tooltips.manageLocations"),icon:"fas fa-map-marked-alt",callback:this.setLocationsEditMode},{name:this.$t("tooltips.manageDevices"),icon:"fas fa-plug",callback:this.setDevicesEditMode}],moveableItem:new ye["a"](this),locationsEditMode:!1,devicesEditMode:!1,toolsState:{none:!0,addingLocation:!1,paintingFloors:!1,deletingLocations:!1,addingDevice:!1,deletingDevices:!1,settingDevices:!1,linkingDevices:!1,unlinkingDevices:!1,settingLocations:!1,placingFurniture:!1,placingConstructions:!1},newLocationName:"",activeFloorTile:"",activeFurnitureTile:"",activeConstructionTile:"",activeDeviceTile:"",areaSelectorX:0,areaSelectorY:0,areaSelectorStartX:0,areaSelectorStartY:0,areaSelectorW:0,areaSelectorH:0,clicked:!1,dragging:!1,draggingPlan:!1,draggingPlanStartX:0,draggingPlanStartY:0,floorPlanX:0,floorPlanY:0,zoomLevel:1,deviceLinkParent:null,newConnectionLink:null,connectionLinks:{},tourCallbacks:{onSkip:this.finishTour,onFinish:this.finishTour},steps:[{target:'[data-tour="0"]',header:{title:this.$t("tours.myHome.myHome")},content:this.$t("tours.myHome.data0"),params:{highlight:!0,placement:"bottom"},before:t=>new Promise(t=>{setTimeout(t,500)})},{target:'[data-tour="1"]',content:this.$t("tours.myHome.data1"),params:{highlight:!0}},{target:'[data-tour="2"]',content:this.$t("tours.myHome.data2"),params:{highlight:!0}}]}},computed:{locations:function(){return Object.values(this.$store.state.locations).filter(t=>0===t.parentLocation)},ghostBackground:function(){let t="locations/floors/floor-80.png";return this.activeFloorTile?t=`locations/floors/${this.activeFloorTile}.png`:this.activeFurnitureTile?t=`furniture/${this.activeFurnitureTile}.png`:this.activeConstructionTile?t=`constructions/${this.activeConstructionTile}.png`:this.activeDeviceTile&&(t=`deviceTypes/${this.activeDeviceTile.skillName.toLowerCase()}/${this.activeDeviceTile.deviceTypeName.toLowerCase()}.png`),`background-image: url('http://${this.$store.state.settings["aliceIp"]}:${this.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/${t}');`},shownDeviceTypes:function(){let t={};for(const[e,i]of Object.entries(this.$store.state.deviceTypes)){let s=[];for(const t of i)this.canAddDevice(t)&&"webinterface"!==t.deviceTypeName.toLowerCase()&&s.push(t);s.length>0&&(t[e]=s)}return t}},created:function(){this.me=this;let t=this;this.setActiveTool("none"),document.addEventListener("keyup",(function(e){"/myhome"===t.$route.path.toLowerCase()&&"Escape"===e.key&&(""!==t.activeConstructionTile||""!==t.activeFurnitureTile||""!==t.activeFloorTile||""!==t.activeDeviceTile||t.newConnectionLink?(t.activeConstructionTile="",t.activeFurnitureTile="",t.activeFloorTile="",t.activeDeviceTile="",t.newConnectionLink&&t.newConnectionLink.remove(),t.newConnectionLink=null):t.toolsState.none?t.closeEditor():t.setActiveTool("none"))})),document.addEventListener("wheel",(function(e){"/myhome"===t.$route.path.toLowerCase()&&(e.deltaY>1?t.zoomLevel=Math.max(t.zoomLevel-.05,.1):t.zoomLevel=Math.min(t.zoomLevel+.05,3),localStorage.setItem("zoomLevel",t.zoomLevel),t.moveableItem.destroyMoveable(),t.refreshDeviceLinks())})),document.addEventListener("contextmenu",(function(){"/myhome"===t.$route.path.toLowerCase()&&(t.activeDeviceTile?t.activeDeviceTile="":t.activeConstructionTile?t.activeConstructionTile="":t.activeFurnitureTile?t.activeFurnitureTile="":t.activeFloorTile?t.activeFloorTile="":t.newConnectionLink?(t.newConnectionLink.remove(),t.newConnectionLink=null):t.toolsState.none?t.closeEditor():t.setActiveTool("none"))})),this.floorPlanX=parseInt(localStorage.getItem("floorPlanX"))||0,this.floorPlanY=parseInt(localStorage.getItem("floorPlanY"))||0,this.zoomLevel=parseFloat(localStorage.getItem("zoomLevel"))||1},mounted:function(){localStorage.getItem("myHomeTourCompleted")||this.$tours["myHome"].start(),this.areaSelector=this.$refs.areaSelector,this.positionCenterPointer();let t=this;this.$watch(()=>this.devicesEditMode,(e,i)=>{if(e)for(const s of Object.values(t.connectionLinks))s.show("draw");else for(const s of Object.values(t.connectionLinks))s.hide("fade")},{deep:!0})},activated:function(){},methods:{finishTour:function(){localStorage.setItem("myHomeTourCompleted",!0)},recenter:function(){this.floorPlanX=0,this.floorPlanY=0,this.zoomLevel=1,localStorage.setItem("floorPlanX",0),localStorage.setItem("floorPlanY",0),localStorage.setItem("zoomLevel",self.zoomLevel),this.refreshDeviceLinks()},checkDevicePerLocationLimit(t,e){const i=t.perLocationLimit;if(0===i)return!0;{let s=0;for(const i of Object.values(this.$store.state.devices))i.skillName===t.skillName&&i.deviceType===t.deviceTypeName&&i.parentLocation===e&&s++;return s<i}},canAddDevice:function(t){if(t.totalDeviceLimit>0){let e=0;for(const i of Object.values(this.$store.state.devices))t.skillName===i.skillName&&t.deviceTypeName===i.typeName&&e++;return e<t.totalDeviceLimit}return!0},getDeviceType:function(t){const e=t.data.skillName.toLowerCase(),i=t.data.typeName.toLowerCase();if(!e in this.$store.state.deviceTypes)return null;for(const s of this.$store.state.deviceTypes[e])if(s.deviceTypeName.toLowerCase()===i)return s;return null},drawDeviceLinks:function({specificLinkId:t,specificDeviceId:e,specificLocationId:i}={}){let s=this;for(const n of Object.values(this.$store.state.deviceLinks)){if(void 0!==t&&n.id!==t||void 0!==e&&n.deviceId!==e||void 0!==i&&n.targetLocation!==i)continue;let o=null;function a(t,e){if("location"===t.$options.name||"myhome"===t.$options.name)for(const i of t.$children){let t=a(i,e);if(t)return t}else if("device"===t.$options.name&&t.data.id===e)return t}o=a(s,n.deviceId),o&&this.newDeviceLink(n,o)}},newDeviceLink(t,e){const i=be.a.captionLabel(this.$store.state.locations[t.targetLocation].name),s=document.querySelector("#loc_"+t.targetLocation),a=new be.a(e.$el,be.a.pointAnchor(s,{x:s.style.width/2,y:s.style.height/2}),{color:"#343434",size:3,dash:{animation:{duration:250,timing:"linear"}},dropShadow:!0,endPlug:"disc",endPlugSize:3,hide:!0,middleLabel:i});e.myLinks[t.id]=a,e.data["parentLocation"]!==t.targetLocation&&(this.connectionLinks[t.id]=a),this.devicesEditMode&&e.data["parentLocation"]!==t.targetLocation&&a.show("draw")},refreshDeviceLinks:function(){for(const t of Object.values(this.connectionLinks))t.position()},setActiveTool:function(t,e){const i=this;Object.keys(this.toolsState).forEach((function(s,a){return i.toolsState[s]=s===t&&(!e||!i.toolsState[s])}));let s=!1;for(let a in this.toolsState)!0===this.toolsState[a]&&(s=!0);s||(i.toolsState["none"]=!0),this.newConnectionLink&&(this.newConnectionLink.remove(),this.newConnectionLink=null),this.moveableItem.destroyMoveable(),this.removeDroppable(),this.activeFloorTile="",this.activeFurnitureTile="",this.activeConstructionTile="",this.activeDeviceTile=""},removeDroppable:function(){document.querySelectorAll(".droppable").forEach(t=>{t.classList.remove("droppable")}),document.querySelectorAll(".notDroppable").forEach(t=>{t.classList.remove("notDroppable")})},setMoveable:function(t,e){this.moveableItem.setMoveable(t,e)},cinemaMode:function(){this.$store.commit("toggleCinemaMode"),this.$store.state.fullScreen&&this.showInfo(this.$t("notifications.info.theaterModeExplain"))},setLocationsEditMode:function(){this.locationsEditMode=!0,this.devicesEditMode=!1,this.setActiveTool("none")},setDevicesEditMode:function(){this.locationsEditMode=!1,this.devicesEditMode=!0,this.setActiveTool("none")},openEditor:function(){0===Object.keys(this.connectionLinks).length&&this.drawDeviceLinks()},closeEditor:function(){this.setActiveTool("none"),this.locationsEditMode=!1,this.devicesEditMode=!1,this.moveableItem.destroyMoveable(),this.removeDroppable()},removeConnectionLinks:function(){for(const t of Object.values(this.connectionLinks))t.remove();this.connectionLinks={}},floorPlanClick:function(){this.moveableItem.destroyMoveable()},addLocationDialog:function(){this.setActiveTool("none");let t=this;this.$dialog.prompt({title:this.$t("dialogs.titles.enterLocationName"),body:this.$t("dialogs.bodies.clickToAddLocation")},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(e){O()({method:"GET",url:`/myHome/locations/${e.data}/`,headers:{auth:t.$store.getters.apiToken}}).then(i=>{"location"in i.data?t.$dialog.alert(t.$t("dialogs.bodies.locationNameOrSynonymAlreadyExist")).then():(t.setActiveTool("addingLocation"),t.newLocationName=e.data)})})).catch((function(){t.setActiveTool("locationsEditMode"),t.newLocationName=""}))},triggerUploadWindow:function(t){const e=document.getElementById(t);e.click()},uploadNewTile:function(t){const e=document.getElementById(t),i=e.files[0],s=this,a=t.replace("TileInput","");let n=new FormData;n.append("newTile",i),O()({method:"PUT",url:`/myHome/locations/${a}/`,data:n,headers:{auth:this.$store.getters.apiToken,"content-type":"multipart/form-data"}}).then(t=>{if("success"in t.data&&t.data["success"]){let t;t="floor"===a?"/myHome/locations/floors/":"construction"===a?"/myHome/constructions/tiles/":"/myHome/furniture/tiles/",O()({method:"GET",url:t}).then(t=>{"data"in t.data&&(this.showSuccess(this.$t("notifications.successes.newTileAdded")),"floor"===a?s.$store.commit("setFloorTiles",t.data["data"]):"construction"===a?s.$store.commit("setConstructionTiles",t.data["data"]):s.$store.commit("setFurnitureTiles",t.data["data"]))}).catch(()=>{this.showError(this.$t("notifications.errors.newTileFailed"))})}else this.showError(this.$t("notifications.errors.newTileFailed"))})},addDeviceDialog:function(){this.setActiveTool("none");let t=this;const e={},i={view:"addDevicePromptDialog",parent:this};this.$dialog.prompt(e,i).then(e=>{e.data&&(t.setActiveTool("addingDevice"),t.activeDeviceTile=e.data)}).catch()},positionCenterPointer:function(){const t=this.$refs["center"].getBoundingClientRect(),e=this.$refs["centerPointer"].getBoundingClientRect(),i=Math.atan2(e.top+17-t.top,e.left+17-t.left)-135*Math.PI/180;this.$refs["centerPointer"].style.transform=`rotate(${i}rad)`},mouseDown:function(t){this.toolsState.addingLocation?(this.clicked=!0,this.areaSelectorStartX=t.offsetX,this.areaSelectorStartY=t.offsetY,this.drawSelectionArea(this.areaSelectorStartX,this.areaSelectorStartY)):(this.toolsState.none&&t.target.classList.contains("floorPlan")||!this.locationsEditMode&&t.target.classList.contains("location"))&&(t.target.classList.add("grabbed"),this.draggingPlan=!0,this.draggingPlanStartX=t.clientX?t.clientX:t.changedTouches[0].clientX,this.draggingPlanStartY=t.clientY?t.clientY:t.changedTouches[0].clientY)},mouseMove:function(t){if(this.toolsState.addingLocation){if(!this.clicked)return;this.drawSelectionArea(t.offsetX,t.offsetY)}else if(this.draggingPlan){let e=t.clientX?t.clientX:t.changedTouches[0].clientX,i=t.clientY?t.clientY:t.changedTouches[0].clientY;this.floorPlanX+=e-this.draggingPlanStartX,this.floorPlanY+=i-this.draggingPlanStartY,this.draggingPlanStartX=e,this.draggingPlanStartY=i,this.refreshDeviceLinks(),this.positionCenterPointer()}else if(this.toolsState.paintingFloors&&""!==this.activeFloorTile||this.toolsState.placingFurniture&&""!==this.activeFurnitureTile||this.toolsState.placingConstructions&&""!==this.activeConstructionTile||this.toolsState.addingDevice&&""!==this.activeDeviceTile||this.toolsState.linkingDevices||this.toolsState.unlinkingDevices){const e=this.$refs["myHomeEditor"].getBoundingClientRect();this.$refs["ghost"].style.top=t.clientY-25-e.top+"px",this.$refs["ghost"].style.left=t.clientX-25-e.left+"px",null!==this.newConnectionLink&&this.newConnectionLink.position()}},drawSelectionArea:function(t,e){let i=Math.min(this.areaSelectorStartX,t),s=Math.max(this.areaSelectorStartX,t),a=Math.min(this.areaSelectorStartY,e),n=Math.max(this.areaSelectorStartY,e);this.areaSelectorX=i,this.areaSelectorY=a,this.areaSelectorW=s-i,this.areaSelectorH=n-a},newConnectionLine:function(t){this.deviceLinkParent=t,this.newConnectionLink=new be.a(document.querySelector("#dev_"+t.data.id),this.$refs.ghost,{color:"blue",size:4,dash:{animation:{duration:250,timing:"linear"}},dropShadow:!0})},newDisconnectionLine:function(t){this.deviceLinkParent=t,this.newConnectionLink=new be.a(document.querySelector("#dev_"+t.data.id),this.$refs.ghost,{color:"red",size:4,dash:{animation:{duration:100,timing:"linear"}},dropShadow:!0})},handleClick:function(t){if(this.clicked=!1,this.toolsState.addingLocation){t.preventDefault(),t.stopPropagation();const e={name:this.newLocationName,parentLocation:0,settings:{x:this.areaSelectorStartX,y:this.areaSelectorStartY,w:Math.max(this.areaSelectorW||150,50),h:Math.max(this.areaSelectorH||150,50)}};this.areaSelectorX=0,this.areaSelectorY=0,this.areaSelectorStartX=0,this.areaSelectorStartY=0,this.areaSelectorW=0,this.areaSelectorH=0,this.newLocationName="",this.setActiveTool("locationsEditMode"),O()({method:"PUT",url:"/myHome/locations/",data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if("location"in t.data){let e=t.data["location"];this.$set(this.$store.state.locations,e.id,e)}})}else this.draggingPlan&&(t.target.classList.remove("grabbed"),localStorage.setItem("floorPlanX",this.floorPlanX),localStorage.setItem("floorPlanY",this.floorPlanY),this.draggingPlan=!1)},moveZUp(t){const e=t.data,i=e.settings["z"],s=i+1;if(!(s>this.$store.state.locations.length))for(const a of Object.values(this.$store.state.locations))if(a.settings["z"]===s)return a.settings["z"]-=1,e.settings["z"]=s,this.saveLocationSettings(a),void this.saveLocationSettings(t)},moveZDown(t){const e=t.data,i=e.settings["z"],s=i-1;if(e.parentLocation>0){const t=document.querySelector("#loc_"+e.parentLocation);if(s<=parseInt(t.style["z-index"]))return}if(!(s<0))for(const a of Object.values(this.$store.state.locations))if(a.settings["z"]===s)return a.settings["z"]+=1,e.settings["z"]=s,this.saveLocationSettings(a),void this.saveLocationSettings(e)},saveLocationSettings(t){const e={id:t.id,settings:t.settings};O()({method:"PATCH",url:`/myHome/locations/${e.id}/`,data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then()},checkIfSynonymIsFree(t){for(const e of Object.values(this.$store.state.locations)){if(e.name.toLowerCase()===t.toLowerCase())return!1;for(const i of e.synonyms)if(i.toLowerCase()===t.toLowerCase())return!1}return!0},removeDeviceLink(t,e){for(const i of Object.values(this.$store.state.deviceLinks))if(i.deviceId===t&&i.targetLocation===e)return this.connectionLinks[i.id].remove(),delete this.connectionLinks[i.id],this.$delete(this.$store.state.deviceLinks,i.id),i.id},removeDeviceLinks(t){for(const e of Object.values(this.$store.state.deviceLinks))e.deviceId===t&&this.connectionLinks[e.id]&&(this.connectionLinks[e.id].remove(),delete this.connectionLinks[e.id],this.$delete(this.$store.state.deviceLinks,e.id));this.refreshDeviceLinks()},deleteDevice(t){this.$delete(this.$store.state.devices,t),this.removeDeviceLinks(t)},getDeviceLinks(t){let e={};for(const i of Object.values(this.$store.state.deviceLinks))i.deviceId===t&&(e[i.id]=i);return e}},watch:{$route:{immediate:!0,handler(t){"/myhome"!==t.path&&(this.closeEditor(),this.removeConnectionLinks())}}}},_e=we,$e=(i("0e3f"),Object(A["a"])(_e,ge,ve,!1,null,"d3e73d04",null)),Te=$e.exports,Ce=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"dialogView"},[e("div",{staticClass:"messageContainer",attrs:{id:"messageContainer"}},[t._l(t.msgs,(function(i,s){return e("SpeechBubble",{key:s,attrs:{aliceGender:t.$store.state.settings["ttsType"],msg:i}})})),void 0!==t.currentSpeech?e("SpeechBubble",{key:t.msgs.length,attrs:{msg:t.currentSpeech}}):t._e()],2),e("div",{staticClass:"dvInput"},[e("input",{attrs:{type:"text"},domProps:{value:t.say},on:{input:function(e){t.say=e.target.value},keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendQuery.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:t.historyUp.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:t.historyDown.apply(null,arguments)}]}}),e("button",{on:{click:t.sendQuery}},[e("i",{staticClass:"fas fa-paper-plane",attrs:{"aria-hidden":"true"}})]),e("micStreamer",{attrs:{icon:"fas fa-microphone fa-2x"}})],1)])},Se=[],Ie=function(){var t=this,e=t._self._c;return e("div",["hermes/hotword/#/detected"===t.msg.topic?e("div",{staticClass:"userSpeech male extend"},[t._v(" Hey Alice!")]):t._e(),"hermes/tts/say"===t.msg.topic?e("div",{staticClass:"aliceSpeech extend",class:t.aliceGender},[t._v(" "+t._s(t.removeTags(JSON.parse(t.msg.payloadString)["text"]))+" ")]):t._e(),"hermes/nlu/query"===t.msg.topic?e("div",{staticClass:"userSpeech male extend"},[t._v(" "+t._s(JSON.parse(t.msg.payloadString)["input"])+" ")]):t._e(),"hermes/dialogueManager/sessionEnded"===t.msg.topic?e("div",{staticClass:"sessionEnded extend"},[t._v(" ---- Session ended: "+t._s(JSON.parse(t.msg.payloadString)["termination"]["reason"])+" ---- ")]):t._e(),"hermes/asr/partialTextCaptured"===t.msg.topic?e("div",{staticClass:"userSpeech male extend"},[t._v(" "+t._s(JSON.parse(t.msg.payloadString)["text"])+" ... ")]):t._e()])},Le=[],xe={name:"speechBubble",data:function(){return{}},props:["msg","aliceGender"],methods:{removeTags:function(t){let e=/(<([^>]+)>)/gi;return t.replace(e,"")}}},Pe=xe,De=(i("d189"),Object(A["a"])(Pe,Ie,Le,!1,null,"f0f98d12",null)),Ee=De.exports,je={name:"dialogView",components:{SpeechBubble:Ee},data:function(){return{cmd:"",unwatch:{},msgs:[],say:"",history:[],historyPosition:0,currentSpeech:void 0,currentSession:void 0,menuItems:[{name:this.$t("tooltips.close"),icon:"far fa-pause-circle",extendedIcon:"far fa-play-circle",extendedName:this.$t("tooltips.close"),isToggle:!0,onClick:()=>{}}]}},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){S===e.topic&&(t.currentSession=void 0),[C,T,S].includes(e.topic)&&t.msgs.push(e),[x,L].includes(e.topic)&&(t.currentSpeech=e),C===e.topic&&(t.currentSpeech=void 0)}))},activated:function(){let t=this.$el.querySelector("#messageContainer");t.scrollTop=t.scrollHeight},updated:function(){let t=this.$el.querySelector("#messageContainer");t.scrollTop=t.scrollHeight},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(C),this.$store.state.mqtt.unsubscribe(T),this.$store.state.mqtt.unsubscribe(S),this.unwatch()},methods:{sendQuery:function(){if(""===this.say)return;const t=new FormData;t.append("query",this.say),t.append("deviceUid",localStorage.getItem("interfaceUid")),this.history.push(this.say),this.historyPosition=this.history.length,void 0===this.currentSession?O()({method:"POST",url:"/dialog/process/",data:t,headers:{auth:this.$store.getters.apiToken,"Content-Type":"multipart/form-data"}}).then(t=>{"sessionId"in t.data&&(this.currentSession=t.data.sessionId)}):(t.append("sessionId",this.currentSession),O()({method:"POST",url:"/dialog/continue/",data:t,headers:{auth:this.$store.getters.apiToken,"Content-Type":"multipart/form-data"}})),this.say=""},historyUp:function(){this.historyPosition<=0?this.say=this.history[0]:(this.historyPosition-=1,this.say=this.history[this.historyPosition])},historyDown:function(){this.historyPosition>=this.history.length-1?this.say=this.history[-1]:(this.historyPosition+=1,this.say=this.history[this.historyPosition])}}},Me=je,Oe=(i("9f7f"),i("343d"),Object(A["a"])(Me,Ce,Se,!1,null,"0391df14",null)),He=Oe.exports,Ne=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{key:t.uid,staticClass:"container flexcolumn"},[e("overlay",{attrs:{header:t.$t("dialogs.titles.addWidgets"),opened:t.addWidgets,visible:t.addWidgets,animate:"zoom-in"},on:{closed:function(e){t.addWidgets=!1}}},t._l(t.$store.state.widgetTemplates,(function(i,s){return e("div",{key:s},[e("div",{staticClass:"skillTemplate"},[t._v(t._s(s))]),t._l(i,(function(i){return e("div",{staticClass:"widgetTemplate clickable",on:{click:function(e){return t.addWidget(s,i)}}},[t._v(" "+t._s(i)+" ")])}))],2)})),0),t.$store.state.loggedInUser?e("actions-menu",{attrs:{menuItems:t.menuItems}}):t._e(),e("tabs",{attrs:{activeTabId:t.activeTabId,addTab:t.addTab,onChange:t.changePage,parent:this,removeTab:t.removeTab,renameTab:t.renameTab,store:t.$store,tabs:t.$store.state.widgetPages}}),e("div",{key:t.activeTabId,staticClass:"tab_page",class:{magicMirrorMode:t.$store.state.magicMirrorMode},on:{click:function(e){return t.moveableItem.destroyMoveable()}}},t._l(t.activePageWidgets,(function(i){return e("widget",{key:i.id,attrs:{controller:t.controller,widget:i}})})),1)],1)},Ae=[],Fe=i("c3b2"),Ve=Fe["a"],ze=(i("f253"),i("fc4c"),i("4c75"),Object(A["a"])(Ve,Ne,Ae,!1,null,"cedb8a0e",null)),qe=ze.exports,Ue=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"topContainer"},[t.advancedMode?e("div",[e("label",[t._v(" Filter: "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.input,expression:"filter.input"}],domProps:{value:t.filter.input},on:{input:[function(e){e.target.composing||t.$set(t.filter,"input",e.target.value)},function(e){return t.buildSelection()}],keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addAllOrShow()},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])?null:t.clearSelectionOrGraph()}}})])]):t._e(),t.advancedMode?t._e():e("div",{attrs:{id:"filter"}},[e("label",{attrs:{for:"service"}},[t._v("Service:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.service,expression:"filter.service"}],attrs:{id:"service"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"service",e.target.multiple?i:i[0])},function(e){return t.buildSelection()}]}},[e("option",{attrs:{selected:""}}),t._l(t.available.services,(function(i){return e("option",{domProps:{value:i}},[t._v(t._s(i))])}))],2),e("label",{attrs:{for:"locations"}},[t._v("Locations:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.location,expression:"filter.location"}],attrs:{id:"locations"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"location",e.target.multiple?i:i[0])},function(e){return t.buildSelection()}]}},[e("option",{attrs:{selected:""}}),t._l(t.available.locations,(function(i){return e("option",{domProps:{value:i.id}},[t._v(t._s(i.id)+" - "+t._s(i.name))])}))],2),e("label",{attrs:{for:"devices"}},[t._v("Devices:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.device,expression:"filter.device"}],attrs:{id:"devices"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"device",e.target.multiple?i:i[0])},function(e){return t.buildSelection()}]}},[e("option",{attrs:{selected:""}}),t._l(t.available.devices,(function(i){return e("option",{domProps:{value:i.id}},[t._v(t._s(i.id)+" - "+t._s(i.name))])}))],2),e("label",{attrs:{for:"telemetryType"}},[t._v("Telemetry Type:")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.telemetryType,expression:"filter.telemetryType"}],attrs:{id:"telemetryType"},on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filter,"telemetryType",e.target.multiple?i:i[0])},function(e){return t.buildSelection()}]}},[e("option",{attrs:{selected:""}}),t._l(t.available.telemetryType,(function(i){return e("option",{domProps:{value:i}},[t._v(t._s(i))])}))],2)]),e("div",{staticClass:"selections"},[e("div",{staticClass:"floaty",attrs:{id:"listPossibles"}},t._l(t.available.combinations,(function(i){return e("div",{staticClass:"addMe",on:{click:function(e){return t.addSelection(i)}}},[t._v(" "+t._s(i["service"])+": "+t._s(i["location"])+" - "+t._s(i["device"])+" - "+t._s(i["type"])+" ")])})),0),e("div",{staticClass:"floaty",attrs:{id:"listSelected"}},t._l(t.selection,(function(i){return e("div",{staticClass:"added",on:{click:function(e){return t.removeSelection(i)}}},[t._v(t._s(i["service"])+": "+t._s(i["location"])+" - "+t._s(i["device"])+" - "+t._s(i["type"])+" ")])})),0)]),e("div",{staticStyle:{display:"flex","text-align":"center","align-items":"center",margin:"10px"}},[e("label",[t._v("Time (dummy): "),e("input",{directives:[{name:"model",rawName:"v-model",value:new Date(new Date-864e5).toISOString(),expression:"new Date(new Date()-(24*3600000)).toISOString()"}],domProps:{value:new Date(new Date-864e5).toISOString()},on:{input:function(e){e.target.composing||t.$set(new Date(new Date-864e5),"toISOString()",e.target.value)}}}),t._v(" - "),e("input",{directives:[{name:"model",rawName:"v-model",value:(new Date).toISOString(),expression:"new Date().toISOString()"}],domProps:{value:(new Date).toISOString()},on:{input:function(e){e.target.composing||t.$set(new Date,"toISOString()",e.target.value)}}})])]),t.advancedMode?e("button",{on:{click:function(e){t.advancedMode=!1}}},[t._v(" Normal mode ")]):t._e(),t.advancedMode?t._e():e("button",{on:{click:function(e){t.advancedMode=!0}}},[t._v(" Advanced mode ")]),e("button",{on:{click:function(e){return t.clearFilters()}}},[t._v(" Clear Filters ")]),e("button",{class:{backspace:!this.filter.input&&this.selection.length>0},on:{click:function(e){return t.clearSelection()}}},[t._v("Clear Selection ")]),e("button",{class:{backspace:!this.filter.input&&0===this.selection.length&&this.graphData.set},on:{click:function(e){return t.clearGraph()}}},[t._v(" Clear Graph ")]),e("button",{class:{enter:this.available.combinations.length>0},on:{click:function(e){return t.addAll()}}},[t._v(" Add all ")]),t.graphData.set?t.graphData.set?e("button",{class:{enter:0===this.available.combinations.length&&this.selection.length>0},on:{click:function(e){return t.createGraph()}}},[t._v(" Add to Graph ")]):t._e():e("button",{class:{enter:0===this.available.combinations.length&&this.selection.length>0},on:{click:function(e){return t.createGraph()}}},[t._v(" Show Graph ")]),t.graphData.set?e("telemetryChart",{attrs:{bind:!0,fullSpecifiedY1:t.graphData.Y1,fullSpecifiedY2:t.graphData.Y2,width:1e3}}):t._e()],1)},We=[],Re=function(){var t=this,e=t._self._c;return e("div",[t.loaded?e("chart",{attrs:{bind:!0,chartData:t.chartdata,options:t.options,width:1e3}}):t._e()],1)},Be=[],Ge=i("1fca");const{reactiveProp:Ye}=Ge["b"];var Je,Ke,Xe={extends:Ge["a"],props:["chartData","options"],mixins:[Ye],mounted(){this.renderChart(this.chartData,this.options)}},Ze=Xe,Qe=Object(A["a"])(Ze,Je,Ke,!1,null,"506c9bf9",null),ti=Qe.exports,ei={components:{Chart:ti},props:["telemetrytypeY1","telemetrytypeY2","locations","fullSpecifiedY1","fullSpecifiedY2"],data:()=>({loaded:!1,waitingForData:0,options:{elements:{point:{radius:0}},responsive:!0,maintainAspectRatio:!1,scales:{xAxes:[{type:"time",time:{displayFormats:{hour:"HH:mm",days:"DD MMM"},distribution:"linear",ticks:{autoSkip:!0,maxTicksLimit:20,maxRotation:0,minRotation:0}},display:!0}],yAxes:[{id:"Y1",type:"linear",position:"left"}]}},chartdata:{datasets:[]}}),async mounted(){this.fillData()},watch:{fullSpecifiedY1(){this.fillData()},fullSpecifiedY2(){this.fillData()},waitingForData(){0===this.waitingForData&&(this.loaded=!0)}},name:"telemetryChart",methods:{fillData:function(){this.loaded=!1,this.chartdata={datasets:[]};let t=this;try{t.fullSpecifiedY1?(t.fullSpecifiedY1.forEach((function(e){t.addDataToGraph("Y1",e["type"],e["locationId"],e["location"],e["deviceId"],e["device"])})),t.fullSpecifiedY2&&(t.fullSpecifiedY2.forEach((function(e){t.addDataToGraph("Y2",e["type"],e["locationId"],e["location"],e["deviceId"],e["device"])})),t.fullSpecifiedY2.length>0&&t.options.scales.yAxes.length<2&&t.options.scales.yAxes.push({id:"Y2",position:"right",type:"linear"}))):(t.telemetrytypeY2&&t.telemetrytypeY2.length>0&&t.options.scales.yAxes.length<2&&t.options.scales.yAxes.push({id:"Y2",position:"right",type:"linear"}),t.locations.forEach((function(e){t.telemetrytypeY1.forEach((function(i){t.addDataToGraph("Y1",i,e)})),t.telemetrytypeY2&&t.telemetrytypeY2.forEach((function(i){t.addDataToGraph("Y2",i,e)}))})))}catch(e){console.error(e)}},addDataToGraph:function(t,e,i,s,a,n){let o=this;this.waitingForData+=1,O()({method:"get",url:"/telemetry/",headers:{auth:localStorage.getItem("apiToken"),"Content-Type":"application/json"},params:{telemetryType:e,all:!0,locationId:i,deviceId:a}}).then(i=>{let a=[],n=s+" - "+e;i.data.forEach((function(t){a.push({x:1e3*t.timestamp,y:t.value})}));let l=ii();o.chartdata.datasets.push({label:n,data:a,backgroundColor:l,pointHitRadius:100,lineTension:0,yAxisID:t}),o.waitingForData-=1})}}};function ii(){let t="0123456789ABCDEF",e="#";for(let i=0;i<6;i++)e+=t[Math.floor(16*Math.random())];return e}var si=ei,ai=Object(A["a"])(si,Re,Be,!1,null,"1f3a25f5",null),ni=ai.exports,oi={components:{TelemetryChart:ni},data:()=>({name:"telemetry",overview:[],graphData:{set:!1,Y1:[],Y2:[],toggle:!1},advancedMode:!0,selection:[],available:{locations:[],devices:[],services:[],telemetryType:[],combinations:[]},filter:{service:"",location:"",device:"",telemetryType:"",input:""}}),methods:{getUnique:function(){return O()({method:"GET",url:"/telemetry/overview/",headers:{auth:this.$store.getters.apiToken,"Content-Type":"application/json"}}).then(t=>{this.overview=t.data,this.buildSelection()}),!0},buildSelection:function(){function t(t,e,i,s,a,n){let o=a["service"]+": "+a["location"]+" - "+a["device"]+" - "+a["type"],l=n.filter.input.split("*");for(const r of l)if(!o.includes(r))return!1;return(!t||a["type"]===t)&&((!e||a["deviceId"]===e)&&((!i||a["locationId"]===i)&&(!s||a["service"]===s)))}this.available.telemetryType=[],this.available.devices=[],this.available.locations=[],this.available.services=[],this.available.combinations=[];for(const e of this.overview)!this.available.telemetryType.includes(e["type"])&&t("",this.filter.device,this.filter.location,this.filter.service,e,this)&&this.available.telemetryType.push(e["type"]),!this.available.devices.some(t=>t.id===e["deviceId"])&&t(this.filter.telemetryType,"",this.filter.location,this.filter.service,e,this)&&this.available.devices.push({id:e["deviceId"],name:e["device"]}),!this.available.locations.some(t=>t.id===e["locationId"])&&t(this.filter.telemetryType,this.filter.device,"",this.filter.service,e,this)&&this.available.locations.push({id:e["locationId"],name:e["location"]}),!this.available.services.includes(e["service"])&&t(this.filter.telemetryType,this.filter.device,this.filter.location,"",e,this)&&this.available.services.push(e["service"]),!this.selection.includes(e)&&t(this.filter.telemetryType,this.filter.device,this.filter.location,this.filter.service,e,this)&&this.available.combinations.push(e)},addSelection:function(t){this.selection.push(t),this.buildSelection()},removeSelection:function(t){const e=this.selection.indexOf(t);e>-1&&this.selection.splice(e,1),this.buildSelection()},createGraph:function(){this.graphData.toggle?this.graphData.Y2=this.selection:this.graphData.Y1=this.selection,this.graphData.toggle=!this.graphData.toggle,this.graphData.set=!0,this.selection=[],this.buildSelection()},addAll:function(){let t=this;this.available.combinations.forEach((function(e){t.selection.push(e)})),this.buildSelection()},clearSelection:function(){this.selection=[],this.buildSelection()},addAllOrShow:function(){0===this.available.combinations.length?this.createGraph():this.addAll()},clearSelectionOrGraph:function(){this.filter.input||(this.selection.length>0?this.clearSelection():this.clearGraph())},clearGraph:function(){this.graphData={}},clearFilters:function(){this.filter.input="",this.filter.service="",this.filter.location="",this.filter.device="",this.filter.telemetryType="",this.buildSelection()}},created(){this.getUnique()}},li=oi,ri=(i("00d1"),Object(A["a"])(li,Ue,We,!1,null,"3dbbaa70",null)),ci=ri.exports;s["default"].use(Tt["a"]),s["default"].use(St.a);const di=[{path:"/connect",name:"Connect",component:yt,meta:{title:"connect"}},{path:"/skills",name:"Skills",component:Et,meta:{title:"nav.skills"}},{path:"/scenarios",component:At,name:"Scenarios",meta:{title:"nav.scenarios"}},{path:"/login",name:"Login",component:Wt,meta:{title:"nav.login"}},{path:"/syslog",name:"Syslog",component:se,meta:{title:"nav.syslog"}},{path:"/alicewatch",name:"AliceWatch",component:ce,meta:{title:"nav.alicewatch"}},{path:"/admin",name:"Admin",component:Kt,meta:{title:"nav.admin"}},{path:"/devmode",name:"Devmode",component:fe,meta:{title:"nav.devmode"}},{path:"/myhome",name:"MyHome",component:Te,meta:{title:"nav.myhome"}},{path:"/dialogView",name:"Dialog View",component:He,meta:{title:"nav.dialogView"}},{path:"/widgets",name:"Widgets",component:qe,meta:{title:"nav.widgets"}},{path:"/telemetry",name:"Telemetry",component:ci,meta:{title:"nav.telemetry"}},{path:"*",name:"Home",component:qe,meta:{title:"nav.widgets"}}],ui=new Tt["a"]({routes:di,mode:"abstract"});var hi=ui,mi=i("130e"),pi=i("2f62");s["default"].use(pi["a"]);var fi=new pi["a"].Store({state:{connectVue:null,settings:{},settingTemplates:{},settingCategories:{},mqtt:null,loggedInUser:!1,fullScreen:!1,magicMirrorMode:!1,minimized:!1,uiConnected:!1,mqttMessage:{},widgetPages:{},widgetTemplates:{},widgetInstances:{},installedSkills:{},storeSkills:{},skillTourCompleted:!1,furnitureTiles:[],floorTiles:[],constructionTiles:[],deviceTypes:{},devices:{},newSkillSettings:{},deviceLinks:{},furnitures:{},constructions:{},locations:{},interfaceUid:"",windowHeight:window.innerHeight},mutations:{setInterfaceUid(t,e){t.interfaceUid=e,localStorage.setItem("interfaceUid",e)},setConnectVue(t,e){t.connectVue=e},setFurnitureTiles(t,e){t.furnitureTiles=e},setFloorTiles(t,e){t.floorTiles=e},setConstructionTiles(t,e){t.constructionTiles=e},setDeviceTypes(t,e){t.deviceTypes=e},setDevices(t,e){t.devices=e},setDeviceLinks(t,e){t.deviceLinks=e},setFurnitures(t,e){t.furnitures=e},setConstructions(t,e){t.constructions=e},setLocations(t,e){t.locations=e},setSkillTourCompleted(t){t.skillTourCompleted=!0,localStorage.setItem("skillsTourCompleted",!0)},setStoreSkills(t,e){t.storeSkills=e},setInstalledSkills(t,e){t.installedSkills=e},setWidgetInstances(t,e){t.widgetInstances=e},setWidgetTemplates(t,e){t.widgetTemplates=e},setWidgetPages(t,e){t.widgetPages=e},setSettings(t,e){t.settings=e},setSettingTemplates(t,e){t.settingTemplates=e},setSettingCategories(t,e){t.settingCategories=e},setMqtt(t,e){t.mqtt=e},mqttMessage(t,e){t.mqttMessage=e},userLogin(t,e){t.loggedInUser=e},userLogout(t){t.loggedInUser={},localStorage.removeItem("username"),localStorage.removeItem("apiToken")},startCinemaMode(t){t.fullScreen=!0,localStorage.setItem("fullscreen",t.fullScreen)},stopCinemaMode(t){t.fullScreen=!1,localStorage.setItem("fullscreen",t.fullScreen)},startMagicMirrorMode(t){t.fullScreen=!0,localStorage.setItem("fullscreen",t.fullScreen),t.magicMirrorMode=!0,localStorage.setItem("magicMirrorMode",t.magicMirrorMode)},stopMagicMirrorMode(t){t.fullScreen=!1,localStorage.setItem("fullscreen",t.fullScreen),t.magicMirrorMode=!1,localStorage.setItem("magicMirrorMode",t.magicMirrorMode)},toggleCinemaMode(t){t.fullScreen=!t.fullScreen,localStorage.setItem("fullscreen",t.fullScreen)},toggleMagicMirrorMode(t){t.fullScreen=!t.fullScreen,localStorage.setItem("fullscreen",t.fullScreen),t.magicMirrorMode=!t.magicMirrorMode,localStorage.setItem("magicMirrorMode",t.magicMirrorMode)},startMinimized(t){t.minimized=!0,localStorage.setItem("minimized",t.minimized)},stopMinimized(t){t.minimized=!1,localStorage.setItem("minimized",t.minimized)},toggleMinimized(t){t.minimized=!t.minimized,localStorage.setItem("minimized",t.minimized)},uiConnected(t,e){t.uiConnected=e},setWindowHeight(t){t.windowHeight=window.innerHeight}},getters:{apiToken:function(t,e){return"object"===typeof t.loggedInUser?t.loggedInUser.token:""}}}),gi=i("4dcf"),vi=i("1881"),yi=i.n(vi),ki=i("2536"),bi=i.n(ki),wi=i("7873"),_i=i.n(wi),$i=i("03a5"),Ti=i.n($i),Ci=i("e37d"),Si=i("7602"),Ii=i.n(Si),Li=i("a925"),xi=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"skill",style:"ProjectAliceDemo"===t.skill.name?"margin-left: 200px;":"",attrs:{"data-tour":"0"}},[e("div",{staticClass:"skillTitle"},[e("div",{staticClass:"skillName"},[t._v(t._s(t.skill.name))]),e("div",{staticClass:"skillIcon"},[e("i",{class:t.skill.icon,attrs:{"aria-hidden":"true"}})])]),e("overlay",{attrs:{header:`${t.$t("skill.info")} - ${t.skill.name}`,opened:t.viewInfos,visible:t.viewInfos,animate:"zoom-in"},on:{closed:function(e){t.viewInfos=!1}}},[e("ul",{staticClass:"fa-ul"},[e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-code-branch",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.version))]),e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-compress-arrows-alt",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.aliceMinVersion)+" ")]),e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-user",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.author))]),t.skill.maintainers?e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-users",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.maintainers.join(", "))+" ")]):t._e(),e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-folder-open",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.category))]),e("li",[e("span",{staticClass:"fa-li"},[e("i",{staticClass:"fas fa-quote-right",attrs:{"aria-hidden":"true"}})]),t._v(t._s(t.skill.description))])])]),e("overlay",{attrs:{header:`${t.$t("skill.intents")} - ${t.skill.name}`,opened:t.viewIntents,visible:t.viewIntents,animate:"zoom-in"},on:{closed:function(e){t.viewIntents=!1}}},t._l(t.skill["intents"],(function(i,s){return i.length>0?e("p",[e("strong",[t._v(t._s(s)+": «")]),e("i",[t._v(t._s(i[Math.floor(Math.random()*i.length)]))]),t._v(" "),e("strong",[t._v("»")])]):t._e()})),0),e("overlay",{attrs:{header:`${t.$t("skill.instructions")} - ${t.skill.name}`,opened:t.viewInstructions,visible:t.viewInstructions,animate:"zoom-in"},on:{closed:function(e){t.viewInstructions=!1}}},[e("vue-simple-markdown",{attrs:{source:t.skill.instructions}})],1),t.viewSkill?e("div",{staticClass:"skillBody"},[e("div",{staticClass:"clickable",attrs:{"data-tour":"7"},on:{click:function(e){-1===t.$tours["skills"].currentStep&&(t.viewIntents=!0)}}},[t._v(t._s(t.$t("skill.intents")))]),e("div",{staticClass:"clickable",attrs:{"data-tour":"8"},on:{click:function(e){-1===t.$tours["skills"].currentStep&&(t.viewInfos=!0)}}},[t._v(t._s(t.$t("skill.info")))]),t.skill.instructions&&t.skill.instructions.length>0?e("div",{staticClass:"clickable",attrs:{"data-tour":"9"},on:{click:function(e){-1===t.$tours["skills"].currentStep&&(t.viewInstructions=!0)}}},[t._v(t._s(t.$t("skill.instructions")))]):t._e(),e("div",{staticClass:"skillActions"},[t.skill.settings&&Object.keys(t.skill.settings).length?e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.settings"),expression:"$t('tooltips.settings')"}],staticClass:"fas fa-cog clickable",attrs:{"aria-hidden":"true","data-tour":"1"},on:{click:t.showSettings}}):t._e(),t.skill.required?t._e():e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.skill.active?t.$t("tooltips.stop"):t.$t("tooltips.start"),expression:"skill.active ? $t('tooltips.stop') : $t('tooltips.start')"}],staticClass:"fas fa-power-off clickable",attrs:{"aria-hidden":"true","data-tour":"2"},on:{click:t.toggle}}),t.skill.active?e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.reload"),expression:"$t('tooltips.reload')"}],staticClass:"fas fa-sync clickable",attrs:{"aria-hidden":"true","data-tour":"3"},on:{click:t.reloadSkill}}):t._e(),t.skill.updateAvailable?e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.update"),expression:"$t('tooltips.update')"}],staticClass:"fas fa-arrow-alt-circle-up clickable",attrs:{"aria-hidden":"true","data-tour":"4"},on:{click:t.update}}):t._e(),t.skill.required?t._e():e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.$t("tooltips.remove"),expression:"$t('tooltips.remove')"}],staticClass:"far fa-times-circle clickable",attrs:{"aria-hidden":"true","data-tour":"5"},on:{click:t.remove}})]),e("div",{staticClass:"skillStatusAround"}),e("div",{staticClass:"skillStatus",class:t.skill.active?"active":"disabled",attrs:{"data-tour":"6"}})]):t._e()],1)},Pi=[],Di={name:"skill",data:function(){return{viewIntents:!1,viewInfos:!1,viewInstructions:!1,viewSkill:!0}},props:["skill"],created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){if(w===e.topic){let i=JSON.parse(e.payloadString);i.skillName===t.skill.skillName&&(t.skill.updateAvailable=!1)}}))},methods:{reloadSkill:function(){-1===this.$tours["skills"].currentStep&&O()({method:"GET",url:`/skills/${this.skill.name}/reload/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{"skill"in t.data&&(this.showSuccess(this.$parent.$t("notifications.successes.reloadTriggered")),this.$set(this.$store.state.installedSkills,t.data.skill.name,t.data.skill))})},toggle:function(){-1===this.$tours["skills"].currentStep&&O()({method:"GET",url:`/skills/${this.skill.name}/toggleActiveState/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{"success"in t.data&&t.data.success?this.skill.active=!this.skill.active:self.showError(self.$t("notifications.errors.skillNotActivated"))})},update:function(){-1===this.$tours["skills"].currentStep&&O()({method:"GET",url:`/skills/${this.skill.name}/checkUpdate/`,headers:{auth:this.$store.getters.apiToken}}).then(()=>{})},remove:function(){if(-1!==this.$tours["skills"].currentStep)return;let t=this;this.$dialog.confirm(this.$t("dialogs.titles.confirmSkillDeletion"),{okText:this.$t("dialogs.labels.yes"),cancelText:this.$t("dialogs.labels.cancel")}).then((function(){O()({method:"DELETE",url:`/skills/${t.skill.name}/`,headers:{auth:t.$store.getters.apiToken}}).then(e=>{"success"in e.data&&(e.data.success?t.showSuccess(this.$parent.$t("notifications.successes.skillDeleted")):t.showError(this.$parent.$t("notifications.errors.skillDeleteFailed")))})})).catch()},showSettings:function(){if(-1!==this.$tours["skills"].currentStep)return;let t=JSON.parse(JSON.stringify(this.skill["settings"])),e=this;const i={view:"skillSettingsPromptDialog",skill:this.skill,parent:this};this.$dialog.prompt({},i).then(i=>{O()({method:"PATCH",url:`/skills/${this.skill.name}/`,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"},data:JSON.stringify(i.data)}).then(i=>{this.checkResponse(i)?(t={},this.$set(this.$store.state.installedSkills,e.skill.name,e.skill)):e.skill["settings"]=t})}).catch(()=>this.skill["settings"]=t)}}},Ei=Di,ji=(i("5145"),i("1606"),Object(A["a"])(Ei,xi,Pi,!1,null,"620590e2",null)),Mi=ji.exports,Oi=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"skill"},[e("div",{staticClass:"skillTitle"},[e("svg",{staticClass:"skillName"},[e("text",{attrs:{y:"15"}},[t._v(t._s(t.skill.name))])]),e("div",{staticClass:"skillIcon"},[e("i",{class:t.skill.icon,attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"skillAuthor"},[e("i",{staticClass:"fas fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),e("span",{staticClass:"clickable"},[t._v(t._s(t.skill.author))])]),e("div",{staticClass:"skillDescription"},[t._v(" "+t._s(t.skill.desc)+" ")]),e("div",{staticClass:"download",on:{click:t.handleDownloadClick}},[e("i",{staticClass:"fas clickable",class:{"fa-download":!t.isWanted&&!t.isDownloading,"fa-check":t.isWanted&&!t.isDownloading,"fa-spinner fa-spin":!t.isWanted&&t.isDownloading},attrs:{"aria-hidden":"true"}})]),e("div",{staticClass:"compatibility"},[e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isCompatible?t.$t("tooltips.compatible"):t.notCompatibleExplained,expression:"isCompatible ? $t('tooltips.compatible') : notCompatibleExplained"}],staticClass:"fas",class:{"fa-check green":t.isCompatible,"fa-times red":!t.isCompatible},attrs:{"aria-hidden":"true"}})])])},Hi=[],Ni={name:"storeSkill",data:function(){return{isWanted:!1,isDownloading:!1}},props:["skill","addMethod","removeMethod"],computed:{isCompatible:function(){return this.skill["compatible"]},notCompatibleExplained:function(){let t=this.$t("tooltips.notCompatible")+"<br>";for(const e of this.skill["offendingConditions"])for(const[i,s]of Object.entries(e))t=`${t}${i} => ${s}<br>`;return t}},methods:{handleDownloadClick:function(){this.skill["compatible"]||this.$store.state.settings["devMode"]?this.isWanted||this.isDownloading?this.isWanted&&!this.isDownloading&&(this.isWanted=!1,this.removeMethod(this.skill.name)):(this.isWanted=!0,this.addMethod(this.skill.name)):this.showError(this.$t("notifications.errors.skillIncompatible"))},setIsDownloading:function(){this.isWanted=!1,this.isDownloading=!0}}},Ai=Ni,Fi=(i("4f39"),Object(A["a"])(Ai,Oi,Hi,!1,null,"680c085c",null)),Vi=Fi.exports,zi=function(){var t=this,e=t._self._c;return e("div",{staticClass:"skill",class:{modified:t.skill.modified}},[e("div",{staticClass:"skillTitle"},[e("svg",{staticClass:"skillName"},[e("text",{attrs:{y:"15"}},[t._v(t._s(t.skill.name))])]),e("div",{staticClass:"skillIcon"},[e("i",{class:t.skill.icon,attrs:{"aria-hidden":"true"}})])]),e("div",{staticClass:"skillAuthor"},[e("i",{staticClass:"fas fa-user",attrs:{"aria-hidden":"true"}}),t._v(" "),e("span",{staticClass:"clickable"},[t._v(t._s(t.skill.author))])]),e("div",{staticClass:"skillDescription"},[t._v(" "+t._s(t.skill.description)+" ")]),e("div",{staticClass:"download",on:{click:t.startEditing}},[e("i",{staticClass:"fas fa-cogs clickable",attrs:{"aria-hidden":"true"}})])])},qi=[],Ui={name:"editSkillTile",data:function(){return{}},props:["skill"],methods:{startEditing(){this.$emit("skill-selected",this.skill)}}},Wi=Ui,Ri=(i("c706"),Object(A["a"])(Wi,zi,qi,!1,null,"0721ffec",null)),Bi=Ri.exports,Gi=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"menu",class:{extend:t.extend,retract:t.retract,extended:t.isExtended,cinemaMode:t.$store.state.fullScreen,magicMirrorMode:t.$store.state.magicMirrorMode},on:{animationend:t.animationEnd}},t._l(t.menuItems.slice(0,t.isExtended?999:1),(function(i){return e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.isExtended&&i.extendedName||i.name,expression:"isExtended ? item.extendedName || item.name : item.name"}],key:i.name,staticClass:"menuButton clickable",class:t.isExtended&&i.extendedIcon||i.icon,attrs:{"aria-hidden":"true"},on:{click:function(e){return t.handleClick(i,e)}}})})),0)},Yi=[],Ji={name:"actionsMenu",data:function(){return{isExtended:!1,extend:!1,retract:!1}},props:["menuItems","alwaysExtended"],mounted(){this.isExtended=this.alwaysExtended},methods:{toggle:function(t){this.isExtended=!this.isExtended,!this.isExtended&&t.hasOwnProperty("onClose")?(t["onClose"](),this.extend=!1,this.retract=!0):this.isExtended&&t.hasOwnProperty("onOpen")&&(t["onOpen"](),this.retract=!1,this.extend=!0)},handleClick:function(t,e){t.hasOwnProperty("activeClass")&&(t.hasOwnProperty("active")?(t.active?e.target.classList.remove(t.activeClass):e.target.classList.add(t.activeClass),t.active=!t.active):(t.active=!0,e.target.classList.add(t.activeClass))),t.hasOwnProperty("isToggle")&&t.isToggle&&this.toggle(t),t.hasOwnProperty("onClick")&&t["onClick"](),t.hasOwnProperty("callback")&&t.callback(t)},animationEnd:function(){this.extend=!1,this.retract=!1}}},Ki=Ji,Xi=(i("e157"),Object(A["a"])(Ki,Gi,Yi,!1,null,"6295f870",null)),Zi=Xi.exports,Qi=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"tabs",class:{magicMirrorMode:t.store.state.magicMirrorMode}},[t._l(t.tabs,(function(i){return e("div",{key:i.id,staticClass:"tab clickable",class:{active:t.activeTabId===i.id},on:{click:function(e){return t.handleClick(i.id)},dblclick:function(e){return t.rename(i.id)},contextmenu:function(e){return e.preventDefault(),t.remove(i.id)}}},[e("i",{class:i.icon,attrs:{"aria-hidden":"true"}})])})),t.addTab&&t.store.state.loggedInUser?e("div",{staticClass:"tab clickable",on:{click:t.add}},[e("i",{staticClass:"fas fa-plus",attrs:{"aria-hidden":"true"}})]):t._e()],2)},ts=[],es={name:"tabs",props:["tabs","onChange","addTab","removeTab","renameTab","activeTabId","parent","store"],methods:{handleClick:function(t){let e=this.$parent.activeTabId;e!==t&&(this.tabs[e].hasOwnProperty("checkAllowLeaveFrom")?this.tabs[e].checkAllowLeaveFrom().then(()=>{this.handleClickAllowed(t)}).catch(()=>{}):this.handleClickAllowed(t))},handleClickAllowed(t){let e=this.$parent.activeTabId;this.$parent.activeTabId!==t&&(this.onChange?this.onChange(t):this.$parent.activeTabId=t),this.tabs[t].hasOwnProperty("onChangeTo")&&this.tabs[t].onChangeTo(),this.tabs[e].hasOwnProperty("onLeaveFrom")&&this.tabs[e].onLeaveFrom()},rename:function(t){this.renameTab&&this.renameTab(t)},add:function(){this.addTab&&this.addTab()},remove:function(t){this.removeTab&&this.removeTab(t)}}},is=es,ss=(i("0c45"),Object(A["a"])(is,Qi,ts,!1,null,"17cbd4d4",null)),as=ss.exports,ns=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("i",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tooltip?t.$t(t.tooltip):"",expression:"tooltip ? $t(tooltip) : ''"}],class:t.classes,attrs:{"aria-hidden":"true"},on:{click:t.handleClick}})},os=[],ls={name:"reactiveIcon",data:function(){return{classes:"",mySettings:{waitIcon:"fa-spinner",addClass:"",successClass:"fas fa-check green",failureClass:"fas fa-times red"}}},props:["icon","tooltip","timing","onClick","settings"],mounted:function(){this.mySettings={...this.mySettings,...this.settings},this.classes=this.icon+" clickable"},methods:{handleClick:function(t){null!==this.onClick&&this.onClick(t),this.classes=`fas fa-spin ${this.mySettings.waitIcon} ${this.mySettings.addClass}`;let e=this;setTimeout((function(){e.$el.getAttribute("data-success")?e.handleSuccess():e.handleFailure()}),1e3*this.timing[0]||1e3)},handleSuccess:function(){this.classes=""+this.mySettings.successClass;let t=this;setTimeout((function(){t.reset()}),1e3*this.timing[1]||1e3)},handleFailure:function(){this.classes=""+this.mySettings.failureClass;let t=this;setTimeout((function(){t.reset()}),1e3*this.timing[1]||1e3)},reset:function(){this.classes=this.icon+" clickable"}}},rs=ls,cs=(i("779a"),Object(A["a"])(rs,ns,os,!1,null,"79bdec61",null)),ds=cs.exports,us=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"location",class:{painting:t.myHome.toolsState.paintingFloors,clickable:t.myHome.locationsEditMode&&!t.myHome.toolsState.addingLocation&&!t.myHome.toolsState.paintingFloors},style:t.computeCustomStyle(),attrs:{id:"loc_"+t.data.id},on:{click:t.handleClick,mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave}},[t._l(t.locations,(function(i){return e("location",{key:"loc_"+i.id,attrs:{data:i,myHome:t.myHome}})})),t._l(t.furnitures,(function(i){return i.parentLocation===t.data.id?e("furniture",{key:"fur_"+i.id,attrs:{data:i,myHome:t.myHome}}):t._e()})),t._l(t.constructions,(function(i){return i.parentLocation===t.data.id?e("construction",{key:"con_"+i.id,attrs:{data:i,myHome:t.myHome}}):t._e()})),t._l(t.devices,(function(i){return i.parentLocation===t.data.id?e("device",{key:"dev_"+i.id,attrs:{data:i,myHome:t.myHome}}):t._e()})),e("svg",{staticClass:"locationName",attrs:{viewBox:"0 0 100 100"}},[!t.myHome.locationsEditMode||t.myHome.toolsState.placingFurniture||t.myHome.toolsState.placingConstructions?t._e():e("text",{class:{clickable:t.myHome.locationsEditMode&&!t.myHome.toolsState.addingLocation&&!t.myHome.toolsState.paintingFloors},attrs:{"text-anchor":"middle",x:"50",y:"50"},on:{click:t.rename}},[t._v(" "+t._s(t.data.name)+" ")])]),t.myHome.toolsState.settingLocations&&t.hovered?e("div",{staticClass:"widgetTool optioner",on:{click:t.openSettings}},[e("i",{staticClass:"fas fa-cogs clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.deletingLocations?e("div",{staticClass:"widgetTool deleter",on:{click:t.deleteMe}},[e("i",{staticClass:"far fa-trash-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.settingLocations&&t.hovered?e("div",{staticClass:"widgetTool zindexer"},[e("i",{staticClass:"fas fa-level-up-alt clickable",attrs:{"aria-hidden":"true"},on:{click:t.moveZUp}}),e("i",{staticClass:"fas fa-level-down-alt clickable",attrs:{"aria-hidden":"true"},on:{click:t.moveZDown}})]):t._e()],2)},hs=[],ms={name:"location",data:function(){return{rotationDelta:0,targetParentLocation:0,hovered:!1}},props:["data","myHome"],computed:{locations:function(){return Object.values(this.$store.state.locations).filter(t=>t.parentLocation===this.data.id)},constructions:function(){return Object.values(this.$store.state.constructions).filter(t=>t.parentLocation===this.data.id)},furnitures:function(){return Object.values(this.$store.state.furnitures).filter(t=>t.parentLocation===this.data.id)},devices:function(){return Object.values(this.$store.state.devices).filter(t=>t.parentLocation===this.data.id)}},methods:{computeCustomStyle:function(){let t="floor-80"===this.data.settings["t"]?"transparent":"var(--windowBG)";return this.myHome.moveableItem.computeMyHomeCustomStyle(this.data,`background: url('http://${this.$store.state.settings["aliceIp"]}:${this.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/locations/floors/${this.data.settings["t"]||"floor-80"}.png');\n\t\t\t\tbackground-color: ${t};`)},save:function(){const t={id:this.data.id,name:this.data.name,parentLocation:this.data.parentLocation,synonyms:this.data.synonyms,settings:this.data.settings};O()({method:"PATCH",url:`/myHome/locations/${this.data.id}/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{this.checkResponse(t)})},handleClick:function(t){t.stopPropagation(),this.myHome.removeDroppable();const e=this;if(this.myHome.toolsState.paintingFloors&&""!==this.myHome.activeFloorTile)this.$store.state.locations[this.data.id].settings["t"]=this.myHome.activeFloorTile,this.save();else if(this.myHome.toolsState.addingDevice&&""!==this.myHome.activeDeviceTile){if(!this.myHome.checkDevicePerLocationLimit(this.myHome.activeDeviceTile,this.data.id))return;const i={deviceType:this.myHome.activeDeviceTile.deviceTypeName,skillName:this.myHome.activeDeviceTile.skillName,parentLocation:this.data.id,settings:{x:t["layerX"]-25,y:t["layerY"]-25}};O()({method:"PUT",url:"/myHome/devices/",data:i,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if(this.checkResponse(t)&&"device"in t.data){let i=t.data["device"];this.$set(this.$store.state.devices,i.id,i);for(const s of Object.values(t.data.link))this.myHome.$set(this.$store.state.deviceLinks,s.id,s),setTimeout((function(){e.myHome.drawDeviceLinks({specificLinkId:s.id})}),1e3)}this.myHome.setActiveTool("none")})}else if(this.myHome.toolsState.placingFurniture){if(""===this.myHome.activeFurnitureTile)return;const e={parentLocation:this.data.id,settings:{x:t["layerX"]-25,y:t["layerY"]-25,w:50,h:50,z:0,r:0,t:this.myHome.activeFurnitureTile}};O()({method:"PUT",url:"/myHome/furniture/",data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if(this.checkResponse(t)&&"furniture"in t.data){let e=t.data["furniture"];this.$set(this.$store.state.furnitures,e.id,e)}})}else if(this.myHome.toolsState.placingConstructions){if(""===this.myHome.activeConstructionTile)return;const e={parentLocation:this.data.id,settings:{x:t["layerX"]-25,y:t["layerY"]-25,w:50,h:50,r:0,t:this.myHome.activeConstructionTile,b:""}};O()({method:"PUT",url:"/myHome/constructions/",data:e,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if(this.checkResponse(t)&&"construction"in t.data){let e=t.data["construction"];this.$set(this.$store.state.constructions,e.id,e)}})}else if(this.myHome.toolsState.linkingDevices&&null!==this.myHome.newConnectionLink){if(!this.checkDeviceLinkPossible(!0))return;const t={targetLocation:this.data.id,deviceId:parseInt(this.myHome.newConnectionLink.start.id.substring(4))};O()({method:"PUT",url:"/myHome/deviceLinks/",data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if(this.checkResponse(t)){if("link"in t.data){let e=t.data["link"];this.$set(this.$store.state.deviceLinks,e.id,e),this.myHome.drawDeviceLinks({specificLinkId:e.id}),this.showSuccess(this.$t("notifications.successes.deviceLinked"))}}else this.myHome.setActiveTool("none"),this.showError(this.$t("notifications.error.deviceLinked"))})}else if(this.myHome.toolsState.unlinkingDevices&&null!==this.myHome.newConnectionLink){if(!this.isDeviceLinkedToMe(parseInt(this.myHome.newConnectionLink.start.id.substring(4))))return void this.showInfo(this.$t("notifications.info.deviceNotLinkedToLocation"));const t={targetLocation:this.data.id,deviceId:parseInt(this.myHome.newConnectionLink.start.id.substring(4))};O()({method:"DELETE",url:"/myHome/deviceLinks/",data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if(this.checkResponse(t)){this.showSuccess(this.$t("notifications.successes.deviceUnlinked"));const t=this.myHome.removeDeviceLink(parseInt(this.myHome.newConnectionLink.start.id.substring(4)),this.data.id);delete this.myHome.deviceLinkParent.myLinks[t]}else this.showError(this.$t("notifications.errors.deviceUnlinkFailed"))})}else if(!this.myHome.toolsState.settingLocations&&!this.myHome.toolsState.deletingLocations&&!this.myHome.toolsState.paintingFloors&&this.myHome.locationsEditMode){if(t.target.classList.contains("dragging")||!t.target.classList.contains("location"))return;this.myHome.setMoveable(t.target,this),this.myHome.moveableItem.setBoundaries(this.$el,10);const e=Array.from(document.querySelectorAll(".location")).filter((t,e,i)=>{const s=parseInt(t.id.substring(4));return!(s===this.data.id||this.$store.state.locations[s].parentLocation===this.data.id)});this.myHome.moveableItem.setGuidelines(e)}},rename:function(t){if(this.myHome.moveableItem.timeout===Math.floor((new Date).getTime()/250)||!this.myHome.locationsEditMode||this.myHome.toolsState.addingLocation||this.myHome.toolsState.paintingFloors||this.myHome.toolsState.placingFurniture)return;t.stopPropagation();let e=this;this.$dialog.prompt({title:this.$t("dialogs.titles.enterNewLocationName"),body:""},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(t){""!==t.data?(e.data.name=t.data,e.$set(this.$store.state.locations,e.data.id,e.data),e.$forceUpdate(),e.save()):e.showError(e.$t("notifications.errors.noLocationEmptyName"))}))},deleteMe:function(t){t.stopPropagation(),O()({method:"DELETE",url:`/myHome/locations/${this.data.id}/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{this.checkResponse(t)?(this.$delete(this.$store.state.locations,this.data.id),this.showSuccess(this.$t("notifications.successes.locationDeleted"))):this.showError(this.$t("notifications.errors.locationDeleted"))})},handleDrag:function(t,e,i,s,a){const n=document.elementsFromPoint(s,a);for(const o of n)if(o.classList.contains("location")){const t=parseInt(o.id.substring(4));if(o!==this.$el&&t!==this.data.parentLocation){this.myHome.removeDroppable(),o.classList.add("droppable"),this.targetParentLocation=t;break}}else this.targetParentLocation=0,this.myHome.removeDroppable();throw this.myHome.refreshDeviceLinks(),!0},setPosition:function(t){try{if(0===this.targetParentLocation||this.data.parentLocation===this.targetParentLocation)return this.$store.state.locations[this.data.id].settings["x"]=parseInt(t.style.left.substring(-2)),this.$store.state.locations[this.data.id].settings["y"]=parseInt(t.style.top.substring(-2)),!0;{for(const t of Object.entries(this.$store.state.locations))if(t.parentLocation===this.data.id)return;const e=document.querySelector("#loc_"+this.targetParentLocation);this.$store.state.locations[this.data.id].parentLocation=this.targetParentLocation,this.$store.state.locations[this.data.id].settings["x"]=parseInt(t.style.left.substring(-2))-parseInt(e.style.left.substring(-2)),this.$store.state.locations[this.data.id].settings["y"]=parseInt(t.style.top.substring(-2))-parseInt(e.style.top.substring(-2)),this.targetParentLocation=0}}catch(e){throw this.showError(this.$t("notifications.errors.uiError")),console.log(e),e}},moveZUp(){this.myHome.moveZUp(this)},moveZDown(){this.myHome.moveZDown(this)},openSettings(){let t=this;this.settings=!1;const e={},i={view:"locationSettingsPromptDialog",data:this.data,parent:this};this.$dialog.prompt(e,i).then(()=>{t.save()}).catch()},checkDeviceLinkPossible(t=!1){try{const e=this.myHome.deviceLinkParent,i=this.myHome.getDeviceType(e);if(!i.allowLocationLinks)return t&&this.showError(this.$t("notifications.errors.cannotLinkDevice")),!1;for(const s of Object.values(this.$store.state.deviceLinks))if(s.deviceId===e.data.id&&s.targetLocation===this.data.id)return t&&this.showInfo(this.$t("notifications.info.deviceAlreadyLinkedToLocation")),!1}catch{return t&&this.showError(this.$t("notifications.errors.unexpectedServerError")),!1}return!0},isDeviceLinkedToMe(t){for(const e of Object.values(this.$store.state.deviceLinks))if(e.deviceId===t&&e.targetLocation===this.data.id)return!0;return!1},onMouseEnter(){this.hovered=!0,this.myHome.toolsState.addingDevice?this.myHome.checkDevicePerLocationLimit(this.myHome.activeDeviceTile,this.data.id)?this.$el.classList.add("droppable"):this.$el.classList.add("notDroppable"):this.myHome.toolsState.linkingDevices&&this.myHome.newConnectionLink&&(this.checkDeviceLinkPossible()?this.$el.classList.add("droppable"):this.$el.classList.add("notDroppable"))},onMouseLeave(){this.hovered=!1,this.$el.classList.remove("droppable"),this.$el.classList.remove("notDroppable")}}},ps=ms,fs=(i("6f03"),i("4718"),Object(A["a"])(ps,us,hs,!1,null,"ace419b0",null)),gs=fs.exports,vs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{ref:t.data.id,staticClass:"furniture",class:{clickable:t.myHome.toolsState.placingFurniture},style:t.computeCustomStyle(),attrs:{id:"fur_"+t.data.id},on:{click:t.handleClick,mouseenter:function(e){t.hovered=!0},mouseleave:function(e){t.hovered=!1}}},[t.myHome.toolsState.deletingLocations?e("div",{staticClass:"widgetTool deleter",on:{click:t.deleteMe}},[e("i",{staticClass:"far fa-trash-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.settingLocations&&t.hovered?e("div",{staticClass:"widgetTool zindexer"},[e("i",{staticClass:"fas fa-level-up-alt clickable",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fas fa-level-down-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e()])},ys=[],ks={name:"furniture",data:function(){return{rotationDelta:0,hovered:!1}},props:["data","myHome"],methods:{computeCustomStyle:function(){return this.myHome.moveableItem.computeMyHomeCustomStyle(this.data,`background: url('http://${this.$store.state.settings["aliceIp"]}:${this.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/furniture/${this.data.settings["t"]||"deco-1"}.png') no-repeat; background-size: 100% 100%;`)},save:function(){const t={id:this.data.id,parentLocation:this.data.parentLocation,settings:this.data.settings};O()({method:"PATCH",url:`/myHome/furniture/${this.data.id}/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then()},handleClick:function(t){if(t.stopPropagation(),this.myHome.removeDroppable(),this.myHome.activeFurnitureTile="",this.myHome.toolsState.placingFurniture){this.myHome.setMoveable(t.target,this),this.myHome.moveableItem.setBoundaries(this.$el,0);const e=Array.from(document.querySelectorAll(".furniture")).filter(t=>{const e=parseInt(t.id.substring(4));return!(e===this.data.id)});this.myHome.moveableItem.setGuidelines(e)}},deleteMe:function(t){t.stopPropagation(),O()({method:"DELETE",url:`/myHome/furniture/${this.data.id}/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{"success"in t.data&&t.data.success&&this.$delete(this.$store.state.furnitures,this.data.id)})}}},bs=ks,ws=(i("77fa"),Object(A["a"])(bs,vs,ys,!1,null,"509f05c2",null)),_s=ws.exports,$s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"configLine"},[t.template["subConfig"]?t._e():e("label",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.template.description,expression:"template.description"}],key:t.configName},[t._v(t._s(this.formatName(t.configName)))]),e("configInput",{attrs:{configName:t.configName,holder:t.holder,template:t.template,translate:t.translate}}),e("br")],1)},Ts=[],Cs={name:"configLine",props:["template","configName","holder","translate","confPrefix"],methods:{formatName:function(t){let e=t.replace(/((?<=[a-z])[A-Z]|[A-Z](?=[a-z]))/g," $1").trim().replace(this.confPrefix,"");return e.charAt(0).toUpperCase()+e.slice(1)}}},Ss=Cs,Is=(i("0064"),Object(A["a"])(Ss,$s,Ts,!1,null,"39c8e23b",null)),Ls=Is.exports,xs=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"centerLine"},["boolean"===t.template["dataType"]?e("VueToggles",{attrs:{"checked-text":t.translate("tooltips.yes"),dotColor:t.missing()?"red":"white",readonly:t.template["readonly"],"unchecked-text":t.translate("tooltips.no"),uncheckedColor:t.missing()?"red":"white",value:t.configValue,checkedBg:"var(--windowBG)",uncheckedBg:"var(--windowBG)"},on:{change:function(e){return t.checkSetters(t.configName)},click:function(e){t.configValue=!t.configValue}}}):"string"!==t.template["dataType"]||t.template["isSensitive"]?"string"===t.template["dataType"]&&t.template["isSensitive"]?e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],class:{missing:t.missing()},attrs:{maxlength:t.template["max"],minlength:t.template["min"],placeholder:t.template["defaultValue"],type:"password"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):"email"===t.template["dataType"]?e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{placeholder:t.template["defaultValue"],readonly:t.template["readonly"],type:"email"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):"integer"!==t.template["dataType"]||t.template["isSensitive"]?"integer"===t.template["dataType"]&&t.template["isSensitive"]?e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"}],attrs:{placeholder:t.template["defaultValue"],type:"password"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):"faIcon"===t.template["dataType"]?e("span",{staticClass:"centerLine"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"}],attrs:{placeholder:t.template["defaultValue"],type:"text"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}),t._v(" "),e("i",{staticClass:"fa-2x",class:t.icon,staticStyle:{"margin-left":".33em"},attrs:{"aria-hidden":"true"}})]):"list"===t.template["dataType"]?e("select",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"}],on:{change:[function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.configValue=e.target.multiple?i:i[0]},function(e){return t.checkSetters(t.configName)}]}},[t._l(t.template["values"],(function(i,s){return t.template["values"].constructor===Object?e("option",{domProps:{value:i}},[t._v(" "+t._s(s)+" ")]):t._e()})),t._l(t.template["values"],(function(i){return t.template["values"].constructor===Array?e("option",{domProps:{value:i}},[t._v(" "+t._s(i)+" ")]):t._e()}))],2):"range"===t.template["dataType"]?e("div",{staticClass:"rangeInput"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{max:t.template["max"],min:t.template["min"],placeholder:t.template["defaultValue"],step:t.template["step"],type:"range"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},__r:function(e){t.configValue=e.target.value}}}),"%"===t.template["unit"]?e("span",{staticClass:"inputRangeValue"},[t._v(t._s(100*t.configValue)+"%")]):"em"===t.template["unit"]?e("span",{staticClass:"inputRangeValue"},[t._v(t._s(t.configValue)+"em")]):e("span",{staticClass:"inputRangeValue"},[t._v(t._s(t.configValue))])]):"range2rgba"===t.template["dataType"]?e("div",{staticClass:"rangeInput"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{max:t.template["max"],min:t.template["min"],placeholder:t.template["defaultValue"],step:t.template["step"],type:"range"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:t.hex2rgba,__r:function(e){t.configValue=e.target.value}}}),"%"===t.template["unit"]?e("span",{staticClass:"inputRangeValue"},[t._v(t._s(100*t.configValue)+"%")]):e("span",{staticClass:"inputRangeValue"},[t._v(t._s(t.configValue)+t._s(t.template["unit"]))])]):"longstring"===t.template["dataType"]?e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],class:{missing:t.missing()},attrs:{placeholder:t.template["defaultValue"]},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):"color"===t.template["dataType"]?e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{type:"color"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):"color2rgba"===t.template["dataType"]?e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{type:"color"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:[function(e){e.target.composing||(t.configValue=e.target.value)},t.hex2rgba]}}):"userList"===t.template["dataType"]?e("configInputList",{directives:[{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{template:t.template},model:{value:t.configValue,callback:function(e){t.configValue=e},expression:"configValue"}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{placeholder:t.template["defaultValue"],type:"text"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],attrs:{placeholder:t.template["defaultValue"],readonly:t.template["readonly"],type:"number"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.configValue,expression:"configValue"},{name:"init",rawName:"v-init",value:t.configValue,expression:"configValue"}],class:{missing:t.missing(),invalid:!t.valid()},attrs:{maxlength:t.template["max"],minlength:t.template["min"],placeholder:t.template["defaultValue"],readonly:t.template["readonly"],type:"text"},domProps:{value:t.configValue},on:{change:function(e){return t.checkSetters(t.configName)},input:function(e){e.target.composing||(t.configValue=e.target.value)}}}),e("span")],1)},Ps=[],Ds={name:"configInput",props:["template","configName","holder","translate"],computed:{configValue:{get:function(){return this.template["subConfig"]?this.holder[this.configName][this.template["category"]]:this.holder[this.configName]},set:function(t){return this.template["subConfig"]?(this.$set(this.holder[this.configName],this.template["category"],t),!0):(this.$set(this.holder,this.configName,t),!0)}},icon(){if(""===this.holder[this.configName]||void 0===this.holder[this.configName])return"fas fa-biohazard";const t=/<i class="(.*)"><\/i>/,e=t.exec(this.holder[this.configName]);return e?(this.$set(this.holder,this.configName,e[1]),e[1]):this.holder[this.configName]}},methods:{checkSetters:function(t){var e,i;if(null!==(e=this.$store)&&void 0!==e&&null!==(i=e.state)&&void 0!==i&&i.settingTemplates[t]&&"sets"in this.$store.state.settingTemplates[t]){let e=this.$store.state.settingTemplates[t]["sets"];const i=this.$store.state.settings[t];let s;if(e.includes(" - ")){e=e.split(" - "),s=this.$store.state.settingTemplates[t]["values"]||this.$store.state.settingTemplates[t]["defaultValue"];for(const[t,e]of Object.entries(s))e.toLowerCase()===i.toLowerCase()&&(s=t.split(" - "))}else e=[e],s=[i];e.forEach((t,e)=>{this.$store.state.settings[t]=s[e]})}},hex2rgba(){let t=this.holder["background"],e=this.holder["background-opacity"];const[i,s,a]=t.match(/\w\w/g).map(t=>parseInt(t,16));this.holder["rgba"]=`rgba(${i}, ${s}, ${a}, ${e})`,console.log("new color "+this.holder["rgba"])},missing:function(){return this.template["obligatory"]&&!this.configValue},valid:function(){if("string"===this.template["dataType"]||"longstring"===this.template["dataType"]){if(void 0===this.configValue)return!1;let t=this.configValue.slice(-1);"capitalize"in this.template&&this.template["capitalize"]&&void 0!==this.configValue&&1===this.configValue.length&&(this.configValue=this.configValue.toUpperCase()),"noSpace"in this.template&&this.template["noSpace"]&&void 0!==this.configValue&&" "===t&&(this.configValue=this.configValue.slice(0,-1))}return!0}}},Es=Ds,js=(i("dc7d"),Object(A["a"])(Es,xs,Ps,!1,null,"7670dd24",null)),Ms=js.exports,Os=function(){var t=this,e=t._self._c;return e("div",["dict"===t.template["subType"]?e("div",[e("div",{staticClass:"inputIconContainer"},[e("i",{staticClass:"fas fa-plus-circle clickable",on:{click:t.addItem}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem,expression:"newItem"}],ref:"newListItem",attrs:{placeholder:t.template["placeholder"],name:"newListItem",type:"text"},domProps:{value:t.newItem},on:{keyup:[t.handleInput,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addItem.apply(null,arguments)}],input:function(e){e.target.composing||(t.newItem=e.target.value)}}})]),t._l(t.value,(function(i){return e("div",{key:"itm_"+i[t.template.dictKey],staticClass:"listItem",class:{selected:t.selectedItem===i[t.template.dictKey]},on:{click:function(e){return t.$emit("item-selected",i[t.template.dictKey])}}},[e("i",{staticClass:"fas fa-minus-circle fa-pull-left clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.removeItem(i)}}}),t._v(t._s(i[t.template.dictKey])+" ")])})),t._l(t.proposedItems,(function(i){return e("div",{key:"itmprop_"+i,staticClass:"listItem",class:{selected:t.selectedItem===i},on:{click:function(e){return t.$emit("item-selected",i)}}},[e("i",{staticClass:"fas fa-plus-circle fa-pull-left clickable red",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.addItemVal(i)}}}),t._v(t._s(i)+" ")])}))],2):"toggles"===t.template["subType"]?e("div",[e("config",{attrs:{holder:t.togglesHolder,subConfig:!0,templates:t.template["values"],translate:t.$t}})],1):"string"===t.template["subType"]?e("div",[e("div",{staticClass:"inputIconContainer"},[e("i",{staticClass:"fas fa-plus-circle clickable",on:{click:t.addItem}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem,expression:"newItem"}],ref:"newListItem",attrs:{placeholder:t.template["placeholder"],name:"newListItem",type:"text"},domProps:{value:t.newItem},on:{keyup:[t.handleInput,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addItem.apply(null,arguments)}],input:function(e){e.target.composing||(t.newItem=e.target.value)}}})]),e("div",{staticClass:"list"},t._l(t.value,(function(i){return e("div",{key:"itm_"+i,staticClass:"listItem",class:{selected:t.selectedItem===i},on:{click:function(e){return t.$emit("item-selected",i)}}},[e("i",{staticClass:"fas fa-minus-circle fa-pull-left clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.removeItem(i)}}}),t._v(t._s(i)+" ")])})),0)]):"keyForDict"===t.template["subType"]?e("div",[e("div",{staticClass:"inputIconContainer"},[e("i",{staticClass:"fas fa-plus-circle clickable",on:{click:t.addItem}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem,expression:"newItem"}],ref:"newListItem",attrs:{placeholder:t.template["placeholder"],name:"newListItem",type:"text"},domProps:{value:t.newItem},on:{keyup:[t.handleInput,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addItem.apply(null,arguments)}],input:function(e){e.target.composing||(t.newItem=e.target.value)}}})]),e("div",{staticClass:"list"},[t._l(t.proposedItems,(function(i){return e("div",{key:"itm_"+i,staticClass:"listItem",class:{selected:t.selectedItem===i},on:{click:function(e){return t.$emit("item-selected",i)}}},[e("i",{staticClass:"fas fa-plus-circle fa-pull-left clickable red",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.addItemVal(i)}}}),t._v(t._s(i)+" ")])})),t._l(t.value,(function(i,s){return e("div",{key:"itm_"+s,staticClass:"listItem",class:{selected:t.selectedItem===s},on:{click:function(e){return t.$emit("item-selected",s)}}},[e("i",{staticClass:"fas fa-minus-circle fa-pull-left clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.removeItem(s)}}}),t._v(t._s(s)+" ")])}))],2)]):e("div",[e("div",[t._l(t.template.highlights,(function(i,s){return""!==i.slot?e("button",{style:"background-color: "+i.color+";",on:{click:function(e){return e.preventDefault(),t.makeSlot(i)}}},[s<9?e("span",{staticClass:"slotNumber"},[t._v("alt+"+t._s(s+1)+":")]):t._e(),t._v(" "+t._s(i.slot)+" ")]):t._e()})),e("button",{on:{click:function(e){return e.preventDefault(),t.clearSlot()}}},[e("span",{staticClass:"slotNumber"},[t._v("alt+0:")]),t._v(" None ")]),e("div",{staticClass:"backdrop inputIconContainer"},[e("i",{staticClass:"fas fa-plus-circle clickable",on:{click:t.addItem}}),e("div",{staticClass:"highlights",domProps:{innerHTML:t._s(t.highlightText)}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newItem,expression:"newItem"}],ref:"newListItem",staticClass:"longInput",attrs:{placeholder:t.template.placeholder,name:"newListItem",type:"text"},domProps:{value:t.newItem},on:{input:[function(e){e.target.composing||(t.newItem=e.target.value)},t.handleInput],keyup:[t.handleInput,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addItem.apply(null,arguments)}],scroll:t.handleScroll}})])],2),e("div",{staticClass:"list"},t._l(Object.values(t.value),(function(i){return e("div",{key:"itm_"+i,staticClass:"listItem"},[e("i",{staticClass:"fas fa-minus-circle fa-pull-left clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.removeItem(i)}}}),e("div",{domProps:{innerHTML:t._s(t.formatUtterance(i))}})])})),0)])])},Hs=[],Ns={name:"configInputList",props:{template:{},value:{default:()=>[]},allowDouble:{},selectedItem:{},proposedItems:{}},data:function(){return{newItem:"",newItemSlots:{},togglesHolder:{}}},mounted(){if("toggles"===this.template["subType"]&&void 0!==this.value){this.$t||alert("list of toggles are not allowed when there is no $t"),this.togglesHolder={};for(const t of this.value)this.$set(this.togglesHolder,t,!0)}},watch:{togglesHolder:{deep:!0,handler(){this.$emit("input",Object.keys(this.togglesHolder).filter(t=>this.togglesHolder[t]))}}},computed:{highlightText(){let t=this.newItem.replace(/\n$/g,"\n\n");for(let[e,i]of Object.entries(this.newItemSlots)){let s=new RegExp("(^(?:.*<.*>)*?[^<]*?)(.?"+e+".?)");s.test(t)?t=t.replace(s,"$1<mark style='background-color:"+i["color"]+";'>$2</mark>"):this.$delete(this.newItemSlots,i["value"])}return t},valNN(){return this.value?this.value:[]}},methods:{makeSlot(t){this.moveSelectionToFullWord(),this.makeSlotFullMarked(t),this.moveCursorToSelectionEnd()},clearSlot(){this.moveSelectionToFullWord();let t=this.$refs.newListItem.value.slice(this.$refs.newListItem.selectionStart,this.$refs.newListItem.selectionEnd);this.$delete(this.newItemSlots,t),this.moveCursorToSelectionEnd()},moveCursorToSelectionEnd(){this.$refs.newListItem.selectionStart=this.$refs.newListItem.selectionEnd,this.$refs.newListItem.focus()},moveSelectionToFullWord(){if(this.$refs.newListItem.selectionStart===this.$refs.newListItem.selectionEnd){this.$refs.newListItem.selectionStart=1+this.$refs.newListItem.value.slice(0,this.$refs.newListItem.selectionStart).lastIndexOf(" ");let t=this.$refs.newListItem.value.slice(this.$refs.newListItem.selectionEnd).indexOf(" ");-1===t?t=this.$refs.newListItem.value.length:t+=this.$refs.newListItem.selectionEnd,this.$refs.newListItem.selectionEnd=t}},makeSlotFullMarked(t){let e=this.$refs.newListItem.value.slice(this.$refs.newListItem.selectionStart,this.$refs.newListItem.selectionEnd);if(""===e)return;let i={};i["value"]=e,i["slot"]=t["slot"],i["color"]=t["color"],this.$set(this.newItemSlots,e,i)},addItemVal:function(t){this.newItem=t,this.addItem()},addItem:function(t){if(this.newItem.length<=0)this.$refs.newListItem.focus();else if(this.handleInput(t)){if("dict"===this.template.subType){let t=this.template.dictTemplate;t[this.template.dictKey]=this.newItem,this.$emit("input",[t,...this.valNN])}else"keyForDict"===this.template.subType?this.$set(this.value,this.newItem,this.template.dictTemplate):this.$emit("input",[this.prepareForStore(this.newItem),...this.valNN]);this.newItem="",this.$refs.newListItem.focus(),this.$forceUpdate()}},prepareForStore(t){let e=t;for(let[i,s]of Object.entries(this.newItemSlots)){let t=new RegExp("(^(?:.*<.*>)*?[^<]*?)("+i+")");t.test(e)?e=e.replace(t,"$1{$2:=>"+s["slot"]+"}"):this.$delete(this.newItemSlots,s["value"])}return e},handleInput(t){if(t&&t["altKey"]&&"Digit"===t["code"].slice(0,5))if("0"===t["key"])this.clearSlot();else{let e=this.template["highlights"][t["key"]-1];this.makeSlot(e)}if("dict"===this.template.subType){if(!this.allowDouble&&this.value&&this.value.some(t=>t[this.template.dictKey]===this.newItem))return this.$refs.newListItem.setCustomValidity("This value already exists"),this.$refs.newListItem.reportValidity(),!1}else if(!this.allowDouble&&Array.isArray(this.value)&&this.value.includes(this.newItem))return this.$refs.newListItem.setCustomValidity("This value already exists"),this.$refs.newListItem.reportValidity(),!1;return this.$refs.newListItem.setCustomValidity(""),this.$refs.newListItem.reportValidity(),!0},removeItem(t){"keyForDict"===this.template.subType?this.$delete(this.value,t):this.$emit("input",this.value.filter(e=>e!==t))},formatUtterance(t){let e=t.replace(/\n$/g,"\n\n");for(let i of this.template["highlights"]){let t=new RegExp("{([^(:=>)]*?):=>"+i["slot"]+"}","g");e=e.replace(t,"<mark style='background-color:"+i["color"]+";'>$1</mark>")}return e},handleScroll(t){}}},As=Ns,Fs=(i("c66c"),Object(A["a"])(As,Os,Hs,!1,null,"5b907f5f",null)),Vs=Fs.exports,zs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"settingsContainer"},[e("div",{staticClass:"flexrow nowrap stretched yscroll"},[e("div",{staticClass:"leftBar"},[e("label",{staticClass:"categoryHead"},[t._v("Intents")]),t.dialogTemplates[t.currentLang]?e("configInputList",{directives:[{name:"init",rawName:"v-init",value:t.dialogTemplates[t.currentLang].intents,expression:"dialogTemplates[currentLang].intents"}],attrs:{"allow-double":!1,proposedItems:t.intentsMissingInLang,selectedItem:t.editingIntent,template:{name:"intents",dataType:"userList",subType:"dict",dictKey:"name",dictTemplate:{name:"",enabledByDefault:!1,utterances:[],slots:[]}}},on:{"item-selected":t.selectIntent},model:{value:t.dialogTemplates[t.currentLang].intents,callback:function(e){t.$set(t.dialogTemplates[t.currentLang],"intents",e)},expression:"dialogTemplates[currentLang].intents"}}):t._e(),e("label",{staticClass:"categoryHead"},[t._v("SlotTypes")]),t.dialogTemplates[t.currentLang]?e("configInputList",{directives:[{name:"init",rawName:"v-init",value:t.dialogTemplates[t.currentLang].slotTypes,expression:"dialogTemplates[currentLang].slotTypes"}],attrs:{"allow-double":!1,proposedItems:t.slotTypesMissingInLang,selectedItem:t.editingSlotType,template:{name:"slotTypes",dataType:"userList",subType:"dict",dictKey:"name",dictTemplate:{name:"",matchingStrictness:null,automaticallyExtensible:!1,useSynonyms:!0,technicalValue:!1,values:[]}}},on:{"item-selected":t.selectSlotType},model:{value:t.dialogTemplates[t.currentLang].slotTypes,callback:function(e){t.$set(t.dialogTemplates[t.currentLang],"slotTypes",e)},expression:"dialogTemplates[currentLang].slotTypes"}}):t._e()],1),e("div",{staticClass:"contained",staticStyle:{width:"100%",overflow:"inherit"}},[null===t.editingIntent&&null===t.editingSlotType?e("div",[e("h1",[t._v("Training Data")]),e("p",[t._v("Here you can define the dialog templates.")]),e("p",[t._v("Start by choosing your active language, then click on one of the intents on the left side, or add a new one!")]),e("p",[t._v("The second part are the slot types. These define the values alice will extract from the spoken words. You can edit them on the left side as well!")]),t._m(0),t.slotTypesMissingInLang.length>0||t.intentsMissingInLang.length>0?e("div",[e("div",{staticClass:"red"},[t._v(" There are elements missing in this language! ")]),t._v(" Add them by clicking the "),e("i",{staticClass:"fas fa-plus-circle red"}),t._v(" in the list to the left ")]):t._e()]):t._e(),!t.selectedExists&&t.editingIntent?e("div",[e("h1",[t._v(t._s(t.editingIntent))]),e("p",[t._v("This intent is missing for the current language, but exists for others!")]),e("p",[t._v("Add it by clicking on the plus in the list!")]),e("p",[t._v("To delete it from all languages - click here:")]),e("button",{staticClass:"danger",on:{click:function(e){return t.removeIntent(t.editingIntent)}}},[e("i",{staticClass:"fas fa-skull-crossbones size-2x"}),t._v(" Yes - Delete in all languages "),e("i",{staticClass:"fas fa-skull-crossbones size-2x"})])]):t.editingIntent?e("div",t._l(t.dialogTemplate.intents,(function(i){return i.name===t.editingIntent?e("div",[e("h1",{staticClass:"clickable",on:{click:function(e){return t.renameIntent(i)}}},[t._v(t._s(i.name)+" "),e("i",{staticClass:"fas fa-pen"})]),e("h3",[t._v("Settings")]),e("div",{staticClass:"configLine"},[e("label",[t._v("enabled By Default")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.enabledByDefault,expression:"intent.enabledByDefault"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(i.enabledByDefault)?t._i(i.enabledByDefault,null)>-1:i.enabledByDefault},on:{change:function(e){var s=i.enabledByDefault,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=null,l=t._i(s,o);a.checked?l<0&&t.$set(i,"enabledByDefault",s.concat([o])):l>-1&&t.$set(i,"enabledByDefault",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(i,"enabledByDefault",n)}}})]),e("h3",[t._v("Slots")]),t._m(1,!0),t._l(i.slots,(function(s){return e("div",{staticClass:"lineContainer"},[e("button",{on:{click:function(e){return t.removeSlotFromIntent(i,s)}}},[e("i",{staticClass:"fas fa-minus-circle size-15x"})]),e("div",{staticClass:"likeInput clickable",on:{click:function(e){return t.renameSlot(i,s)}}},[t._v(" "+t._s(s.name)+" "),e("i",{staticClass:"fas fa-pen"})]),e("input",{directives:[{name:"model",rawName:"v-model",value:s.type,expression:"slot.type"}],domProps:{value:s.type},on:{input:function(e){e.target.composing||t.$set(s,"type",e.target.value)}}})])})),e("div",{staticClass:"lineContainer"},[e("button",{on:{click:function(e){return t.addSlot(i.slots)}}},[e("i",{staticClass:"fas fa-plus-circle size-15x"})]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newSlotName,expression:"newSlotName"}],ref:"newSlotInput",refInFor:!0,domProps:{value:t.newSlotName},on:{input:[function(e){e.target.composing||(t.newSlotName=e.target.value)},t.resetValidity],keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addSlot(i.slots)}}}),e("div"),e("div"),e("div")]),e("h4",[t._v("Utterances")]),e("configInputList",{directives:[{name:"init",rawName:"v-init",value:i.utterances,expression:"intent.utterances"}],attrs:{selectedItem:t.editingIntent,template:{name:"intents",dataType:"userList",subType:"utterance",highlights:t.getHighlights(i)}},on:{"item-selected":t.selectIntent},model:{value:i.utterances,callback:function(e){t.$set(i,"utterances",e)},expression:"intent.utterances"}}),e("br")],2):t._e()})),0):e("div",{staticClass:"slotDefinition"},[!t.selectedExists&&t.editingSlotType?e("div",[e("h1",[t._v(t._s(t.editingSlotType))]),e("p",[t._v("This intent is missing for the current language, but exists for others!")]),e("p",[t._v("Add it by clicking on the plus in the list!")]),e("p",[t._v("To delete it from all languages - click here:")]),e("button",{staticClass:"danger",on:{click:function(e){return t.removeSlotType(t.editingSlotType)}}},[e("i",{staticClass:"fas fa-skull-crossbones size-2x"}),t._v(" Yes - Delete in all languages "),e("i",{staticClass:"fas fa-skull-crossbones size-2x"})])]):t._e(),t._l(t.dialogTemplate.slotTypes,(function(i){return i.name===t.editingSlotType?e("div",{directives:[{name:"else",rawName:"v-else"}]},[e("h3",[t._v(t._s(i.name))]),e("div",{staticClass:"configLine"},[e("label",[t._v("Matching Strictness")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.matchingStrictness,expression:"slot.matchingStrictness"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(i.matchingStrictness)?t._i(i.matchingStrictness,null)>-1:i.matchingStrictness},on:{change:function(e){var s=i.matchingStrictness,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=null,l=t._i(s,o);a.checked?l<0&&t.$set(i,"matchingStrictness",s.concat([o])):l>-1&&t.$set(i,"matchingStrictness",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(i,"matchingStrictness",n)}}})]),e("div",{staticClass:"configLine"},[e("label",[t._v("Automatically Extensible")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.automaticallyExtensible,expression:"slot.automaticallyExtensible"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(i.automaticallyExtensible)?t._i(i.automaticallyExtensible,null)>-1:i.automaticallyExtensible},on:{change:function(e){var s=i.automaticallyExtensible,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=null,l=t._i(s,o);a.checked?l<0&&t.$set(i,"automaticallyExtensible",s.concat([o])):l>-1&&t.$set(i,"automaticallyExtensible",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(i,"automaticallyExtensible",n)}}}),e("br")]),e("div",{staticClass:"configLine"},[e("label",[t._v("Use Synonyms")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.useSynonyms,expression:"slot.useSynonyms"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(i.useSynonyms)?t._i(i.useSynonyms,null)>-1:i.useSynonyms},on:{change:function(e){var s=i.useSynonyms,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=null,l=t._i(s,o);a.checked?l<0&&t.$set(i,"useSynonyms",s.concat([o])):l>-1&&t.$set(i,"useSynonyms",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(i,"useSynonyms",n)}}}),e("br")]),e("div",{staticClass:"configLine"},[e("label",[t._v("Technical Value")]),e("input",{directives:[{name:"model",rawName:"v-model",value:i.technicalValue,expression:"slot.technicalValue"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(i.technicalValue)?t._i(i.technicalValue,null)>-1:i.technicalValue},on:{change:function(e){var s=i.technicalValue,a=e.target,n=!!a.checked;if(Array.isArray(s)){var o=null,l=t._i(s,o);a.checked?l<0&&t.$set(i,"technicalValue",s.concat([o])):l>-1&&t.$set(i,"technicalValue",s.slice(0,l).concat(s.slice(l+1)))}else t.$set(i,"technicalValue",n)}}}),e("br")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.newValue,expression:"newValue"}],ref:"new-val-input",refInFor:!0,attrs:{placeholder:"new Value"},domProps:{value:t.newValue},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addValue.apply(null,arguments)},input:function(e){e.target.composing||(t.newValue=e.target.value)}}}),i.useSynonyms?e("input",{directives:[{name:"model",rawName:"v-model",value:t.newSynonymCSV,expression:"newSynonymCSV"}],attrs:{placeholder:"a Synonym, 2 Synonym, 3..."},domProps:{value:t.newSynonymCSV},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addValue.apply(null,arguments)},input:function(e){e.target.composing||(t.newSynonymCSV=e.target.value)}}}):t._e(),e("br"),t._m(2,!0),e("br"),e("br")]),t._l(i.values,(function(s){return e("div",{staticClass:"slotLine"},[e("div",{staticClass:"inputWrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.value,expression:"val.value"}],attrs:{readonly:i.technicalValue},domProps:{value:s.value},on:{input:function(e){e.target.composing||t.$set(s,"value",e.target.value)}}}),e("span")]),i.useSynonyms?e("span",[e("configInputList",{directives:[{name:"init",rawName:"v-init",value:s.synonyms,expression:"val.synonyms"}],attrs:{template:{name:"synonyms",dataType:"userList",subType:"string"}},model:{value:s.synonyms,callback:function(e){t.$set(s,"synonyms",e)},expression:"val.synonyms"}})],1):t._e()])}))],2):t._e()}))],2)])])])},qs=[function(){var t=this,e=t._self._c;return e("p",[t._v("You can always find more detailed help by clicking the "),e("i",{staticClass:"fas fa-question-circle"}),t._v(" in the top right, this will lead you to the corresponding page of "),e("a",{attrs:{href:"https://docs.projectalice.io/skill-development/files-in-depth.html#dialog-templates"}},[t._v("docs.ProjectAlice.io")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"lineContainer"},[e("label"),e("label",[t._v("Name")]),e("label",[t._v("SlotType")])])},function(){var t=this,e=t._self._c;return e("em",[t._v(" Press enter to add the value above to the list."),e("br"),t._v(" Synonyms may be entered separated by commas."),e("br"),t._v(" Below entering one synonym after the other by pressing enter is possible.")])}],Us=(i("3c65"),{name:"dialogTemplateEditor",props:["editingSkill","currentLang"],data:function(){return{dialogTemplates:{},backupTemplates:{},editingIntent:null,editingSlotType:null,newValue:"",newSynonymCSV:"",newSlotName:"",noWatch:!1}},mounted(){this.loadDialogTemplate()},computed:{newSynonyms:function(){return""===this.newSynonymCSV.trim()?[]:this.newSynonymCSV.split(",")},dialogTemplate(){return this.checkLang(),this.dialogTemplates[this.currentLang]},isModified(){return JSON.stringify(this.dialogTemplates)!==JSON.stringify(this.backupTemplates)},allIntents(){let t=[];for(const e in this.dialogTemplates)"intents"in this.dialogTemplates[e]&&(t=[...new Set([...t,...this.dialogTemplates[e].intents.map(t=>t.name)])]);return t},allSlotTypes(){let t=[];for(const e in this.dialogTemplates)"slotTypes"in this.dialogTemplates[e]&&(t=[...new Set([...t,...this.dialogTemplates[e].slotTypes.map(t=>t.name)])]);return t},selectedExists(){return!this.intentsMissingInLang.includes(this.editingIntent)&&!this.slotTypesMissingInLang.includes(this.editingSlotType)},intentsMissingInLang(){return this.dialogTemplates&&this.currentLang in this.dialogTemplates&&this.dialogTemplates[this.currentLang].intents?this.allIntents.filter(t=>!this.dialogTemplates[this.currentLang].intents.map(t=>t.name).includes(t)):this.allIntents},slotTypesMissingInLang(){return this.dialogTemplates&&this.currentLang in this.dialogTemplates&&this.dialogTemplates[this.currentLang].slotTypes?this.allSlotTypes.filter(t=>!this.dialogTemplates[this.currentLang].slotTypes.map(t=>t.name).includes(t)):this.allSlotTypes}},watch:{currentLang(){this.checkLang()}},methods:{reload(){this.loadDialogTemplate()},checkLang(){this.dialogTemplates[this.currentLang]||this.$set(this.dialogTemplates,this.currentLang,{})},renameIntent(t){self=this,this.$dialog.prompt({title:"What should the intent be named? The intent will be renamed for all languages.",body:t.name},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(e){""!==e.data?self.allIntents.filter(t=>t.name===e.data).length?self.showError("That name is already taken!"):(t.name=e.data,self.editingIntent=t.name):self.showError("The name must not be empty!")}))},renameSlot(t,e){let i=this;this.$dialog.prompt({title:"What should the slot be named?",body:e.name},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(s){if(""===s.data)return void i.showError("The name must not be empty!");if(t.slots.filter(t=>t.name===s.data).length)return void i.showError("That name is already taken!");let a=e.name;e.name=s.data;let n=new RegExp("{([^(:=>)]*?):=>"+a+"}","g");for(let i in Object.values(t.utterances))t.utterances[i]=t.utterances[i].replace(n,"{$1:=>"+e.name+"}")}))},resetValidity(t){t.target.setCustomValidity(""),t.target.reportValidity()},addValue(){for(const t in this.dialogTemplates[this.currentLang].slotTypes)if(this.dialogTemplates[this.currentLang].slotTypes[t].name===this.editingSlotType){let e={value:""+this.newValue,synonyms:this.newSynonyms};return this.dialogTemplates[this.currentLang].slotTypes[t].values.unshift(e),this.newValue="",this.newSynonymCSV="",void this.$refs["new-val-input"][0].focus()}},addSlot(t){return""===this.newSlotName?(this.$refs.newSlotInput[0].setCustomValidity("Please provide a slot name!"),void this.$refs.newSlotInput[0].reportValidity()):t.filter(t=>t.name===this.newSlotName).length?(this.$refs.newSlotInput[0].setCustomValidity("That slot name already exists!"),void this.$refs.newSlotInput[0].reportValidity()):(this.$refs.newSlotInput[0].setCustomValidity(""),this.$refs.newSlotInput[0].reportValidity(),t.push({name:this.newSlotName,type:""}),void(this.newSlotName=""))},removeSlotFromIntent(t,e){this.$dialog.confirm({title:"Mind the consequences!",body:"Deleting a slot will remove all occurrences in the utterances",okText:"Delete",cancelText:this.$t("buttons.cancel")}).then(()=>{let i=new RegExp("{([^(:=>)]*?):=>"+e.name+"}","g");for(let e in Object.values(t.utterances))t.utterances[e]=t.utterances[e].replace(i,"$1");t.slots=t.slots.filter(t=>t!==e)})},getSlotColor(t){return["#1b4958","#005000","#cc8400","yellow","red"][t]},getHighlights(t){let e=[],i=0;if(t.slots)for(const s of t.slots){let t={};t.slot=s.name,t.color=this.getSlotColor(i++),e.push(t)}return e},selectIntent(t){this.editingIntent=t,this.editingSlotType=null},selectSlotType(t){this.editingSlotType=t,this.editingIntent=null},save(){let t=this;for(const e of Object.keys(this.dialogTemplates)){(!1 in this.dialogTemplates[e]||void 0==this.dialogTemplates[e]["skill"])&&(this.dialogTemplates[e]["skill"]=this.editingSkill.name);let i={lang:e,dialogTemplate:this.dialogTemplates[e]};O()({method:"PATCH",url:`/skills/${this.editingSkill.name}/setDialogTemplate/`,data:i,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(e){"success"in e.data&&e.data["success"]&&(t.dialogTemplates[this.currentLang]=JSON.parse(e.data["dialogTemplate"]),t.backupTemplates[this.currentLang]=JSON.parse(e.data["dialogTemplate"]))})).catch((function(t){console.log(t)}))}},removeIntent(t){this.askDeletionForAllLanguages("intents",t)},removeSlotType(t){this.askDeletionForAllLanguages("slotTypes",t)},askDeletionForAllLanguages(t,e){let i=this;this.$dialog.confirm({title:"Delete for all languages?",body:"This will delete the "+t+" for all languages!",okText:"Delete",cancelText:this.$t("buttons.cancel")}).then(()=>{i.removeForAllLanguages(t,e)})},removeForAllLanguages(t,e){for(const i in this.dialogTemplates)if(this.dialogTemplates[i][t]){let s=Object.entries(this.dialogTemplates[i][t]).map(([t,i])=>{if(i.name===e)return t});s&&this.$delete(this.dialogTemplates[i][t],s)}},loadDialogTemplate(){const t={};let e=this;this.$emit("waiting",!0),O()({method:"POST",url:`/skills/${this.editingSkill.name}/getDialogTemplate/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(t){"success"in t.data&&(t.data["success"]?(e.dialogTemplates=t.data["dialogTemplates"],e.backupTemplates=JSON.parse(JSON.stringify(t.data["dialogTemplates"])),e.checkLang(),e.$emit("waiting",!1)):e.$emit("failed"))})).catch((function(t){console.log(t),e.$emit("failed")}))}}}),Ws=Us,Rs=(i("201c"),Object(A["a"])(Ws,zs,qs,!1,null,"d1e7834e",null)),Bs=Rs.exports,Gs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"settingsContainer"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.stringified,expression:"stringified"}],staticClass:"stretched",domProps:{value:t.stringified},on:{input:function(e){e.target.composing||(t.stringified=e.target.value)}}})])},Ys=[],Js={name:"simpleJsonEditor",props:["value","configTemplate"],data:function(){return{stringified:""}},mounted(){this.json2string()},computed:{isModified(){return JSON.stringify(this.value,null,2)!==this.stringified}},methods:{json2string(){this.stringified=JSON.stringify(this.value,null,2)},string2json(){this.$emit("input",JSON.parse(this.stringified))},prepareSave(){return!!this.isModified&&(this.string2json(),!0)}}},Ks=Js,Xs=(i("5afd"),Object(A["a"])(Ks,Gs,Ys,!1,null,"c1eb7b28",null)),Zs=Xs.exports,Qs=function(){var t=this,e=t._self._c;return e("div",{staticClass:"flexrow nowrap stretched yscroll"},[e("div",{staticClass:"leftBar"},[e("label",{staticClass:"categoryHead"},[t._v("Talks")]),e("configInputList",{directives:[{name:"init",rawName:"v-init",value:t.talkFiles[t.currentLang],expression:"talkFiles[currentLang]"}],attrs:{"allow-double":!1,proposedItems:t.missingInLang,selectedItem:t.editingTalk,template:{name:"intents",dataType:"userList",subType:"keyForDict",dictTemplate:{default:[],short:[]}}},on:{"item-selected":t.selectTalk},model:{value:t.talkFiles[t.currentLang],callback:function(e){t.$set(t.talkFiles,t.currentLang,e)},expression:"talkFiles[currentLang]"}})],1),e("div",{staticClass:"contained",staticStyle:{width:"100%",overflow:"inherit"}},[t.editingTalk?t.editingTalk&&t.selectedExists?e("div",t._l(t.talkFiles[t.currentLang],(function(i,s){return s===t.editingTalk?e("div",[e("h1",{staticClass:"clickable",on:{click:function(e){return t.rename(s)}}},[t._v(t._s(s)+" "),e("i",{staticClass:"fas fa-pen"})]),void 0===t.talkFiles[t.currentLang][s]["default"]?e("div",[e("div",{staticClass:"inputBlock"},[e("label",[t._v("Default:")]),e("configInputList",{attrs:{template:{name:"default",dataType:"userList",subType:"string"}},model:{value:t.talkFiles[t.currentLang][s],callback:function(e){t.$set(t.talkFiles[t.currentLang],s,e)},expression:"talkFiles[currentLang][key]"}})],1)]):e("div",[e("div",{staticClass:"inputBlock"},[e("label",[t._v("Default:")]),e("configInputList",{attrs:{template:{name:"default",dataType:"userList",subType:"string"}},model:{value:t.talkFiles[t.currentLang][s]["default"],callback:function(e){t.$set(t.talkFiles[t.currentLang][s],"default",e)},expression:"talkFiles[currentLang][key]['default']"}})],1),e("div",{staticClass:"inputBlock"},[e("label",[t._v("Short:")]),e("configInputList",{attrs:{template:{name:"default",dataType:"userList",subType:"string"}},model:{value:t.talkFiles[t.currentLang][s]["short"],callback:function(e){t.$set(t.talkFiles[t.currentLang][s],"short",e)},expression:"talkFiles[currentLang][key]['short']"}})],1)])]):t._e()})),0):e("div",[e("h1",[t._v(t._s(t.editingTalk))]),e("p",[t._v("This talk is missing for the current language, but exists for others!")]),e("p",[t._v("Add it by clicking on the plus in the list!")]),e("p",[t._v("To delete it from all languages - click here:")]),e("button",{staticClass:"danger",on:{click:function(e){return t.removeTalk(t.editingTalk)}}},[e("i",{staticClass:"fas fa-skull-crossbones size-2x"}),t._v(" Yes - Delete in all languages "),e("i",{staticClass:"fas fa-skull-crossbones size-2x"})])]):e("div",[e("h1",[t._v("Talk Files")]),t._v(" Here is the place to define all the stuff Alice should be able to say with your skill."),e("br"),t._v(" Furthermore this is the place to go to when you want to translate the output to a different language."),e("br"),t._v(" For detailed information, have a look at "),e("a",{attrs:{href:"https://docs.projectalice.io/skill-development/files-in-depth.html#talk-files"}},[t._v("docs.ProjectAlice.io")]),t._v(" or click on the "),e("i",{staticClass:"fas fa-question-circle"}),t._v(" on the top right. "),e("p",[t._v("You may switch between the languages, without saving - but don't move to another tab!")]),e("br"),t.missingInLang.length>0?e("div",[e("div",{staticClass:"red"},[t._v(" There are talks missing in this language! ")]),t._v(" Add them by clicking the "),e("i",{staticClass:"fas fa-plus-circle red"}),t._v(" in the list to the left ")]):t._e(),e("br"),t.showRaw?e("div",[e("a",{on:{click:function(e){t.showRaw=!1}}},[e("i",{staticClass:"fas fa-caret-down"}),t._v(" Raw talk file:")]),e("br"),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.stringified,expression:"stringified"}],class:{inputErrorImp:!this.stringValid},domProps:{value:t.stringified},on:{input:function(e){e.target.composing||(t.stringified=e.target.value)}}})]):e("a",{on:{click:function(e){t.showRaw=!0}}},[e("i",{staticClass:"fas fa-caret-right"}),t._v(" Click here to show and edit the raw talk file ")])])])])},ta=[],ea={name:"talkFileEditor",props:["editingSkill","currentLang"],data(){return{talkFiles:{},talkFilesBackup:{},stringified:"",stringValid:!0,noWatch:!1,showRaw:!1,editingTalk:""}},watch:{stringified:function(){if(!this.noWatch)try{this.noWatch=!0,this.talkFiles[this.currentLang]=JSON.parse(this.stringified),this.stringValid=!0,this.$nextTick(()=>{self.noWatch=!1})}catch(t){this.stringValid=!1,this.$nextTick(()=>{self.noWatch=!1})}},talkFiles:{deep:!0,handler(t){this.noWatch||(this.noWatch=!0,this.stringified=JSON.stringify(this.talkFiles[this.currentLang],null,2),self=this,this.$nextTick(()=>{self.noWatch=!1}))}},currentLang:function(){var t;null!==(t=this.talkFiles)&&void 0!==t&&t.hasOwnProperty(this.currentLang)||this.$set(this.talkFiles,this.currentLang,{}),this.stringified=JSON.stringify(this.talkFiles[this.currentLang],null,2)}},mounted(){this.loadFiles()},computed:{allSlots(){let t=[];for(const e in this.talkFiles)t=[...new Set([...t,...Object.keys(this.talkFiles[e])])];return t},missingInLang(){return!this.currentLang in this.talkFiles?this.allSlots:this.allSlots.filter(t=>{var e;return!(null!==(e=this.talkFiles[this.currentLang])&&void 0!==e&&e.hasOwnProperty(t))})},selectedExists(){return!this.missingInLang.includes(this.editingTalk)},isModified(){return JSON.stringify(this.talkFiles)!==JSON.stringify(this.talkFilesBackup)}},methods:{selectTalk(t){this.editingTalk=t},addTalk(t){this.$set(this.talkFiles[this.currentLang],t,{default:[],short:[]})},rename(t){self=this,this.$dialog.prompt({title:"What should be the new name for this talk? Changes will be applied to all languages!",body:t},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(e){if(""===e.data)return void self.showError("The name must not be empty!");if(self.allSlots.includes(e.data))return void self.showError("That name is already taken!");let i=(t,e,{[t]:i,...s})=>({[e]:i,...s});for(const s in self.talkFiles)self.talkFiles[s]=i(t,e.data,self.talkFiles[s])}))},removeTalk(t){let e=this;this.$dialog.confirm({title:"Delete for all languages?",body:"This will delete the talk for all languages!",okText:"Delete",cancelText:this.$t("buttons.cancel")}).then(()=>{for(const i in e.talkFiles)e.$delete(e.talkFiles[i],[t])})},loadFiles(){const t={};let e=this;e.$emit("waiting",!0),O()({method:"POST",url:`/skills/${this.editingSkill.name}/getTalkFiles/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(t){"success"in t.data&&(t.data["success"]?(e.talkFiles=t.data["talkFiles"],!e.currentLang in e.talkFiles&&(e.talkFiles[e.currentLang]=[]),e.talkFilesBackup=JSON.parse(JSON.stringify(e.talkFiles)),e.$emit("waiting",!1)):e.$emit("failed"))})).catch((function(t){console.log(t),e.$emit("failed")}))},save(){for(const t in this.talkFiles)JSON.stringify(this.talkFiles[t])!==JSON.stringify(this.talkFilesBackup[t])&&this.saveLang(t)},saveLang(t){let e=this;e.$emit("waiting");let i={lang:t,talkFile:this.talkFiles[t]};O()({method:"PATCH",url:`/skills/${this.editingSkill.name}/setTalkFile/`,data:i,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then((function(i){"success"in i.data&&(i.data["success"]?(e.$emit("success"),e.talkFiles[t]=JSON.parse(i.data["talkFile"]),e.talkFilesBackup[t]=JSON.parse(i.data["talkFile"])):e.$emit("failed",i.data["message"]||"Unknown Error"))})).catch((function(t){console.log(t),e.$emit("failed","Unknown Error")}))}}},ia=ea,sa=(i("6d69"),Object(A["a"])(ia,Qs,ta,!1,null,"11290aba",null)),aa=sa.exports,na=function(){var t=this,e=t._self._c;return e(t.subConfig?"div":"form",{ref:"data",tag:"component",staticClass:"settingsContainer",on:{keypress:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.preventDefault()}}},[t.subConfig?t._e():e("div",{class:{waiting:t.waiting||t.success||t.failed,waitHidden:!t.waiting&&!t.success&&!t.failed}},[e("div",{staticClass:"centered"},[t.waiting?e("i",{ref:"animatedIcon",staticClass:"fas fa-spinner fa-pulse fa-4x",attrs:{"aria-hidden":"true"}}):t.success?e("i",{ref:"animatedIcon",staticClass:"fas fa-check fa-4x green",attrs:{"aria-hidden":"true"}}):t.failed?e("i",{ref:"animatedIcon",staticClass:"fas fa-exclamation-triangle fa-4x red",attrs:{"aria-hidden":"true"}}):t._e()])]),t.waiting?t._e():e("div",{staticClass:"settingsArea",class:{noOverflow:t.subConfig}},[t.includeFilter?e("div",{staticClass:"settingsCategory"},[e("div",{staticClass:"title"},[t._v(t._s(t.$t("labels.searchSetting")))]),e("div",{staticClass:"configLayout"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKeyword,expression:"searchKeyword"}],attrs:{placeholder:t.$t("labels.keyword"),type:"text"},domProps:{value:t.searchKeyword},on:{input:function(e){e.target.composing||(t.searchKeyword=e.target.value)}}})])]):t._e(),t.byCategory?e("div",t._l(t.categories,(function(i){return e("div",{staticClass:"settingsCategory",attrs:{id:i.toLowerCase().replace(" ","_")}},[e("div",{staticClass:"title"},[t._v(t._s(i.replace(/([A-Z])/g," $1").trim().toUpperCase()))]),e("div",{staticClass:"configLayout"},t._l(t.templatesForCategory(i),(function(i,s){return e("configLine",{attrs:{confPrefix:t.confPrefix,configName:s,holder:t.holder,template:i,translate:e=>t.$t(e)}})})),1)])})),0):e("div",t._l(t.filteredTemplates(),(function(i,s){return e("configLine",{attrs:{configName:s,holder:t.holder,template:i,translate:t.translate}})})),1)]),e("div",{staticClass:"configActions"},t._l(t.actions,(function(i,s){return e("div",[!("condition"in i)||i["condition"]?e("div",[t.textButtons?e("div",["save"===s?e("div",{staticClass:"button"},[e("button",{attrs:{timing:[1,2],"data-success":"false",tooltip:"tooltips.save"},on:{click:i["action"]}},[t._v("Save")])]):"cancel"===s?e("div",{staticClass:"button"},[e("button",{attrs:{timing:[1,2],"data-success":"false",tooltip:"tooltips.cancel"},on:{click:i["action"]}},[t._v("Cancel")])]):"reset"===s?e("div",{staticClass:"button"},[e("button",{attrs:{timing:[1,2],"data-success":"false",tooltip:"tooltips.reset"},on:{click:i["action"]}},[t._v("Reset")])]):e("div",[e("button",{on:{click:i["action"]}},[t._v(t._s(i["text"]))])])]):e("div",["save"===s?e("div",{staticClass:"icon dg-pull-right"},[e("reactive-icon",{attrs:{onClick:i["action"],timing:[1,2],"data-success":"false",icon:"far fa-save",tooltip:"tooltips.save"}})],1):"cancel"===s?e("div",{staticClass:"icon"},[e("reactive-icon",{attrs:{onClick:i["action"],timing:[1,2],"data-success":"false",icon:"fas fa-reply",tooltip:"tooltips.cancel"}})],1):"reset"===s?e("div",{staticClass:"icon"},[e("reactive-icon",{attrs:{onClick:i["action"],timing:[1,2],"data-success":"false",icon:"fas fa-undo",tooltip:"tooltips.reset"}})],1):e("div",[e("button",{on:{click:i["action"]}},[t._v(t._s(i["text"]))])])])]):t._e()])})),0)])},oa=[],la={name:"config",props:["templates","holder","translate","validator","byCategory","includeFilter","actions","waiting","success","failed","textButtons","confPrefix","subConfig"],data:function(){return{searchKeyword:""}},computed:{filteredTemplates(){return()=>{let t={};for(const[e,i]of Object.entries(this.templates))"hidden"!==i["display"]&&this.checkConfigVisibility(e)&&(t[e]=i);return t}},templatesForCategory(){return t=>{let e={};for(const[i,s]of Object.entries(this.templates))"hidden"!==s["display"]&&s["category"].toLowerCase()===t.toLowerCase()&&this.checkConfigVisibility(i)&&(e[i]=s);return e}},allCategories(){let t=[];for(const e of Object.values(this.templates))t.includes(e["category"])||t.push(e["category"]);return t},categories(){if(""===this.searchKeyword)return this.allCategories;{let t=this;return Object.values(this.allCategories).filter(e=>t.checkCategoryVisibility(e))}}},methods:{checkCategoryVisibility:function(t){return Object.keys(this.templatesForCategory(t)).length>0},checkConfigVisibility:function(t){let e=!0;if(this.templates[t].constructor===Object&&"parent"in this.templates[t]){const i=this.templates[t]["parent"],s=i["config"],a=i["condition"],n=i["value"];let o=this.holder[s];if(Array.isArray(s)){const t=i["checkType"]||"and";for(const i of s){if(o=this.holder[i],e="is"===a&&o===n||"isnot"===a&&o!==n||"isgreater"===a&&o>n||"islower"===a&&o<n,"or"===t&&e)break;if("and"===t&&!e)break}}else e="is"===a&&o===n||"isnot"===a&&o!==n||"isgreater"===a&&o>n||"islower"===a&&o<n;e&&""!==this.searchKeyword&&(e=t.toLowerCase().includes(this.searchKeyword.toLowerCase()))}else""!==this.searchKeyword&&(e=t.toLowerCase().includes(this.searchKeyword.toLowerCase()));return e}}},ra=la,ca=(i("0eaf"),Object(A["a"])(ra,na,oa,!1,null,"8fe47adc",null)),da=ca.exports,ua=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{ref:t.data.id,staticClass:"construction",class:{clickable:t.myHome.toolsState.placingConstructions},style:t.computeCustomStyle(),attrs:{id:"con_"+t.data.id},on:{click:t.handleClick,mouseenter:function(e){t.hovered=!0},mouseleave:function(e){t.hovered=!1}}},[t.myHome.toolsState.deletingLocations?e("div",{staticClass:"widgetTool deleter",on:{click:t.deleteMe}},[e("i",{staticClass:"far fa-trash-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.settingLocations&&t.hovered?e("div",{staticClass:"widgetTool zindexer"},[e("i",{staticClass:"fas fa-level-up-alt clickable",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fas fa-level-down-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e()])},ha=[],ma={name:"construction",data:function(){return{rotationDelta:0}},props:["data","myHome"],methods:{computeCustomStyle:function(){return this.myHome.moveableItem.computeMyHomeCustomStyle(this.data,`background: url('http://${this.$store.state.settings["aliceIp"]}:${this.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/constructions/${this.data.settings["t"]||"construction-200"}.png') no-repeat; background-size: 100% 100%;`)},save:function(){const t={id:this.data.id,parentLocation:this.data.parentLocation,settings:this.data.settings};O()({method:"PATCH",url:`/myHome/constructions/${this.data.id}/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then()},handleClick:function(t){if(t.stopPropagation(),this.myHome.removeDroppable(),this.myHome.activeConstructionTile="",this.myHome.toolsState.placingConstructions){this.myHome.setMoveable(t.target,this),this.myHome.moveableItem.setBoundaries(this.$el,0);const e=Array.from(document.querySelectorAll(".construction")).filter(t=>{const e=parseInt(t.id.substring(4));return!(e===this.data.id)});this.myHome.moveableItem.setGuidelines(e)}},deleteMe:function(t){t.stopPropagation(),O()({method:"DELETE",url:`/myHome/constructions/${this.data.id}/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{"success"in t.data&&t.data.success&&this.$delete(this.$store.state.constructions,this.data.id)})}}},pa=ma,fa=(i("6b50"),Object(A["a"])(pa,ua,ha,!1,null,"c546fda4",null)),ga=fa.exports,va=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.data.deviceConfigs.displayName,expression:"data.deviceConfigs.displayName"}],ref:"dev_"+t.data.id,staticClass:"device clickable",style:t.computeCustomStyle(),attrs:{id:"dev_"+t.data.id},on:{click:t.handleClick,mouseenter:t.onMouseEnter,mouseleave:t.onMouseExit}},[e("div",{staticClass:"deviceState"},[""===t.data.uid||-1===t.data.uid||"-1"===t.data.uid?e("span",[e("i",{staticClass:"fas fa-unlink red",attrs:{"aria-hidden":"true"}})]):t.data.connected?e("span",[t.data.deviceParams.micMuted?e("i",{staticClass:"fas fa-microphone-alt-slash red",attrs:{"aria-hidden":"true"}}):t._e(),t.data.deviceParams.soundMuted?e("i",{staticClass:"fas fa-volume-mute red",attrs:{"aria-hidden":"true"}}):t._e(),t.data.deviceParams.batteryWarning?e("i",{staticClass:"fas fa-battery-quarter red",attrs:{"aria-hidden":"true"}}):t._e(),t.data.deviceParams.alert?e("i",{staticClass:"fas fa-exclamation-triangle red",attrs:{"aria-hidden":"true"}}):t._e(),t.data.deviceParams.notification?e("i",{staticClass:"fas fa-bell",attrs:{"aria-hidden":"true"}}):t._e()]):e("span",[e("i",{staticClass:"fas fa-heart-broken red",attrs:{"aria-hidden":"true"}})])]),1!==t.data.id&&t.myHome.toolsState.deletingDevices?e("div",{staticClass:"deviceTool deleter",on:{click:t.deleteMe}},[e("i",{staticClass:"far fa-trash-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.settingDevices&&t.hovered?e("div",{staticClass:"deviceTool optioner",on:{click:t.openSettings}},[e("i",{staticClass:"fas fa-cogs clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.myHome.toolsState.settingDevices&&t.hovered?e("div",{staticClass:"deviceTool zindexer"},[e("i",{staticClass:"fas fa-level-up-alt clickable",attrs:{"aria-hidden":"true"}}),e("i",{staticClass:"fas fa-level-down-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e()])},ya=[],ka={name:"device",data:function(){return{rotationDelta:0,targetParentLocation:0,checkHeartbeat:null,myLinks:{},hovered:!1,etag:Object(kt["a"])()}},props:["data","device","myHome"],created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){let i;try{i=JSON.parse(e.payloadString)}catch{return}i["uid"]===t.data.uid&&(e.topic===u||e.topic===h||e.topic===f?(null!==t.checkHeartbeat&&clearTimeout(t.checkHeartbeat),t.data.connected=!0,t.data.deviceConfigs["heartbeatRate"]>0&&(t.checkHeartbeat=setTimeout((function(){t.data.connected=!1}),2500*t.data.deviceConfigs["heartbeatRate"]))):e.topic===g?(t.data.connected=!1,null!==t.checkHeartbeat&&clearTimeout(t.checkHeartbeat)):e.topic===m?t.$set(t.$store.state.devices,i["device"]["id"],i["device"]):e.topic===p&&t.$delete(t.$store.state.devices,i["id"]))}))},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(u),this.$store.state.mqtt.unsubscribe(h),this.$store.state.mqtt.unsubscribe(m),this.$store.state.mqtt.unsubscribe(p),this.unwatch()},methods:{openSettings:function(){let t=this;const e={},i={view:"deviceOptionsPromptDialog",data:this.data,parent:this};this.$dialog.prompt(e,i).then((function(e){t.save()})).catch()},computeCustomStyle:function(){let t=this;return O()({method:"GET",url:`/myHome/devices/${this.data.id}/${this.etag}/device.png`}).then(e=>{if(e.headers["x-etag"]!==t.etag){t.etag=e.headers["x-etag"];let i=document.getElementById("dev_"+t.data.id);i.style.backgroundImage=`url('http://${t.$store.state.settings["aliceIp"]}:${t.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/devices/${t.data.id}/${t.etag}/device.png')`,i.style.backgroundPosition="center center",i.style.backgroundSize="contain",i.style.backgroundRepeat="no-repeat"}}),this.myHome.moveableItem.computeMyHomeCustomStyle(t.data,null)},save:function(){const t={parentLocation:this.data.parentLocation,settings:this.data.settings,deviceConfigs:this.data.deviceConfigs,linkConfigs:this.myHome.getDeviceLinks(this.data.id)},e=this;O()({method:"PATCH",url:`/myHome/devices/${this.data.id}/`,data:t,headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{if("success"in t.data&&t.data.success){e.myHome.removeDeviceLinks(e.data.id);for(const i of Object.values(t.data.links))e.myHome.$set(e.myHome.$store.state.deviceLinks,i.id,i);e.showSuccess(e.$t("notifications.successes.deviceSaved")),setTimeout((function(){e.myHome.drawDeviceLinks({specificDeviceId:e.data.id})}),250)}else e.showError(e.$t("notifications.errors.deviceSavingFailed"))})},handleClick:function(t){if(!this.myHome.toolsState.addingDevice)if(t.stopPropagation(),this.myHome.removeDroppable(),this.myHome.devicesEditMode&&this.myHome.toolsState.linkingDevices&&null===this.myHome.newConnectionLink&&0!==this.data.parentLocation){if(!this.myHome.getDeviceType(this).allowLocationLinks)return void this.showError(this.$t("notifications.errors.cannotLinkDevice"));this.myHome.newConnectionLine(this)}else if(this.myHome.devicesEditMode&&this.myHome.toolsState.unlinkingDevices&&null===this.myHome.newConnectionLink){if(!this.myHome.getDeviceType(this).allowLocationLinks)return void this.showError(this.$t("notifications.errors.cannotLinkDevice"));this.myHome.newDisconnectionLine(this)}else this.myHome.toolsState.unlinkingDevices&&null!==this.myHome.newConnectionLink||(this.myHome.toolsState.linkingDevices&&null!==this.myHome.newConnectionLink?this.showError(this.$t("notifications.errors.noDeviceToDeviceLink")):this.myHome.devicesEditMode&&t.target.classList.contains("device")&&this.myHome.toolsState["none"]?(this.myHome.setMoveable(t.target,this),this.myHome.moveableItem.setBoundaries(this.myHome.$refs.floorPlan),this.myHome.moveableItem.setGuidelines([])):this.myHome.devicesEditMode||this.myHome.locationsEditMode||O()({method:"GET",url:`/myHome/devices/${this.data.id}/onClick/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{if("success"in t.data)if(!t.data.success||!1 in t.data)this.showError(this.$t("notifications.errors.somethingWentWrong")),console.error(t.data.message);else{const e=t.data["ret"];this.handleDeviceClickReaction(e)}else this.showError(this.$t("notifications.errors.somethingWentWrong"))}))},handleDrag:function(t,e,i,s,a){const n=document.elementsFromPoint(s,a);for(const o of n)if(o.classList.contains("location")){const t=parseInt(o.id.substring(4));if(this.myHome.checkDevicePerLocationLimit(this.myHome.getDeviceType(this),t)){if(this.data.parentLocation!==t){this.myHome.removeDroppable(),o.classList.add("droppable"),this.targetParentLocation=t;break}}else this.data.parentLocation!==t&&(this.myHome.removeDroppable(),o.classList.add("notDroppable"))}else this.targetParentLocation=0,this.myHome.removeDroppable();throw this.myHome.refreshDeviceLinks(),!0},calcGlobalOffset:function(t){if(0===t)return[0,0];let e=this.$store.state.locations[t],i=this.calcGlobalOffset(e.parentLocation);return[e.settings.x+i[0],e.settings.y+i[1]]},setPosition:function(t,e,i){try{if(0===this.targetParentLocation||this.data.parentLocation===this.targetParentLocation)throw!0;{let e=this.calcGlobalOffset(this.data.parentLocation),i=this.calcGlobalOffset(this.targetParentLocation);const s=document.querySelector("#loc_"+this.targetParentLocation);this.myHome.moveableItem.container=s,this.$store.state.devices[this.data.id].parentLocation=this.targetParentLocation,this.$store.state.devices[this.data.id].settings["z"]=parseInt(s.style["z-index"])+1,this.$store.state.devices[this.data.id].settings["x"]=e[0]+parseInt(t.style.left.substring(-2))-i[0],this.$store.state.devices[this.data.id].settings["y"]=e[1]+parseInt(t.style.top.substring(-2))-i[1],this.targetParentLocation=0}}catch(s){throw s}},deleteMe:function(t){t.stopPropagation(),O()({method:"DELETE",url:`/myHome/devices/${this.data.id}/`,headers:{auth:this.$store.getters.apiToken}}).then(t=>{"success"in t.data&&t.data.success&&(this.myHome.deleteDevice(this.data.id),this.showSuccess(this.$t("notifications.successes.deviceDeleted")))})},onMouseEnter:function(){if(this.hovered=!0,this.myHome.locationsEditMode&&this.myHome.toolsState.none)for(const t of Object.values(this.myLinks))t.show("draw")},onMouseExit:function(){if(this.hovered=!1,this.myHome.locationsEditMode&&this.myHome.toolsState.none)for(const t of Object.values(this.myLinks))t.hide("draw")}}},ba=ka,wa=(i("72c1"),Object(A["a"])(ba,va,ya,!1,null,"e4eb1e08",null)),_a=wa.exports,$a=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"widget",style:t.computeCustomStyle(),attrs:{id:"wid_"+t.widget.id},on:{click:t.handleClick,mouseenter:function(e){t.hovered=!0},mouseleave:function(e){t.hovered=!1}}},[e("style",{tag:"component",attrs:{scoped:"",type:"text/css"}},[t._v(" "+t._s(t.widget.css)+" ")]),t.widget.settings["title"]?e("div",{staticClass:"widgetIcon"},[e("i",{class:t.widget.icon,attrs:{"aria-hidden":"true"}})]):t._e(),e("p",{class:{noCursorEvents:t.controller.dragAndResizeEnabled},domProps:{innerHTML:t._s(t.widget.taggedHtml)}}),t.controller.settings&&t.hovered?e("div",{staticClass:"widgetTool optioner",on:{click:function(e){return t.openSettings(t.widget)}}},[e("i",{staticClass:"fas fa-cogs clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.controller.removeWidgets?e("div",{staticClass:"widgetTool deleter",on:{click:function(e){return t.controller.removeWidget(t.widget.id)}}},[e("i",{staticClass:"far fa-trash-alt clickable",attrs:{"aria-hidden":"true"}})]):t._e(),t.controller.settings&&t.hovered?e("div",{staticClass:"widgetTool zindexer"},[e("i",{staticClass:"fas fa-level-up-alt clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.controller.moveZUp(t.widget)}}}),e("i",{staticClass:"fas fa-level-down-alt clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.controller.moveZDown(t.widget)}}})]):t._e()],1)},Ta=[],Ca={name:"widget",data:function(){return{hovered:!1,rotationDelta:0}},props:["controller","widget"],methods:{openSettings:function(){let t=this,e={...this.widget.settings},i={...this.widget.configs};this.settings=!1;const s={},a={view:"widgetOptionsPromptDialog",widget:this.widget,parent:this};this.$dialog.prompt(s,a).then(s=>{let a={};a["settings"]=s.data.settings,a["configs"]=s.data.configs,O()({method:"PATCH",url:`/widgets/${t.widget.id}/`,data:JSON.stringify(a),headers:{auth:t.$store.getters.apiToken,"content-type":"application/json"}}).catch(()=>{this.widget.settings=e,this.widget.configs=i}).finally(()=>{this.settings=!0;try{t.widget.instance.refresh()}catch(e){}})}).catch(()=>{this.widget.settings=e,this.widget.configs=i,this.settings=!0})},computeCustomStyle:function(){return this.controller.moveableItem.computeWidgetCustomStyle(this.widget)},save:function(){this.controller.saveWidget(this.widget)},handleClick:function(t){if(t.stopPropagation(),!this.controller.dragAndResizeEnabled||!t.target.classList.contains("widget"))return;this.controller.setMoveable(t.target,this),this.controller.moveableItem.setBoundaries(this.$el,10);const e=Array.from(document.querySelectorAll(".widget")).filter(t=>!(parseInt(t.id.substring(4))===this.widget.id));this.controller.moveableItem.setGuidelines(e)}}},Sa=Ca,Ia=(i("bf27"),Object(A["a"])(Sa,$a,Ta,!1,null,"5b8a1f3d",null)),La=Ia.exports,xa=function(){var t=this,e=t._self._c;return e("div",{staticClass:"notification clickable",on:{click:function(e){return t.dismiss(t.notification.id)}}},[e("div",{staticClass:"notificationTitle"},[e("i",{staticClass:"fa-fw",class:t.icon,attrs:{"aria-hidden":"true"}}),t._v(" "+t._s(t.notification["title"])+" ")]),e("div",{staticClass:"notificationContent"},[t._v(" "+t._s(t.notification["text"])+" ")])])},Pa=[],Da={name:"notification",props:["notification"],computed:{icon:function(){return 0===parseInt(this.notification["type"])?"far fa-times-circle":1===parseInt(this.notification["type"])?"far fa-comment-dots":2===parseInt(this.notification["type"])?"fas fa-exclamation-triangle":void 0}},methods:{dismiss:function(t){this.$parent.dismissNotification(t)}}},Ea=Da,ja=(i("6874"),Object(A["a"])(Ea,xa,Pa,!1,null,"975c4c76",null)),Ma=ja.exports,Oa=function(){var t=this,e=t._self._c;return e("div",["loading"!==t.status?e("div",{staticClass:"container"},[e("div",{staticClass:"flexrow"},[e("i",{staticClass:"fab fa-github size-4x"}),e("button",{on:{mouseup:function(e){return t.reload()}}},[e("i",{staticClass:"fas fa-sync-alt size-2x"}),t._v(" Refresh Status")]),t.advanced?e("button",{on:{mouseup:function(e){t.advanced=!t.advanced}}},[e("i",{staticClass:"fas fa-user-secret size-2x"}),t._v(" Advanced Mode")]):e("button",{on:{mouseup:function(e){t.advanced=!t.advanced}}},[e("i",{staticClass:"fas fa-user size-2x"}),t._v(" Standard Mode")]),e("button",{on:{mouseup:function(e){return t.revert()}}},[e("i",{staticClass:"fas fa-history size-2x"}),t._v(" Revert all changes")])]),e("br"),e("br"),e("br"),e("div",[t._v("Uncommitted changes: "+t._s(Object.keys(t.changes).length))]),t.advanced?e("div",[e("textarea",[t._v(t._s(t.changes))])]):t._e(),e("br"),e("div",{staticClass:"noRepo flexrow"},[t.initialUploadRequired?e("div",[t._v(" It looks like you never uploaded this skill!"),e("br"),t._v(" Use the following button to upload it to your private github repository."),e("br"),t._v(" Only once uploaded there, you can release it for others to see and use!"),e("br"),e("button",{on:{mouseup:function(e){return t.upload()}}},[t._v("Initial Upload")])]):t._e(),t.gitInitRequired?e("div",[t._v(" Oh no! You never initialised this skills folder as a git repository!"),e("br"),e("button",[t._v("Initialise Git")])]):t._e()]),t._l(t.status,(function(i){return e("div",[e("div",{staticClass:"flexrow",class:{active:i.name==t.upstream.remote}},[e("label",{staticStyle:{width:"5em"}},[t._v(t._s(i.name)),e("div",[t._v(t._s(i.repoType))])]),e("input",{attrs:{readonly:""},domProps:{value:i.url}}),i.status?e("i",{staticClass:"fas fa-check-circle",staticStyle:{color:"green"}}):t._e(),i.status?t._e():e("i",{staticClass:"fas fa-times-circle",staticStyle:{color:"red"}}),i.commitsBehind>0?e("i",{staticClass:"fas fa-minus",staticStyle:{color:"yellow"}},[t._v(" "+t._s(i.commitsBehind))]):t._e(),i.commitsAhead>0?e("i",{staticClass:"fas fa-plus",staticStyle:{color:"yellow"}},[t._v(" "+t._s(i.commitsAhead))]):t._e(),0==i.commitsAhead&&0==i.commitsBehind?e("i",{staticClass:"fas fa-equals"}):t._e(),-1==i.commitsAhead||-1==i.commitsBehind?e("i",{staticClass:"fas fa-question",staticStyle:{color:"gray"}}):t._e(),t._v(" "+t._s(t.request)+" ")]),e("div",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedBranch[i.name],expression:"selectedBranch[st.name]"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.selectedBranch,i.name,e.target.multiple?s:s[0])}}},t._l(Object.keys(i.lsRemote),(function(i){return e("option",[t._v(t._s(i))])})),0)]),"Public"==i.name?e("div",{staticClass:"small"},[t._v(" changing tags/branches might cause unexpected results! ")]):t._e(),e("div",{staticClass:"flexrow"},[e("button",{on:{mouseup:function(e){return t.checkout(i.name)}}},[t._v("Checkout")]),"Private"==i.name?e("button",{on:{mouseup:function(e){return t.upload()}}},[t._v("Upload")]):t._e(),t.privateExists||"Public"!=i.repoType?t._e():e("button",{on:{mouseup:function(e){return t.fork()}}},[t._v("Fork")]),t.publicExists&&"Private"==i.repoType?e("button",{on:{mouseup:function(e){return t.createPR(i.user)}}},[t._v("Create PR")]):t._e(),e("button",{on:{mouseup:function(e){return t.open(i.url)}}},[t._v("Web")])]),e("br"),e("br")])})),t.advanced?e("div",[t._m(0),t._m(1)]):t._e()],2):e("div",[e("i",{staticClass:"fab fa-github fa-spin size-4x centered"}),e("span",{staticClass:"centered"},[t._v(t._s(t.activeCommand)+"..")])])])},Ha=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"flexrow"},[e("label",{staticStyle:{width:"5em"}},[t._v("new")]),e("input",{attrs:{id:"newRepo"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"flexrow"},[e("button",[t._v("Add new")])])}],Na={name:"gitStatus",props:["skill"],data:()=>({status:{},changes:{},upstream:{},selectedBranch:{},request:void 0,privateExists:!1,publicExists:!1,PRpossible:!1,initialUploadRequired:!1,gitInitRequired:!1,advanced:!1,activeCommand:"git fetch"}),mounted(){this.reload()},methods:{checkout(t){let e=this;this.activeCommand="git checkout",O()({method:"GET",url:`/skills/${this.$parent.editingSkill.name}/checkout/${t}/${this.selectedBranch[t]}/`,headers:{auth:this.$store.getters.apiToken}}).then((function(t){1==t.data.success?e.reload():(console.log(t.data),e.status=void 0)}))},upload(t){this.activeCommand="git push",this.init();let e=this;O()({method:"GET",url:`/skills/${e.skill}/upload/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then((function(t){1==t.data.success?e.reload():(console.log(t.data),e.status=void 0)})).catch((function(t){e.status=void 0,e.request=t}))},fork(){this.activeCommand="Web: Creating fork",this.init();let t=this;O()({method:"GET",url:`/skills/${t.skill}/setModified/`,headers:{auth:this.$store.getters.apiToken}}).then((function(e){1==e.data.success?t.reload():(console.log(e.data),t.status=void 0)})).catch((function(e){t.status=void 0,t.request=e}))},open(t){window.open(t,"_blank")},init(){this.status="loading",this.changes={},this.privateExists=!1,this.publicExists=!1,this.PRpossible=!1,this.initialUploadRequired=!1,this.gitInitRequired=!1},createPR(t){self=this,this.$dialog.prompt({title:"Please name your Pull Request",body:"Make sure you have Uploaded all your changes and changed the skills Version!The name should be short and precisely describe your changes"},{promptHelp:"",okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(e){let i=e.data;window.open("https://github.com/project-alice-assistant/skill_"+self.$parent.editingSkill.name+"/compare/master..."+t+":master?diff=split&quick_pull=1&title="+i)}))},revert(){this.init(),this.activeCommand="git stash";let t=this;O()({method:"GET",url:`/skills/${t.skill}/revert/`,headers:{auth:this.$store.getters.apiToken}}).then((function(e){t.reload()})).catch((function(e){t.status={},t.request=e}))},reload(){this.init(),this.activeCommand="git fetch";let t=this;O()({method:"GET",url:`/skills/${t.skill}/gitStatus/`,headers:{auth:this.$store.getters.apiToken}}).then((function(e){if(1==e.data.success){if(e.data.upstream){let i=e.data.upstream.split("/");t.upstream.remote=i[0],t.upstream.branch=i[1]}else t.upstream.remote="origin",t.upstream.branch="master";for(let i in e.data.result)"Private"===e.data.result[i].repoType?t.privateExists=!0:"Public"===e.data.result[i].repoType&&(t.publicExists=!0),e.data.result[i].name==t.upstream.remote?t.selectedBranch[t.upstream.remote]=t.upstream.branch:t.selectedBranch[e.data.result[i].name]="master";t.status=e.data.result,t.changes=e.data.changes}else console.log(e.data),e.data.noRemote?t.initialUploadRequired=!0:e.data.noGit&&(t.gitInitRequired=!0),t.status=void 0})).catch((function(e){t.status={},t.request=e}))}}},Aa=Na,Fa=(i("d236"),Object(A["a"])(Aa,Oa,Ha,!1,null,"70cad4aa",null)),Va=Fa.exports,za=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.microphoneSupport?e("button",{class:{red:t.listening},on:{click:t.toggleListening}},[e("i",{class:t.icon,attrs:{"aria-hidden":"true"}})]):t._e()},qa=[];let Ua=i("a9ee");var Wa={name:"micStreamer",props:["icon"],data:function(){return{recorder:null,listening:!1,microphoneSupport:!1}},created:function(){navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(()=>{this.microphoneSupport=!0}).catch(()=>{console.log("Audio recording not supported")});let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){if(j===e.topic||S===e.topic){let i=JSON.parse(e.payloadString);i.siteId===localStorage.getItem("interfaceUid")&&t.stopRecording()}if(E===e.topic){let i=JSON.parse(e.payloadString);i.siteId===localStorage.getItem("interfaceUid")&&t.startStream()}}))},methods:{toggleListening:function(){this.listening?this.stopRecording():(this.listening=!0,this.$store.state.mqtt.publish("hermes/hotword/default/detected",JSON.stringify({siteId:localStorage.getItem("interfaceUid"),modelType:"universal"})))},startStream:function(){let t=this;navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then((async function(e){t.recorder=Ua(e,{type:"audio",mimeType:"audio/wav",desiredSampRate:16e3,timeSlice:100,recorderType:Ua.StereoAudioRecorder,numberOfAudioChannels:1,ondataavailable:e=>{e.arrayBuffer().then(e=>{t.$store.state.mqtt.publish(D.replace("{}",localStorage.getItem("interfaceUid")),e)})}}),t.recorder.startRecording()})).catch(e=>{console.log("Audio recording not supported:",e),t.stopRecording()})},stopRecording:function(){this.listening=!1,null!==this.recorder&&this.recorder.stopRecording()}}},Ra=Wa,Ba=(i("e84d"),Object(A["a"])(Ra,za,qa,!1,null,"640b4998",null)),Ga=Ba.exports,Ya=(i("c5c5"),i("2440"),i("0ae1"),i("bee4"),i("ec1f"),i("7ad4"),i("88bc"),i("b2dc"),i("1927"),i("c18f"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-view-wrapper"},[e("div",{staticClass:"dg-content-body dg-content-body--has-title"},[e("h6",{staticClass:"dg-title"},[t._v(t._s(t.parent.$t("dialogs.titles.newIcon")))]),e("div",{staticClass:"dg-content",domProps:{innerHTML:t._s(t.parent.$t("dialogs.bodies.enterNewIcon"))}}),e("form",{staticClass:"dg-form",attrs:{autocomplete:"off","data-children-count":"1"},on:{submit:function(t){t.preventDefault()}}},[e("label",{attrs:{for:"dg-input-elem"}},[t._v(t._s(t.parent.$t("dialogs.labels.faExample")))]),e("br"),e("br"),e("input",{directives:[{name:"model",rawName:"v-model",value:t.iconInput,expression:"iconInput"}],attrs:{id:"dg-input-elem",autocomplete:"off",type:"text"},domProps:{value:t.iconInput},on:{input:[function(e){e.target.composing||(t.iconInput=e.target.value)},t.update]}})])]),e("div",{staticClass:"dg-content-footer"},[e("button",{staticStyle:{"background-color":"var(--windowBG)"},on:{click:t.handleDismiss}},[t._v(" "+t._s(t.parent.$t("buttons.cancel"))+" ")]),e("button",{staticClass:"dg-pull-right",staticStyle:{"background-color":"var(--windowBG)"},on:{click:t.handleConfirm}},[e("i",{staticClass:"fa-2x",class:t.icon,attrs:{"aria-hidden":"true"}})])])])}),Ja=[],Ka=i("0fa0"),Xa=i.n(Ka),Za={mixins:[Xa.a],data:function(){return{parent:this.options["parent"],iconInput:this.options["current"]||"fas fa-biohazard"}},computed:{icon:function(){const t=/<i class="(.*)"><\/i>/,e=t.exec(this.iconInput);return e?e[1]:this.iconInput}},methods:{handleConfirm(){this.proceed(this.icon)},handleDismiss(){this.cancel()},update(){this.$forceUpdate()}}},Qa=Za,tn=Object(A["a"])(Qa,Ya,Ja,!1,null,null,null),en=tn.exports,sn=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"custom-view-wrapper"},[e("h3",[t._v(t._s(t.parent.$t("dialogs.titles.widgetOptions")))]),e("tabs",{attrs:{activeTabId:t.activeTabId,parent:this,store:t.parent.$store,tabs:t.tabs}}),1===t.activeTabId?e("div",{staticClass:"tab_page"},[e("div",{staticClass:"configLayout"},[0===Object.keys(t.widget.configs).length?e("div",{staticClass:"spacedText"},[t._v("No widget specific configuration")]):t._e(),e("config",{attrs:{holder:t.widget.configs,templates:t.widget["configTemplate"],translate:e=>t.parent.$t(e)}})],1)]):t._e(),2===t.activeTabId?e("div",{staticClass:"tab_page"},[e("div",{staticClass:"configLayout"},[e("config",{attrs:{holder:t.widget.settings,templates:t.designConfig(),translate:e=>t.parent.$t(e)}})],1)]):t._e(),e("div",{staticClass:"dg-actions"},[e("button",{on:{click:t.handleDismiss}},[t._v(t._s(t.parent.$t("buttons.cancel")))]),e("button",{staticClass:"dg-pull-right",on:{click:t.handleConfirm}},[t._v(t._s(t.parent.$t("buttons.confirm")))])])],1)},an=[],nn={mixins:[Xa.a],data:function(){let t=2;return Object.keys(this.options["widget"].configs).length>0&&(t=1),{parent:this.options["parent"],widget:this.options["widget"],activeTabId:t,tabs:{1:{icon:"fas fa-cogs",id:1,position:0},2:{icon:"fas fa-paint-brush",id:2,position:1}}}},methods:{designConfig:function(){let t={title:{defaultValue:!1,dataType:"boolean",isSensitive:!1,description:"Show the title of the widget"},borders:{defaultValue:!1,dataType:"boolean",isSensitive:!1,description:"Show a shadow drop/border"},background:{defaultValue:"#000000",dataType:"color2rgba",isSensitive:!1,description:"The background color of the widget"},"background-opacity":{defaultValue:!1,dataType:"range2rgba",isSensitive:!1,description:"The opacity of the widget",min:"0",max:"1",step:"0.1",unit:"%"},"font-size":{defaultValue:1,dataType:"range",isSensitive:!1,description:"Relative font size in this widget",min:"0.25",max:"5",step:"0.01",unit:"em"},"font-color":{defaultValue:"#D1D1D1",dataType:"color",isSensitive:!1,description:"Color of the text in the widget"}};return t},handleConfirm(){this.proceed(this.options["widget"])},handleDismiss(){this.cancel()}}},on=nn,ln=(i("5b11"),Object(A["a"])(on,sn,an,!1,null,"204617b5",null)),rn=ln.exports,cn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-view-wrapper"},[e("h3",[t._v(t._s(t.parent.$t("dialogs.titles.skillSettings")))]),e("div",[e("config",{attrs:{holder:t.options["skill"]["settings"],templates:t.options["skill"]["settingsTemplate"],translate:e=>t.parent.$t(e)}}),e("div",[e("button",{on:{click:t.handleDismiss}},[t._v(t._s(t.parent.$t("buttons.cancel")))]),e("button",{on:{click:t.handleConfirm}},[t._v(t._s(t.parent.$t("buttons.confirm")))])])],1)])},dn=[],un={mixins:[Xa.a],data:function(){return{parent:this.options["parent"],skill:this.options["skill"]}},methods:{handleConfirm(){this.proceed(this.options["skill"]["settings"])},handleDismiss(){this.cancel()}}},hn=un,mn=Object(A["a"])(hn,cn,dn,!1,null,null,null),pn=mn.exports,fn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-view-wrapper"},[e("h3",[t._v(t._s(t.parent.$t("dialogs.titles.locationSetting")))]),e("div",{staticClass:"synonyms"},t._l(t.data.synonyms,(function(i){return e("div",{key:"syn_"+i,staticClass:"synonym"},[e("i",{staticClass:"fas fa-minus-circle fa-pull-left clickable",attrs:{"aria-hidden":"true"},on:{click:function(e){return t.removeSynonym(i)}}}),t._v(t._s(i)+" ")])})),0),e("p",[e("label",{attrs:{for:"newSynonym"}},[t._v(t._s(t.parent.$t("dialogs.labels.addLocationSynonym")))]),t._v(": "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newSynonym,expression:"newSynonym"}],class:{error:t.error},attrs:{id:"newSynonym",placeholder:t.parent.$t("dialogs.placeholders.typeAndPressEnter"),name:"newSynonym",type:"text"},domProps:{value:t.newSynonym},on:{keyup:[t.checkSynonym,function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addSynonym.apply(null,arguments)}],input:function(e){e.target.composing||(t.newSynonym=e.target.value)}}})]),e("div",[e("button",{on:{click:t.handleDismiss}},[t._v(t._s(t.parent.$t("buttons.cancel")))]),e("button",{staticClass:"dg-pull-right",on:{click:t.handleConfirm}},[t._v(t._s(t.parent.$t("buttons.confirm")))])])])},gn=[],vn={mixins:[Xa.a],data:function(){return{parent:this.options["parent"],data:this.options["data"],newSynonym:"",error:!1}},methods:{checkSynonym(){this.error=!this.parent.myHome.checkIfSynonymIsFree(this.newSynonym)},addSynonym(){this.newSynonym.length<=0||!this.parent.myHome.checkIfSynonymIsFree(this.newSynonym)||(this.parent.data.synonyms.push(this.newSynonym),this.newSynonym="")},removeSynonym(t){this.parent.data.synonyms=this.parent.data.synonyms.filter(e=>e!==t)},handleConfirm(){this.proceed()},handleDismiss(){this.cancel()}}},yn=vn,kn=(i("5163"),Object(A["a"])(yn,fn,gn,!1,null,"2d7ca5f2",null)),bn=kn.exports,wn=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"custom-view-wrapper"},[e("h3",[t._v(t._s(t.parent.$t("dialogs.titles.deviceSettings")))]),e("h4",[t._v(t._s(t.parent.$t("dialogs.titles.generalSettings")))]),e("config",{attrs:{holder:t.$data.parent.$store.state.devices[t.parent.data["id"]].deviceConfigs,templates:t.deviceTemplates,translate:e=>t.parent.$t(e)}}),t.parent.myLinks.length>0?e("h4",[t._v(t._s(t.parent.$t("dialogs.titles.deviceLinksSettings")))]):t._e(),t._l(t.parent.myLinks,(function(i,s){return e("div",{key:s},[e("h5",[t._v(t._s(t.parent.$t("dialogs.titles.linkTo"))+": "+t._s(t.$data.parent.$store.state.locations[t.$data.parent.$store.state.deviceLinks[s].targetLocation].name))]),e("config",{attrs:{holder:t.$data.parent.$store.state.deviceLinks[s].configs,templates:t.myLinkConfigTemplates,translate:e=>t.parent.$t(e)}})],1)})),e("button",{on:{click:t.handleDismiss}},[t._v(t._s(t.parent.$t("buttons.cancel")))]),e("button",{staticClass:"dg-pull-right",on:{click:t.handleConfirm}},[t._v(t._s(t.parent.$t("buttons.confirm")))])],2)},_n=[],$n={mixins:[Xa.a],data:function(){return{parent:this.options["parent"],data:this.options["data"]}},computed:{myConfigTemplates:function(){return this.parent.myHome.getDeviceType(this).deviceConfigsTemplates},myLinkConfigTemplates:function(){return this.parent.myHome.getDeviceType(this).linkConfigsTemplates},deviceTemplates:function(){return Object.assign({},this.myConfigTemplates,this.genericDeviceTemplates)},genericDeviceTemplates:function(){let t={displayName:{defaultValue:"",dataType:"string",isSensitive:!1,description:"The name to display for this device"}};return this.data["allowHeartbeatOverride"]&&(t["heartbeat"]={defaultValue:0,dataType:"integer",isSensitive:!1,description:"Allow overwriting of the heartbeat"}),t},configValue(){return t=>this.data.deviceConfigs[t]||""}},methods:{handleConfirm(){this.proceed()},handleDismiss(){this.cancel()}}},Tn=$n,Cn=Object(A["a"])(Tn,wn,_n,!1,null,"4a43e166",null),Sn=Cn.exports,In=function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-view-wrapper"},[e("h3",[t._v(t._s(t.parent.$t("dialogs.titles.addDevice")))]),Object.keys(t.parent.shownDeviceTypes).length>0?e("div",[e("p",[e("label",{attrs:{for:"deviceList"}},[t._v(t._s(t.parent.$t("dialogs.bodies.chooseDevice")))]),e("br")]),Object.keys(t.parent.shownDeviceTypes).length>0?e("p",[e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],attrs:{id:"deviceList"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?i:i[0]}}},t._l(t.parent.shownDeviceTypes,(function(i,s){return e("optgroup",{key:s,attrs:{label:s.toUpperCase()}},t._l(i,(function(i){return e("option",{key:i.deviceTypeName,domProps:{value:i}},[t._v(t._s(i.deviceTypeName))])})),0)})),0)]):t._e()]):e("p",[t._v(" "+t._s(t.parent.$t("dialogs.bodies.noDevices"))+" ")]),e("div",[e("button",{on:{click:t.handleDismiss}},[t._v(t._s(t.parent.$t("buttons.cancel")))]),e("button",{staticClass:"dg-pull-right",on:{click:t.handleConfirm}},[t._v(t._s(t.parent.$t("buttons.confirm")))])])])},Ln=[],xn={mixins:[Xa.a],data:function(){return{selected:null,parent:this.options["parent"],error:!1}},methods:{handleConfirm(){this.selected||this.cancel(),this.proceed(this.selected)},handleDismiss(){this.cancel()}}},Pn=xn,Dn=Object(A["a"])(Pn,In,Ln,!1,null,null,null),En=Dn.exports,jn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"custom-view-wrapper"},[e("div",{staticClass:"dg-content-body dg-content-body--has-title"},[e("h6",{staticClass:"dg-title"},[t._v(t._s(t.data["title"]))]),e("div",{staticClass:"dg-content"},[t._v(t._s(t.data["body"])+" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selected=e.target.multiple?i:i[0]}}},t._l(t.data["list"],(function(i){return e("option",{domProps:{value:i}},[t._v(t._s(i))])})),0)])]),e("div",[e("button",{on:{click:t.handleDismiss}},[t._v(" "+t._s(t.parent.$t("buttons.cancel"))+" ")]),e("button",{staticClass:"dg-pull-right",on:{click:t.handleConfirm}},[t._v(" "+t._s(t.parent.$t("buttons.ok"))+" ")])])])},Mn=[],On={mixins:[Xa.a],data:function(){return{parent:this.options["parent"],data:this.options["data"],selected:""}},methods:{handleConfirm(){this.proceed(this.selected)},handleDismiss(){this.cancel()},update(){this.$forceUpdate()}}},Hn=On,Nn=Object(A["a"])(Hn,jn,Mn,!1,null,null,null),An=Nn.exports,Fn={name:"dialogView",components:{SpeechBubble:Ee},data:function(){return{cmd:"",unwatch:{},msgs:[],say:"",history:[],historyPosition:0,currentSpeech:void 0,currentSession:void 0,menuItems:[{name:this.$t("tooltips.close"),icon:"far fa-pause-circle",extendedIcon:"far fa-play-circle",extendedName:this.$t("tooltips.close"),isToggle:!0,onClick:()=>{}}]}},created:function(){let t=this;this.unwatch=this.$store.watch((function(t){return t.mqttMessage}),(function(e){S===e.topic&&(t.currentSession=void 0),[C,T,S].includes(e.topic)&&t.msgs.push(e),[x,L].includes(e.topic)&&(t.currentSpeech=e),C===e.topic&&(t.currentSpeech=void 0)}))},activated:function(){let t=this.$el.querySelector("#messageContainer");t.scrollTop=t.scrollHeight},updated:function(){let t=this.$el.querySelector("#messageContainer");t.scrollTop=t.scrollHeight},beforeDestroy:function(){this.$store.state.mqtt.unsubscribe(C),this.$store.state.mqtt.unsubscribe(T),this.$store.state.mqtt.unsubscribe(S),this.unwatch()},methods:{sendQuery:function(){if(""===this.say)return;const t=new FormData;t.append("query",this.say),t.append("deviceUid",localStorage.getItem("interfaceUid")),this.history.push(this.say),this.historyPosition=this.history.length,void 0===this.currentSession?O()({method:"POST",url:"/dialog/process/",data:t,headers:{auth:this.$store.getters.apiToken,"Content-Type":"multipart/form-data"}}).then(t=>{"sessionId"in t.data&&(this.currentSession=t.data.sessionId)}):(t.append("sessionId",this.currentSession),O()({method:"POST",url:"/dialog/continue/",data:t,headers:{auth:this.$store.getters.apiToken,"Content-Type":"multipart/form-data"}})),this.say=""},historyUp:function(){this.historyPosition<=0?this.say=this.history[0]:(this.historyPosition-=1,this.say=this.history[this.historyPosition])},historyDown:function(){this.historyPosition>=this.history.length-1?this.say=this.history[-1]:(this.historyPosition+=1,this.say=this.history[this.historyPosition])}}},Vn=i("a65d"),zn=i.n(Vn);const qn={install(t,e){t.use(zn.a,{iconPack:"fontawesome",containerClass:"notifyContainer"}),t.mixin({methods:{showError(e){t.toasted["error"](e,{duration:4e3,position:"top-center",keepOnHover:!0,icon:"exclamation-triangle"})},showSuccess(e){t.toasted["success"](e,{duration:4e3,position:"top-center",keepOnHover:!0,icon:"check-square"})},showInfo(e){t.toasted["info"](e,{duration:4e3,position:"top-center",keepOnHover:!0,icon:"info-circle"})},checkResponse(t){return"success"in t.data&&t.data.success?("message"in t.data&&this.showSuccess(t.data["message"]),!0):("message"in t.data&&this.showError(t.data["message"]),!1)},handleDeviceClickReaction(t){if("info_notification"===t["action"])this.showInfo(t["data"]["body"]||this.$t(t["data"]));else if("success_notification"===t["action"])this.showSuccess(t["data"]["body"]||this.$t(t["data"]));else if("error_notification"===t["action"])this.showError(t["data"]["body"]||this.$t(t["data"]));else if("navigate"===t["action"])window.open(t["data"],"_blank");else if("answer_string"===t["action"])this.$dialog.prompt({title:this.$t(t["data"]["title"]),body:this.$t(t["data"]["body"]),okText:this.$t("buttons.ok"),cancelText:this.$t("buttons.cancel")}).then((function(e){O()({method:"POST",url:`http://${self.$store.state.settings["aliceIp"]}:${self.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/devices/${self.data.id}/reply/`,data:{secret:t["reply"]["secret"],concerns:t["reply"]["concerns"],answer:e.data},headers:{auth:self.$store.getters.apiToken,"content-type":"application/json"}})})).catch();else if("list_select"===t["action"]){const e={view:"deviceReplyListSelect",data:t["data"],parent:this};this.$dialog.prompt({},e).then((function(e){O()({method:"POST",url:`http://${self.$store.state.settings["aliceIp"]}:${self.$store.state.settings["apiPort"]}/api/v1.0.1/myHome/devices/${self.data.id}/reply/`,data:{secret:t["reply"]["secret"],concerns:t["reply"]["concerns"],answer:e.data},headers:{auth:self.$store.getters.apiToken,"content-type":"application/json"}})})).catch()}}}})}};var Un=qn;s["default"].config.productionTip=!1,s["default"].use(Un),s["default"].use(mi["a"],O.a),s["default"].use(yi.a),s["default"].use(_i.a),s["default"].use(Ti.a),s["default"].use(bi.a),s["default"].use(Ci["a"]),s["default"].use(Ii.a),s["default"].use(Li["a"]),s["default"].component("VueToggles",gi["a"]),s["default"].component("skill",Mi),s["default"].component("storeSkill",Vi),s["default"].component("editSkillTile",Bi),s["default"].component("actionsMenu",Zi),s["default"].component("tabs",as),s["default"].component("reactive-icon",ds),s["default"].component("location",gs),s["default"].component("dialogView",Fn),s["default"].component("furniture",_s),s["default"].component("construction",ga),s["default"].component("device",_a),s["default"].component("configInput",Ms),s["default"].component("configLine",Ls),s["default"].component("configInputList",Vs),s["default"].component("dialogTemplateEditor",Bs),s["default"].component("simpleJsonEditor",Zs),s["default"].component("talkFileEditor",aa),s["default"].component("config",da),s["default"].component("widget",La),s["default"].component("notification",Ma),s["default"].component("gitStatus",Va),s["default"].component("micStreamer",Ga),s["default"].dialog.registerComponent("fontawesomePromptDialog",en),s["default"].dialog.registerComponent("widgetOptionsPromptDialog",rn),s["default"].dialog.registerComponent("skillSettingsPromptDialog",pn),s["default"].dialog.registerComponent("locationSettingsPromptDialog",bn),s["default"].dialog.registerComponent("addDevicePromptDialog",En),s["default"].dialog.registerComponent("deviceOptionsPromptDialog",Sn),s["default"].dialog.registerComponent("deviceReplyListSelect",An),s["default"].directive("init",{bind(t,e,i){let s=i.data.directives.find(t=>"v-model"===t.rawName);s&&(i.context[s.expression]=e.value)}});const Wn=new Li["a"]({local:"en",fallbackLocale:"en",messages:{}});new s["default"]({store:fi,router:hi,i18n:Wn,render:t=>t($t)}).$mount("#app")},"58a6":function(t,e,i){},"5a66":function(t,e,i){},"5afd":function(t,e,i){"use strict";i("0acb")},"5b11":function(t,e,i){"use strict";i("d82f")},6867:function(t,e,i){},6874:function(t,e,i){"use strict";i("e2ca")},"6b50":function(t,e,i){"use strict";i("7f32")},"6d69":function(t,e,i){"use strict";i("2178")},"6f03":function(t,e,i){"use strict";i("a6d2")},"72c1":function(t,e,i){"use strict";i("c7e4")},"759a":function(t,e,i){},"779a":function(t,e,i){"use strict";i("eeb3")},"77fa":function(t,e,i){"use strict";i("a67e")},"7ad4":function(t,e,i){},"7b23":function(t,e,i){},"7f32":function(t,e,i){},8102:function(t,e,i){},8700:function(t,e,i){},"88bc":function(t,e,i){},8967:function(t,e,i){},"8a78":function(t,e,i){},"8c9e":function(t,e,i){},"8def":function(t,e,i){},"92ea":function(t,e,i){},"9f7f":function(t,e,i){"use strict";i("8c9e")},a307:function(t,e,i){},a67e:function(t,e,i){},a6d2:function(t,e,i){},ac56:function(t,e,i){"use strict";i("5629")},b1ec:function(t,e,i){},b2d9:function(t,e,i){"use strict";i("e290")},b2dc:function(t,e,i){},b78c:function(t,e,i){},bee4:function(t,e,i){},bf27:function(t,e,i){"use strict";i("8a78")},c067:function(t,e,i){},c18f:function(t,e,i){},c25c:function(t,e,i){},c3b2:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("14d9"),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),uuid__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("ec26"),_moveableItem__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("3bb6"),_utils_jsLoader__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("50ea");__webpack_exports__["a"]={name:"pa-widgets",data:function(){return{uid:Object(uuid__WEBPACK_IMPORTED_MODULE_2__["a"])(),controller:this,moveableItem:new _moveableItem__WEBPACK_IMPORTED_MODULE_3__["a"](this),menuItems:[{name:this.$t("tooltips.edit"),icon:"fas fa-pen-square",isToggle:!0,extendedIcon:"fas fa-times-circle",extendedName:this.$t("tooltips.close"),onClose:()=>{this.removeWidgets=!1,this.settings=!1,this.dragAndResizeEnabled=!1,this.moveableItem.destroyMoveable()},onOpen:()=>{this.dragAndResizeEnabled=!0}},{name:this.$t("tooltips.theaterMode"),icon:"fas fa-person-booth",isToggle:!0,callback:this.cinemaMode},{name:this.$t("tooltips.magicMirrorMode"),icon:"fas fa-magic",isToggle:!0,callback:this.magicMirrorMode},{name:this.$t("tooltips.settings"),icon:"fas fa-cog",activeClass:"yellow",onClick:()=>{this.settings=!this.settings}},{name:this.$t("tooltips.addWidgets"),icon:"far fa-plus-square",onClick:()=>{this.addWidgets=!0}},{name:this.$t("tooltips.removeWidgets"),icon:"far fa-minus-square",onClick:()=>{this.removeWidgets=!this.removeWidgets}}],settings:!1,addWidgets:!1,removeWidgets:!1,activeTabId:1,selectedWidget:-1,dragAndResizeEnabled:!1,hasTitle:!0,jsImports:"",loadedClasses:[]}},computed:{activePageWidgets:function(){return Object.values(this.$store.state.widgetInstances).filter(t=>t["page"]===this.activeTabId)}},created:function(){this.activeTabId=parseInt(localStorage.getItem("widgetsActiveTabId"))||1;const t=this;document.addEventListener("keyup",(function(e){"m"===e.key?(t.moveableItem.destroyMoveable(),t.dragAndResizeEnabled=!t.dragAndResizeEnabled,t.settings=!1):"s"===e.key?(t.moveableItem.destroyMoveable(),t.settings=!t.settings,t.dragAndResizeEnabled=!1):"Escape"===e.key&&(t.moveableItem.destroyMoveable(),t.settings=!1,t.dragAndResizeEnabled=!1)}))},mounted:function(){setTimeout(()=>this.startWidgetsOnPage(self.activeTabId),500)},activated:function(){this.uid=Object(uuid__WEBPACK_IMPORTED_MODULE_2__["a"])(),this.removeWidgets=!1,this.settings=!1,this.dragAndResizeEnabled=!1,this.startWidgetsOnPage(this.activeTabId)},deactivated:function(){this.stopAllWidgets()},methods:{setMoveable:function(t,e){this.moveableItem.setMoveable(t,e)},startWidgetsOnPage:function(t){for(const e of Object.values(this.$store.state.widgetInstances))e["page"]===t&&this.startWidgetScript(e)},startWidgetScript:function(widget){const uuid=Object(uuid__WEBPACK_IMPORTED_MODULE_2__["a"])();widget.taggedHtml=widget.html.replace(/data-ref="(.*?)"/gi,`data-ref="$1_${uuid}"`);const src=`http://${this.$store.state.settings["aliceIp"]}:${this.$store.state.settings["apiPort"]}/api/v1.0.1/widgets/resources/${widget.skill}/${widget.name}`;let self=this;Object(_utils_jsLoader__WEBPACK_IMPORTED_MODULE_4__["a"])(src+".js").then(()=>{let cls=eval(`${widget.skill}_${widget.name}`),inst=new cls(uuid,widget.id,widget);widget.instance=inst,self.loadedClasses.push(inst)})},stopAllWidgets:function(){while(this.loadedClasses&&this.loadedClasses.length){let t=this.loadedClasses.pop();"function"===typeof t.stop&&t.stop()}},changePage:function(t){this.moveableItem.destroyMoveable(),this.activeTabId=t,this.$forceUpdate(),this.stopAllWidgets(),this.startWidgetsOnPage(this.activeTabId),localStorage.setItem("widgetsActiveTabId",this.activeTabId)},cinemaMode:function(){this.$store.commit("toggleCinemaMode"),this.$store.state.fullScreen&&this.showInfo(this.$t("notifications.info.theaterModeExplain"))},magicMirrorMode:function(){this.$store.commit("toggleMagicMirrorMode"),this.$store.state.fullScreen&&this.showInfo(this.$t("notifications.info.magicMirrorModeExplain"))},addWidget:function(t,e){axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"PUT",url:"/widgets/",data:{skillName:t,widgetName:e,pageId:this.activeTabId},headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{"widget"in t.data&&(this.$set(this.$store.state.widgetInstances,t.data["widget"]["id"],t.data.widget),this.startWidgetScript(t.data.widget))})},removeWidget:function(t){axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"DELETE",url:`/widgets/${t}/`,headers:{auth:this.$store.getters.apiToken}}).then(e=>{if("success"in e.data&&e.data.success){const e=this.listOfWidgetOnPage(this.$store.state.widgetInstances[t]["page"]),i=this.$store.state.widgetInstances[t]["settings"]["z"];this.$delete(this.$store.state.widgetInstances,t);for(const t of e)t.settings["z"]>i&&(t.settings["z"]-=1,this.saveWidget(t))}})},saveWidget(t){const e=this;let i={};i["settings"]=t.settings,i["configs"]=t.configs,axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"PATCH",url:`/widgets/${t.id}/`,data:JSON.stringify(i),headers:{auth:this.$store.getters.apiToken,"content-type":"application/json"}}).then(t=>{"success"in t.data&&t.data.success?e.showSuccess(e.$t("notifications.successes.widgetSaved")):e.showError(e.$t("notifications.errors.widgetSavingFailed"))})},sanitizeZ(t){let e=this.listOfWidgetOnPage(t),i=e.sort((t,e)=>t.settings["z"]>e.settings["z"]?1:-1),s=1;for(const a of i)a.settings["z"]!==s&&(console.log("Fixed z-ordering for",a.name),a.settings["z"]=s,this.saveWidget(a)),s++},moveZUp(t){this.sanitizeZ(t["page"]);const e=t.settings["z"],i=e+1,s=this.listOfWidgetOnPage(t["page"]);if(!(i>s.length))for(const a of s)if(a.settings["z"]===i)return a.settings["z"]-=1,t.settings["z"]=i,this.saveWidget(a),void this.saveWidget(t)},moveZDown(t){this.sanitizeZ(t["page"]);const e=t.settings["z"],i=e-1,s=this.listOfWidgetOnPage(t["page"]);if(!(i<=0))for(const a of s)if(a.settings["z"]===i)return a.settings["z"]+=1,t.settings["z"]=i,this.saveWidget(a),void this.saveWidget(t)},listOfWidgetOnPage(t){let e=[];for(const i of Object.values(this.$store.state.widgetInstances))i["page"]===t&&e.push(i);return e},removeTab:function(t){if(!this.$store.state.loggedInUser)return;let e=this;t<=1?this.$dialog.alert(this.$t("dialogs.bodies.cannotDeleteDefaultPage")).then():this.$dialog.confirm(this.$t("dialogs.bodies.confirmPageDelete")).then((function(){axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"DELETE",url:`/widgets/pages/${t}/`,headers:{auth:e.$store.getters.apiToken}}).then(i=>{"pages"in i.data&&(e.$delete(e.$store.state.widgetPages,t),e.showSuccess(e.$t("notifications.successes.pageDeleted")),e.activeTabId=1,localStorage.setItem("widgetsActiveTabId",1))})})).catch(()=>{})},renameTab:function(t){if(!this.$store.state.loggedInUser)return;let e=this;const i={},s={view:"fontawesomePromptDialog",parent:this,current:this.$store.state.widgetPages[t].icon};this.$dialog.prompt(i,s).then(i=>{let s=i.data||"fas fa-biohazard";axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"PATCH",url:`/widgets/pages/${t}/`,data:{newIcon:s},headers:{auth:e.$store.getters.apiToken,"content-type":"application/json"}}).then(e=>{"success"in e.data&&e.data.success&&(this.$store.state.widgetPages[t].icon=s)})}).catch(()=>{})},addTab:function(){axios__WEBPACK_IMPORTED_MODULE_1___default()({method:"PUT",url:"/widgets/addPage/",headers:{auth:this.$store.getters.apiToken}}).then(t=>{if("newpage"in t.data){let e=t.data.newpage;this.$set(this.$store.state.widgetPages,e.id,e)}})}},watch:{$route:{immediate:!0,handler(){this.moveableItem.destroyMoveable()}}}}},c66c:function(t,e,i){"use strict";i("2888")},c706:function(t,e,i){"use strict";i("2b6f")},c7e4:function(t,e,i){},cba5:function(t,e,i){},d0f8:function(t,e,i){"use strict";i("cba5")},d189:function(t,e,i){"use strict";i("0555")},d236:function(t,e,i){"use strict";i("a307")},d424:function(t,e,i){},d52b:function(t,e,i){"use strict";i("c25c")},d813:function(t,e,i){"use strict";i("5a66")},d815:function(t,e,i){"use strict";i("b78c")},d816:function(t,e,i){"use strict";i("8700")},d82f:function(t,e,i){},d87d:function(t,e,i){"use strict";i("58a6")},db8d:function(t,e,i){"use strict";i("8967")},dc7d:function(t,e,i){"use strict";i("2728")},e157:function(t,e,i){"use strict";i("4009")},e290:function(t,e,i){},e2ca:function(t,e,i){},e70f:function(t,e,i){},e84d:function(t,e,i){"use strict";i("7b23")},ec1f:function(t,e,i){},ec690:function(t,e,i){"use strict";i("8102")},eeb3:function(t,e,i){},f253:function(t,e,i){"use strict";i("759a")},f816:function(t,e,i){},f81c:function(t,e,i){},fc4c:function(t,e,i){"use strict";i("ff57")},ff57:function(t,e,i){}});
//# sourceMappingURL=app.debd3fb7.js.map